<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Tweak Increment Step</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Tweak Increment Step">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("editors/datetimepicker/how-to/maskededitbox-tweak-increment-step.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/editors/datetimepicker/how-to/maskededitbox-tweak-increment-step.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="tweak-increment-step"><a href="#tweak-increment-step">Tweak Increment Step</a></h1>

<p>The rich API of RadDateTimePicker allows you to change<br>
      the increment/decrement step for each date/time part of the datetime value.<br>
      For example, you can allow the end-user to increment/decrement the minutes value only by 5<br>
      and not by 1 as it is by default. The example below demonstrates how to do this:           </p>

<h2 id="increasing-incrementdecrement-step-example"><a href="#increasing-incrementdecrement-step-example">Increasing increment/decrement step example</a></h2>

<p>Let's give a brief overview of the approach. When the user clicks the up/down arrow buttons<br>
        or presses the arrow keys, the ValueChanged event is fired. We need to handle this event for <br>
        several reasons. First, we need to understand where the value of the RadDateTimePicker<br>
        is increased or decreased. To do so, we have initially set a variable equal to the initial value of <br>
        RadDateTimePicker which we compare to the changed value of RadDateTimePicker. Second, we use <br>
        ValueChanged event to additionally modify the changed value of RadDateTimePicker in the appropriate<br>
        direction (up or down). Since we are changing a value in ValueChanged event, we need to set and reset<br>
        a boolean flag, thus avoiding StackOverflowException. </p>

<p>As a prerequisite for the example, RadDateTimePicker should of course show minutes and to demonstrate the <br>
       full power of the example, we also may want to show up/down arrow buttons instead of a dropdown button. To these<br>
       customizations, we need to set the following code lines:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>            this.radDateTimePicker1.CustomFormat = "hh:mm";
            this.radDateTimePicker1.Format = System.Windows.Forms.DateTimePickerFormat.Custom;
            this.radDateTimePicker1.ShowUpDown = true;
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Me.RadDateTimePicker1.CustomFormat = "hh:mm"
        Me.RadDateTimePicker1.Format = System.Windows.Forms.DateTimePickerFormat.Custom
        Me.RadDateTimePicker1.ShowUpDown = True
</code></pre>

<p>Here is the approach divided into separate steps:</p>

<ol>
<li>In Form Load event handler we subscribe to the ValueChanged event of RadDateTimePicker. We also 
define a DateTime variable globally which holds the initial value of RadDateTimePicker:</li>
</ol>

<h4><strong>[C#]</strong></h4>

<pre><code>        DateTime initialDateTime;

        private void Form1_Load(object sender, EventArgs e)
        {
            initialDateTime = this.radDateTimePicker1.Value;

            this.radDateTimePicker1.ValueChanged += new EventHandler(radDateTimePicker1_ValueChanged);
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private initialDateTime As Date

    Private Sub Form1_Load(ByVal sender As Object, ByVal e As EventArgs) Handles Me.Load
        initialDateTime = Me.RadDateTimePicker1.Value

        AddHandler RadDateTimePicker1.ValueChanged, AddressOf radDateTimePicker1_ValueChanged
    End Sub
    '#End Region

    '#region valueChanged
    Private suspendValueChanged As Boolean = False

    Private Sub radDateTimePicker1_ValueChanged(ByVal sender As Object, ByVal e As EventArgs)
        Dim dt As Date = Me.RadDateTimePicker1.Value
        Dim sp As TimeSpan = dt.Subtract(initialDateTime)

        If Not suspendValueChanged Then
            Dim provider As MaskDateTimeProvider = (TryCast(Me.RadDateTimePicker1.DateTimePickerElement.TextBoxElement.Provider, MaskDateTimeProvider))
            If provider.List(provider.SelectedItemIndex).type = PartTypes.Minutes Then
                suspendValueChanged = True

                If sp.Ticks &lt; 0 Then
                    For i As Integer = 0 To 3
                        Me.RadDateTimePicker1.DateTimePickerElement.TextBoxElement.Down()
                    Next i
                End If

                If sp.Ticks &gt; 0 Then
                    For i As Integer = 0 To 3
                        Me.RadDateTimePicker1.DateTimePickerElement.TextBoxElement.Up()
                    Next i
                End If

                initialDateTime = Me.RadDateTimePicker1.Value

                suspendValueChanged = False
            End If
        End If
    End Sub
</code></pre>

<ol>
<li>Here comes the ValueChanged handler implementation. In this part we are
first checking whether the new value of RadDateTimePicker is bigger than 
the old one or not. Then, we are getting the MaskDateTimeProvider
responsible for the navigation between the date/time parts - hours, minutes, etc.
If the provider states that the currently selected time part is minutes,
we, depending on the the direction in which we want to change the value,
call the Up/Down method four times, so that we can have a step of 5 minutes
as a result. Please note that we are setting and resetting the boolean flag
suspendValueChanged so that we can safely call Up/Down methods:</li>
</ol>

<h4><strong>[C#]</strong></h4>

<pre><code>        bool suspendValueChanged = false;

        void radDateTimePicker1_ValueChanged(object sender, EventArgs e)
        {
            DateTime dt = this.radDateTimePicker1.Value;
            TimeSpan sp = dt - initialDateTime;

            if (!suspendValueChanged)
            {
                MaskDateTimeProvider provider = (this.radDateTimePicker1.DateTimePickerElement.TextBoxElement.Provider as MaskDateTimeProvider);
                if (provider.List[provider.SelectedItemIndex].type == PartTypes.Minutes)
                {
                    suspendValueChanged = true;

                    if (sp.Ticks &lt; 0)
                    {
                        for (int i = 0; i &lt; 4; ++i)
                        {
                            this.radDateTimePicker1.DateTimePickerElement.TextBoxElement.Down();
                        }
                    }

                    if (sp.Ticks &gt; 0)
                    {
                        for (int i = 0; i &lt; 4; ++i)
                        {
                            this.radDateTimePicker1.DateTimePickerElement.TextBoxElement.Up();
                        }
                    }

                    initialDateTime = this.radDateTimePicker1.Value;

                    suspendValueChanged = false;
                }
            }
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private suspendValueChanged As Boolean = False

    Private Sub radDateTimePicker1_ValueChanged(ByVal sender As Object, ByVal e As EventArgs)
        Dim dt As Date = Me.RadDateTimePicker1.Value
        Dim sp As TimeSpan = dt.Subtract(initialDateTime)

        If Not suspendValueChanged Then
            Dim provider As MaskDateTimeProvider = (TryCast(Me.RadDateTimePicker1.DateTimePickerElement.TextBoxElement.Provider, MaskDateTimeProvider))
            If provider.List(provider.SelectedItemIndex).type = PartTypes.Minutes Then
                suspendValueChanged = True

                If sp.Ticks &lt; 0 Then
                    For i As Integer = 0 To 3
                        Me.RadDateTimePicker1.DateTimePickerElement.TextBoxElement.Down()
                    Next i
                End If

                If sp.Ticks &gt; 0 Then
                    For i As Integer = 0 To 3
                        Me.RadDateTimePicker1.DateTimePickerElement.TextBoxElement.Up()
                    Next i
                End If

                initialDateTime = Me.RadDateTimePicker1.Value

                suspendValueChanged = False
            End If
        End If
    End Sub
</code></pre>

<p>The result is shown below. Just with a single key stroke of the up arrow key, we increase the value of the<br>
minutes by 5:<br>
<img src="images/editors-maskededitbox-how-to-tweak-increment-step001.png" alt="editors-maskededitbox-how-to-tweak-increment-step 001"><img src="images/editors-maskededitbox-how-to-tweak-increment-step002.png" alt="editors-maskededitbox-how-to-tweak-increment-step 002"></p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

