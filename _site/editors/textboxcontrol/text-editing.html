<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Text editing</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Text editing">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("editors/textboxcontrol/text-editing.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/editors/textboxcontrol/text-editing.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="text-editing"><a href="#text-editing">Text editing</a></h1>

<p>The editing point is determined by the caret position and selection in RadTextBoxControl.<br>
            The editing position is visible only if the control is focused.</p>

<p>You can insert text programmatically at concrete position by using the <strong>Insert</strong> method.<br>
            At that case, the text is inserted at the position determined by the <br>
            <strong>SelectionStart</strong> property. If the <strong>SelectionLength</strong><br>
            property is greater than zero, the inserted text replaces the selected text.</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        private void Insert()
        {
            this.radTextBoxControl1.Text = "Green";
            this.radTextBoxControl1.CaretIndex = 0;
            this.radTextBoxControl1.Insert("John ");
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub Insert()
        Me.RadTextBoxControl1.Text = "Green"
        Me.RadTextBoxControl1.CaretIndex = 0
        Me.RadTextBoxControl1.Insert("John ")
    End Sub
#End Region

#Region "AppendText"
    Private Sub AppendText()
        Me.RadTextBoxControl1.Text = "Samuel"
        Me.RadTextBoxControl1.AppendText(" Jackson")
    End Sub
#End Region

#Region "Delete"
    Private Sub DeleteSelection()
        Me.RadTextBoxControl1.Text = "John Green"
        Me.RadTextBoxControl1.[Select](0, 4)
        Me.RadTextBoxControl1.Delete()
    End Sub
#End Region

#Region "TextChanging"
    Private Sub radTextBoxControl1_TextChanging(sender As Object, e As Telerik.WinControls.TextChangingEventArgs)
        e.Cancel = String.IsNullOrEmpty(e.NewValue)
    End Sub
#End Region

#Region "AddAutoCompleteItems"
    Private Sub AddAutoCompleteItems()
        Me.RadTextBoxControl1.AutoCompleteMode = AutoCompleteMode.Suggest
        Dim autoCompleteItems As RadListDataItemCollection = Me.RadTextBoxControl1.AutoCompleteItems

        autoCompleteItems.Add(New RadListDataItem("Luke"))
        autoCompleteItems.Add(New RadListDataItem("Max"))
        autoCompleteItems.Add(New RadListDataItem("Adam"))
        autoCompleteItems.Add(New RadListDataItem("Henry"))
        autoCompleteItems.Add(New RadListDataItem("Jack"))
        autoCompleteItems.Add(New RadListDataItem("Ben"))
        autoCompleteItems.Add(New RadListDataItem("Tyler"))
        autoCompleteItems.Add(New RadListDataItem("Ethan"))
        autoCompleteItems.Add(New RadListDataItem("David"))
        autoCompleteItems.Add(New RadListDataItem("Mike"))
    End Sub
#End Region

    Private Sub formatting1()
        '#Region "Formatting1"
        AddHandler Me.RadTextBoxControl1.TextBlockFormatting, AddressOf Me.OnTextBlockFormatting
        Me.RadTextBoxControl1.Text = "This is important text."
        '#End Region
    End Sub

#Region "formatting2"
    Private Sub OnTextBlockFormatting(sender As Object, e As Telerik.WinControls.UI.TextBlockFormattingEventArgs)
        Dim textBlock As TextBlockElement = TryCast(e.TextBlock, TextBlockElement)

        If textBlock IsNot Nothing AndAlso e.TextBlock.Text = "important" Then
            textBlock.ForeColor = Color.Red
        End If
    End Sub
#End Region

    Private Sub applyCustomTextBlock1()
        '#Region "applyCustomTextBlock1"
        AddHandler RadTextBoxControl1.CreateTextBlock, AddressOf radTextBoxControl1_CreateTextBlock
        '#End Region
    End Sub

#Region "applyCustomTextBlock2"
    Private Sub radTextBoxControl1_CreateTextBlock(sender As Object, e As CreateTextBlockEventArgs)
        If e.Text = "here" Then
            e.TextBlock = New ButtonTextBlock()
        End If
    End Sub
#End Region
    Private Sub setTheText()
        '#Region "applyCustomTextBlock3"
        Me.RadTextBoxControl1.Text = "Please, click here"
        '#End Region
    End Sub


#Region "customTextBlock"
    Public Class ButtonTextBlock
        Inherits RadButtonElement
        Implements ITextBlock
        Private m_index As Integer
        Private m_offset As Integer

        Public Sub New()
            Me.m_index = 0
            Me.m_offset = 0
            Me.MaxSize = New Size(0, 12)
        End Sub

        Protected Overrides ReadOnly Property ThemeEffectiveType() As Type
            Get
                Return GetType(RadButtonElement)
            End Get
        End Property

        Public Property Index() As Integer Implements ITextBlock.Index
            Get
                Return Me.m_index
            End Get
            Set(value As Integer)
                Me.m_index = value
            End Set
        End Property

        Public ReadOnly Property Length() As Integer Implements ITextBlock.Length
            Get
                Return 1
            End Get
        End Property

        Public Property Offset() As Integer Implements ITextBlock.Offset
            Get
                Return Me.m_offset
            End Get
            Set(value As Integer)
                Me.m_offset = value
            End Set
        End Property

        Public Function GetCharacterIndexFromX(x As Single) As Integer Implements ITextBlock.GetCharacterIndexFromX
            Dim bounds As RectangleF = Me.ControlBoundingRectangle
            Dim median As Single = bounds.X + bounds.Width / 2
            Return If(x &lt;= median, 0, 1)
        End Function

        Public Function GetRectangleFromCharacterIndex(index As Integer, trailEdge As Boolean) As RectangleF Implements ITextBlock.GetRectangleFromCharacterIndex
            Dim bounds As Rectangle = Me.ControlBoundingRectangle

            If index = 1 Then
                bounds.X = bounds.Right
                bounds.Width = 0
            End If

            Return bounds
        End Function

        Protected Overrides Sub OnClick(e As EventArgs)
            MyBase.OnClick(e)
            RadMessageBox.Show("The button is clicked.", "Message")
        End Sub

        Overloads Sub Measure(availableSize As SizeF) Implements ITextBlock.Measure
            MyBase.Measure(availableSize)
        End Sub

        Overloads Sub Arrange(finalRectangle As RectangleF) Implements ITextBlock.Arrange
            MyBase.Arrange(finalRectangle)
        End Sub

        Overloads ReadOnly Property DesiredSize As SizeF Implements ITextBlock.DesiredSize
            Get
                Return MyBase.DesiredSize
            End Get
        End Property

        Overloads ReadOnly Property ControlBoundingRectangle As Rectangle Implements ITextBlock.ControlBoundingRectangle
            Get
                Return MyBase.ControlBoundingRectangle
            End Get
        End Property

        Overloads Property Text As String Implements ITextBlock.Text
            Get
                Return MyBase.Text
            End Get
            Set(value As String)
                MyBase.Text = value
            End Set
        End Property
    End Class
#End Region
End Class
</code></pre>

<p>The code above produces the following result:<img src="images/editors-textboxcontrol-text-editing001.png" alt="editors-textboxcontrol-text-editing 001"></p>

<p>Alternatively, you can insert text at the end of the RadTextBoxControl <br>
            content by using the <strong>AppendText</strong> method:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        private void AppendText()
        {
            this.radTextBoxControl1.Text = "Samuel";
            this.radTextBoxControl1.AppendText(" Jackson");
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub AppendText()
        Me.RadTextBoxControl1.Text = "Samuel"
        Me.RadTextBoxControl1.AppendText(" Jackson")
    End Sub
#End Region

#Region "Delete"
    Private Sub DeleteSelection()
        Me.RadTextBoxControl1.Text = "John Green"
        Me.RadTextBoxControl1.[Select](0, 4)
        Me.RadTextBoxControl1.Delete()
    End Sub
#End Region

#Region "TextChanging"
    Private Sub radTextBoxControl1_TextChanging(sender As Object, e As Telerik.WinControls.TextChangingEventArgs)
        e.Cancel = String.IsNullOrEmpty(e.NewValue)
    End Sub
#End Region

#Region "AddAutoCompleteItems"
    Private Sub AddAutoCompleteItems()
        Me.RadTextBoxControl1.AutoCompleteMode = AutoCompleteMode.Suggest
        Dim autoCompleteItems As RadListDataItemCollection = Me.RadTextBoxControl1.AutoCompleteItems

        autoCompleteItems.Add(New RadListDataItem("Luke"))
        autoCompleteItems.Add(New RadListDataItem("Max"))
        autoCompleteItems.Add(New RadListDataItem("Adam"))
        autoCompleteItems.Add(New RadListDataItem("Henry"))
        autoCompleteItems.Add(New RadListDataItem("Jack"))
        autoCompleteItems.Add(New RadListDataItem("Ben"))
        autoCompleteItems.Add(New RadListDataItem("Tyler"))
        autoCompleteItems.Add(New RadListDataItem("Ethan"))
        autoCompleteItems.Add(New RadListDataItem("David"))
        autoCompleteItems.Add(New RadListDataItem("Mike"))
    End Sub
#End Region

    Private Sub formatting1()
        '#Region "Formatting1"
        AddHandler Me.RadTextBoxControl1.TextBlockFormatting, AddressOf Me.OnTextBlockFormatting
        Me.RadTextBoxControl1.Text = "This is important text."
        '#End Region
    End Sub

#Region "formatting2"
    Private Sub OnTextBlockFormatting(sender As Object, e As Telerik.WinControls.UI.TextBlockFormattingEventArgs)
        Dim textBlock As TextBlockElement = TryCast(e.TextBlock, TextBlockElement)

        If textBlock IsNot Nothing AndAlso e.TextBlock.Text = "important" Then
            textBlock.ForeColor = Color.Red
        End If
    End Sub
#End Region

    Private Sub applyCustomTextBlock1()
        '#Region "applyCustomTextBlock1"
        AddHandler RadTextBoxControl1.CreateTextBlock, AddressOf radTextBoxControl1_CreateTextBlock
        '#End Region
    End Sub

#Region "applyCustomTextBlock2"
    Private Sub radTextBoxControl1_CreateTextBlock(sender As Object, e As CreateTextBlockEventArgs)
        If e.Text = "here" Then
            e.TextBlock = New ButtonTextBlock()
        End If
    End Sub
#End Region
    Private Sub setTheText()
        '#Region "applyCustomTextBlock3"
        Me.RadTextBoxControl1.Text = "Please, click here"
        '#End Region
    End Sub


#Region "customTextBlock"
    Public Class ButtonTextBlock
        Inherits RadButtonElement
        Implements ITextBlock
        Private m_index As Integer
        Private m_offset As Integer

        Public Sub New()
            Me.m_index = 0
            Me.m_offset = 0
            Me.MaxSize = New Size(0, 12)
        End Sub

        Protected Overrides ReadOnly Property ThemeEffectiveType() As Type
            Get
                Return GetType(RadButtonElement)
            End Get
        End Property

        Public Property Index() As Integer Implements ITextBlock.Index
            Get
                Return Me.m_index
            End Get
            Set(value As Integer)
                Me.m_index = value
            End Set
        End Property

        Public ReadOnly Property Length() As Integer Implements ITextBlock.Length
            Get
                Return 1
            End Get
        End Property

        Public Property Offset() As Integer Implements ITextBlock.Offset
            Get
                Return Me.m_offset
            End Get
            Set(value As Integer)
                Me.m_offset = value
            End Set
        End Property

        Public Function GetCharacterIndexFromX(x As Single) As Integer Implements ITextBlock.GetCharacterIndexFromX
            Dim bounds As RectangleF = Me.ControlBoundingRectangle
            Dim median As Single = bounds.X + bounds.Width / 2
            Return If(x &lt;= median, 0, 1)
        End Function

        Public Function GetRectangleFromCharacterIndex(index As Integer, trailEdge As Boolean) As RectangleF Implements ITextBlock.GetRectangleFromCharacterIndex
            Dim bounds As Rectangle = Me.ControlBoundingRectangle

            If index = 1 Then
                bounds.X = bounds.Right
                bounds.Width = 0
            End If

            Return bounds
        End Function

        Protected Overrides Sub OnClick(e As EventArgs)
            MyBase.OnClick(e)
            RadMessageBox.Show("The button is clicked.", "Message")
        End Sub

        Overloads Sub Measure(availableSize As SizeF) Implements ITextBlock.Measure
            MyBase.Measure(availableSize)
        End Sub

        Overloads Sub Arrange(finalRectangle As RectangleF) Implements ITextBlock.Arrange
            MyBase.Arrange(finalRectangle)
        End Sub

        Overloads ReadOnly Property DesiredSize As SizeF Implements ITextBlock.DesiredSize
            Get
                Return MyBase.DesiredSize
            End Get
        End Property

        Overloads ReadOnly Property ControlBoundingRectangle As Rectangle Implements ITextBlock.ControlBoundingRectangle
            Get
                Return MyBase.ControlBoundingRectangle
            End Get
        End Property

        Overloads Property Text As String Implements ITextBlock.Text
            Get
                Return MyBase.Text
            End Get
            Set(value As String)
                MyBase.Text = value
            End Set
        End Property
    End Class
#End Region
End Class
</code></pre>

<p>The appended text is inserted at the end:<img src="images/editors-textboxcontrol-text-editing002.png" alt="editors-textboxcontrol-text-editing 002"></p>

<p>You can delete the selected text or character at the caret position by using the <strong>Delete</strong> method:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        private void DeleteSelection()
        {
            this.radTextBoxControl1.Text = "John Green";
            this.radTextBoxControl1.Select(0, 4);
            this.radTextBoxControl1.Delete();
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub DeleteSelection()
        Me.RadTextBoxControl1.Text = "John Green"
        Me.RadTextBoxControl1.[Select](0, 4)
        Me.RadTextBoxControl1.Delete()
    End Sub
#End Region

#Region "TextChanging"
    Private Sub radTextBoxControl1_TextChanging(sender As Object, e As Telerik.WinControls.TextChangingEventArgs)
        e.Cancel = String.IsNullOrEmpty(e.NewValue)
    End Sub
#End Region

#Region "AddAutoCompleteItems"
    Private Sub AddAutoCompleteItems()
        Me.RadTextBoxControl1.AutoCompleteMode = AutoCompleteMode.Suggest
        Dim autoCompleteItems As RadListDataItemCollection = Me.RadTextBoxControl1.AutoCompleteItems

        autoCompleteItems.Add(New RadListDataItem("Luke"))
        autoCompleteItems.Add(New RadListDataItem("Max"))
        autoCompleteItems.Add(New RadListDataItem("Adam"))
        autoCompleteItems.Add(New RadListDataItem("Henry"))
        autoCompleteItems.Add(New RadListDataItem("Jack"))
        autoCompleteItems.Add(New RadListDataItem("Ben"))
        autoCompleteItems.Add(New RadListDataItem("Tyler"))
        autoCompleteItems.Add(New RadListDataItem("Ethan"))
        autoCompleteItems.Add(New RadListDataItem("David"))
        autoCompleteItems.Add(New RadListDataItem("Mike"))
    End Sub
#End Region

    Private Sub formatting1()
        '#Region "Formatting1"
        AddHandler Me.RadTextBoxControl1.TextBlockFormatting, AddressOf Me.OnTextBlockFormatting
        Me.RadTextBoxControl1.Text = "This is important text."
        '#End Region
    End Sub

#Region "formatting2"
    Private Sub OnTextBlockFormatting(sender As Object, e As Telerik.WinControls.UI.TextBlockFormattingEventArgs)
        Dim textBlock As TextBlockElement = TryCast(e.TextBlock, TextBlockElement)

        If textBlock IsNot Nothing AndAlso e.TextBlock.Text = "important" Then
            textBlock.ForeColor = Color.Red
        End If
    End Sub
#End Region

    Private Sub applyCustomTextBlock1()
        '#Region "applyCustomTextBlock1"
        AddHandler RadTextBoxControl1.CreateTextBlock, AddressOf radTextBoxControl1_CreateTextBlock
        '#End Region
    End Sub

#Region "applyCustomTextBlock2"
    Private Sub radTextBoxControl1_CreateTextBlock(sender As Object, e As CreateTextBlockEventArgs)
        If e.Text = "here" Then
            e.TextBlock = New ButtonTextBlock()
        End If
    End Sub
#End Region
    Private Sub setTheText()
        '#Region "applyCustomTextBlock3"
        Me.RadTextBoxControl1.Text = "Please, click here"
        '#End Region
    End Sub


#Region "customTextBlock"
    Public Class ButtonTextBlock
        Inherits RadButtonElement
        Implements ITextBlock
        Private m_index As Integer
        Private m_offset As Integer

        Public Sub New()
            Me.m_index = 0
            Me.m_offset = 0
            Me.MaxSize = New Size(0, 12)
        End Sub

        Protected Overrides ReadOnly Property ThemeEffectiveType() As Type
            Get
                Return GetType(RadButtonElement)
            End Get
        End Property

        Public Property Index() As Integer Implements ITextBlock.Index
            Get
                Return Me.m_index
            End Get
            Set(value As Integer)
                Me.m_index = value
            End Set
        End Property

        Public ReadOnly Property Length() As Integer Implements ITextBlock.Length
            Get
                Return 1
            End Get
        End Property

        Public Property Offset() As Integer Implements ITextBlock.Offset
            Get
                Return Me.m_offset
            End Get
            Set(value As Integer)
                Me.m_offset = value
            End Set
        End Property

        Public Function GetCharacterIndexFromX(x As Single) As Integer Implements ITextBlock.GetCharacterIndexFromX
            Dim bounds As RectangleF = Me.ControlBoundingRectangle
            Dim median As Single = bounds.X + bounds.Width / 2
            Return If(x &lt;= median, 0, 1)
        End Function

        Public Function GetRectangleFromCharacterIndex(index As Integer, trailEdge As Boolean) As RectangleF Implements ITextBlock.GetRectangleFromCharacterIndex
            Dim bounds As Rectangle = Me.ControlBoundingRectangle

            If index = 1 Then
                bounds.X = bounds.Right
                bounds.Width = 0
            End If

            Return bounds
        End Function

        Protected Overrides Sub OnClick(e As EventArgs)
            MyBase.OnClick(e)
            RadMessageBox.Show("The button is clicked.", "Message")
        End Sub

        Overloads Sub Measure(availableSize As SizeF) Implements ITextBlock.Measure
            MyBase.Measure(availableSize)
        End Sub

        Overloads Sub Arrange(finalRectangle As RectangleF) Implements ITextBlock.Arrange
            MyBase.Arrange(finalRectangle)
        End Sub

        Overloads ReadOnly Property DesiredSize As SizeF Implements ITextBlock.DesiredSize
            Get
                Return MyBase.DesiredSize
            End Get
        End Property

        Overloads ReadOnly Property ControlBoundingRectangle As Rectangle Implements ITextBlock.ControlBoundingRectangle
            Get
                Return MyBase.ControlBoundingRectangle
            End Get
        End Property

        Overloads Property Text As String Implements ITextBlock.Text
            Get
                Return MyBase.Text
            End Get
            Set(value As String)
                MyBase.Text = value
            End Set
        End Property
    End Class
#End Region
End Class
</code></pre>

<p>After the deletion of the first word the text control looks like:<img src="images/editors-textboxcontrol-text-editing003.png" alt="editors-textboxcontrol-text-editing 003"></p>

<p>Each editing operation raises the <strong>TextChanging</strong> and <br>
            <strong>TextChanged</strong> events. Notice that you can prevent successful finishing<br>
            of operation by subscribing to the <strong>TextChanging</strong> event:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        private void radTextBoxControl1_TextChanging(object sender, Telerik.WinControls.TextChangingEventArgs e)
        {
            e.Cancel = string.IsNullOrEmpty(e.NewValue);
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub radTextBoxControl1_TextChanging(sender As Object, e As Telerik.WinControls.TextChangingEventArgs)
        e.Cancel = String.IsNullOrEmpty(e.NewValue)
    End Sub
#End Region

#Region "AddAutoCompleteItems"
    Private Sub AddAutoCompleteItems()
        Me.RadTextBoxControl1.AutoCompleteMode = AutoCompleteMode.Suggest
        Dim autoCompleteItems As RadListDataItemCollection = Me.RadTextBoxControl1.AutoCompleteItems

        autoCompleteItems.Add(New RadListDataItem("Luke"))
        autoCompleteItems.Add(New RadListDataItem("Max"))
        autoCompleteItems.Add(New RadListDataItem("Adam"))
        autoCompleteItems.Add(New RadListDataItem("Henry"))
        autoCompleteItems.Add(New RadListDataItem("Jack"))
        autoCompleteItems.Add(New RadListDataItem("Ben"))
        autoCompleteItems.Add(New RadListDataItem("Tyler"))
        autoCompleteItems.Add(New RadListDataItem("Ethan"))
        autoCompleteItems.Add(New RadListDataItem("David"))
        autoCompleteItems.Add(New RadListDataItem("Mike"))
    End Sub
#End Region

    Private Sub formatting1()
        '#Region "Formatting1"
        AddHandler Me.RadTextBoxControl1.TextBlockFormatting, AddressOf Me.OnTextBlockFormatting
        Me.RadTextBoxControl1.Text = "This is important text."
        '#End Region
    End Sub

#Region "formatting2"
    Private Sub OnTextBlockFormatting(sender As Object, e As Telerik.WinControls.UI.TextBlockFormattingEventArgs)
        Dim textBlock As TextBlockElement = TryCast(e.TextBlock, TextBlockElement)

        If textBlock IsNot Nothing AndAlso e.TextBlock.Text = "important" Then
            textBlock.ForeColor = Color.Red
        End If
    End Sub
#End Region

    Private Sub applyCustomTextBlock1()
        '#Region "applyCustomTextBlock1"
        AddHandler RadTextBoxControl1.CreateTextBlock, AddressOf radTextBoxControl1_CreateTextBlock
        '#End Region
    End Sub

#Region "applyCustomTextBlock2"
    Private Sub radTextBoxControl1_CreateTextBlock(sender As Object, e As CreateTextBlockEventArgs)
        If e.Text = "here" Then
            e.TextBlock = New ButtonTextBlock()
        End If
    End Sub
#End Region
    Private Sub setTheText()
        '#Region "applyCustomTextBlock3"
        Me.RadTextBoxControl1.Text = "Please, click here"
        '#End Region
    End Sub


#Region "customTextBlock"
    Public Class ButtonTextBlock
        Inherits RadButtonElement
        Implements ITextBlock
        Private m_index As Integer
        Private m_offset As Integer

        Public Sub New()
            Me.m_index = 0
            Me.m_offset = 0
            Me.MaxSize = New Size(0, 12)
        End Sub

        Protected Overrides ReadOnly Property ThemeEffectiveType() As Type
            Get
                Return GetType(RadButtonElement)
            End Get
        End Property

        Public Property Index() As Integer Implements ITextBlock.Index
            Get
                Return Me.m_index
            End Get
            Set(value As Integer)
                Me.m_index = value
            End Set
        End Property

        Public ReadOnly Property Length() As Integer Implements ITextBlock.Length
            Get
                Return 1
            End Get
        End Property

        Public Property Offset() As Integer Implements ITextBlock.Offset
            Get
                Return Me.m_offset
            End Get
            Set(value As Integer)
                Me.m_offset = value
            End Set
        End Property

        Public Function GetCharacterIndexFromX(x As Single) As Integer Implements ITextBlock.GetCharacterIndexFromX
            Dim bounds As RectangleF = Me.ControlBoundingRectangle
            Dim median As Single = bounds.X + bounds.Width / 2
            Return If(x &lt;= median, 0, 1)
        End Function

        Public Function GetRectangleFromCharacterIndex(index As Integer, trailEdge As Boolean) As RectangleF Implements ITextBlock.GetRectangleFromCharacterIndex
            Dim bounds As Rectangle = Me.ControlBoundingRectangle

            If index = 1 Then
                bounds.X = bounds.Right
                bounds.Width = 0
            End If

            Return bounds
        End Function

        Protected Overrides Sub OnClick(e As EventArgs)
            MyBase.OnClick(e)
            RadMessageBox.Show("The button is clicked.", "Message")
        End Sub

        Overloads Sub Measure(availableSize As SizeF) Implements ITextBlock.Measure
            MyBase.Measure(availableSize)
        End Sub

        Overloads Sub Arrange(finalRectangle As RectangleF) Implements ITextBlock.Arrange
            MyBase.Arrange(finalRectangle)
        End Sub

        Overloads ReadOnly Property DesiredSize As SizeF Implements ITextBlock.DesiredSize
            Get
                Return MyBase.DesiredSize
            End Get
        End Property

        Overloads ReadOnly Property ControlBoundingRectangle As Rectangle Implements ITextBlock.ControlBoundingRectangle
            Get
                Return MyBase.ControlBoundingRectangle
            End Get
        End Property

        Overloads Property Text As String Implements ITextBlock.Text
            Get
                Return MyBase.Text
            End Get
            Set(value As String)
                MyBase.Text = value
            End Set
        End Property
    End Class
#End Region
End Class
</code></pre>

<p>The code above prevent deleting in RadTextBoxControl.</p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

