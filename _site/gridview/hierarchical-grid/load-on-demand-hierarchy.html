<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Load-On-Demand Hierarchy</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Load-On-Demand Hierarchy">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("gridview/hierarchical-grid/load-on-demand-hierarchy.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/gridview/hierarchical-grid/load-on-demand-hierarchy.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="load-on-demand-hierarchy"><a href="#load-on-demand-hierarchy">Load-On-Demand Hierarchy</a></h1>

<table>
<th></th>
<tr>
<td>

RELATED VIDEOS</td>
<td></td>
</tr>
<tr>
<td>

[Event Based Hierarchies with RadGridView for WinForms](http://tv.telerik.com/watch/winforms/event-based-hierarchies-with-radgridview-for-winforms)         
              In this video, you will learn how to automatically and manually create object relational hierarchies in RadGridView for WinForms.
            </td>
<td>![gridview-hierarchical-grid-load-on-demand-hierarchy 001](images/gridview-hierarchical-grid-load-on-demand-hierarchy001.png)</td>
</tr>
</table>

<p>In many cases you may need to load your data not when RadGridView is being initialized, but at a later moment, when you interact with<br>
          RadGridView or with your application. For example, a child template can be loaded on demand to delay the initialization of a<br>
          resource-demanding feature of the application until it is required.<br>
          In order to load a GridViewTemplate on demand, you should follow these high-level steps:</p>

<ol>
<li><p>Create and define a columns schema for the presented data at the first level of the hierarchy.</p></li>
<li><p>Create and define a columns schema for the presented data  and a child GridViewTemplate.</p></li>
<li><p>Create and associate a  GridViewEventDataProvider with the child GridViewTemplate.</p></li>
<li><p>Handle the RowSourceNeeded event to populate the data for each parent row.</p></li>
</ol>

<h2 id="sample-load-on-demand-scenario"><a href="#sample-load-on-demand-scenario">Sample load-on-demand scenario</a></h2>

<p>The following example shows a load-on-demand scenario using a typed DataSet.<br>
          Let have the following Products data from the AdventureWorks database:<br>
        <img src="images/gridview-hierarchical-grid-load-on-demand-hierarchy001.png" alt="gridview-hierarchical-grid-load-on-demand-hierarchy 001"></p>

<p>Steps to create a Load-On-Demand hierarchy mode:</p>

<ol>
<li>First, create a columns schema for the first (parent) level of the hierarchy. If RadGridView is in a data-bound mode and we do not need to set a
        custom schema, we can just set the DataSource property of RadGridView which will set the schema and will populate the parent level with data. 
        You can also set the AutoSizeColumnsMode to Fill to get a better view of the data:</li>
</ol>

<h4><strong>[C#] Defining the child template</strong></h4>

<pre><code>            this.radGridView1.DataSource = productModelBindingSource;
            this.radGridView1.AutoSizeColumnsMode = GridViewAutoSizeColumnsMode.Fill;
</code></pre>

<h4><strong>[VB.NET] Defining the child template</strong></h4>

<pre><code>        Me.RadGridView1.DataSource = ProductModelBindingSource
        Me.RadGridView1.AutoSizeColumnsMode = GridViewAutoSizeColumnsMode.Fill
</code></pre>

<ol>
<li>Then, create a Child template and a columns schema for the "Product" data:</li>
</ol>

<h4><strong>[C#] Defining the child template</strong></h4>

<pre><code>        private GridViewTemplate CreateChildTemplate()
        {
            GridViewTemplate template = new GridViewTemplate();
            template.AutoSizeColumnsMode = GridViewAutoSizeColumnsMode.Fill;

            GridViewTextBoxColumn namecolumn = new GridViewTextBoxColumn("Name");
            GridViewTextBoxColumn productNumberColumn = new GridViewTextBoxColumn("ProductNumber");
            GridViewTextBoxColumn colorColumn = new GridViewTextBoxColumn("Color");
            GridViewDecimalColumn listPriceColumn = new GridViewDecimalColumn("ListPrice");
            GridViewTextBoxColumn sizeColumn = new GridViewTextBoxColumn("Size");
            GridViewDecimalColumn weightColumn = new GridViewDecimalColumn("Weight");
            GridViewDateTimeColumn discontinuedColumn = new GridViewDateTimeColumn("DiscontinuedDate");
            template.Columns.AddRange(namecolumn,
                productNumberColumn,
                colorColumn,
                listPriceColumn,
                sizeColumn,
                weightColumn,
                discontinuedColumn);

            return template;
        }
</code></pre>

<h4><strong>[VB.NET] Defining the child template</strong></h4>

<pre><code>    Private Function CreateChildTemplate() As GridViewTemplate
        Dim template As New GridViewTemplate()
        template.AutoSizeColumnsMode = GridViewAutoSizeColumnsMode.Fill

        Dim namecolumn As New GridViewTextBoxColumn("Name")
        Dim productNumberColumn As New GridViewTextBoxColumn("ProductNumber")
        Dim colorColumn As New GridViewTextBoxColumn("Color")
        Dim listPriceColumn As New GridViewDecimalColumn("ListPrice")
        Dim sizeColumn As New GridViewTextBoxColumn("Size")
        Dim weightColumn As New GridViewDecimalColumn("Weight")
        Dim discontinuedColumn As New GridViewDateTimeColumn("DiscontinuedDate")
        template.Columns.AddRange(namecolumn, productNumberColumn, colorColumn, listPriceColumn, sizeColumn, weightColumn, discontinuedColumn)

        Return template
    End Function
</code></pre>

<ol>
<li>Setup the load-on-demand mode by using GridViewEventDataProvider and RowSourceNeeded event:</li>
</ol>

<h4><strong>[C#] Setting up the load-on-demand mode</strong></h4>

<pre><code>        void Form1_Load(object sender, EventArgs e)
        {
            this.productModelTableAdapter.Fill(this.adventureLT2008DataSet.ProductModel);
            this.productTableAdapter.Fill(this.adventureLT2008DataSet.Product);

            GridViewTemplate childTemplate = CreateChildTemplate();
            this.radGridView1.Templates.Add(childTemplate);

            childTemplate.HierarchyDataProvider = new GridViewEventDataProvider(childTemplate);
            this.radGridView1.RowSourceNeeded += new GridViewRowSourceNeededEventHandler(radGridView1_RowSourceNeeded);
        }
</code></pre>

<h4><strong>[VB.NET] Setting up the load-on-demand mode</strong></h4>

<pre><code>    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Me.ProductModelTableAdapter.Fill(Me.AdventureLT2008DataSet.ProductModel)
        Me.ProductTableAdapter.Fill(Me.AdventureLT2008DataSet.Product)

        Dim childTemplate As GridViewTemplate = CreateChildTemplate()
        Me.RadGridView1.Templates.Add(childTemplate)

        childTemplate.HierarchyDataProvider = New GridViewEventDataProvider(childTemplate)
        AddHandler RadGridView1.RowSourceNeeded, AddressOf radGridView1_RowSourceNeeded
    End Sub
</code></pre>

<ol>
<li>Load the data on demand for an expanded parent row by using the RowSourceNeeded event:</li>
</ol>

<blockquote class="important"><p>You should make sure that there is a relation between the tables in the dataset. In the bellow example the relation name is</p></blockquote>

<pre><code>            "ProductModel_Product" and the relation is between the ProductModelID field in both tables.
</code></pre>

<h4><strong>[C#] Handling RowSourceNeeded event</strong></h4>

<pre><code>        void radGridView1_RowSourceNeeded(object sender, GridViewRowSourceNeededEventArgs e)
        {
            DataRowView rowView = e.ParentRow.DataBoundItem as DataRowView;
            DataRow[] rows = rowView.Row.GetChildRows("ProductModel_Product");

            foreach (DataRow dataRow in rows)
            {
                GridViewRowInfo row = e.Template.Rows.NewRow();
                row.Cells["Name"].Value = dataRow["Name"];
                row.Cells["ProductNumber"].Value = dataRow["ProductNumber"];
                row.Cells["Color"].Value = dataRow["Color"];
                row.Cells["ListPrice"].Value = dataRow["ListPrice"];
                row.Cells["Size"].Value = dataRow["Size"];
                row.Cells["Weight"].Value = dataRow["Weight"];
                row.Cells["DiscontinuedDate"].Value = dataRow["DiscontinuedDate"];

                e.SourceCollection.Add(row);
            }
        }
</code></pre>

<h4><strong>[VB.NET] Handling RowSourceNeeded event</strong></h4>

<pre><code>    Private Sub radGridView1_RowSourceNeeded(ByVal sender As Object, ByVal e As GridViewRowSourceNeededEventArgs)
        Dim rowView As DataRowView = TryCast(e.ParentRow.DataBoundItem, DataRowView)
        Dim rows() As DataRow = rowView.Row.GetChildRows("ProductModel_Product")

        For Each dataRow As DataRow In rows
            Dim row As GridViewRowInfo = e.Template.Rows.NewRow()
            row.Cells("Name").Value = dataRow("Name")
            row.Cells("ProductNumber").Value = dataRow("ProductNumber")
            row.Cells("Color").Value = dataRow("Color")
            row.Cells("ListPrice").Value = dataRow("ListPrice")
            row.Cells("Size").Value = dataRow("Size")
            row.Cells("Weight").Value = dataRow("Weight")
            row.Cells("DiscontinuedDate").Value = dataRow("DiscontinuedDate")

            e.SourceCollection.Add(row)
        Next dataRow
    End Sub
</code></pre>

<p>This new event based hierarchy mode can be used in different lazy loading scenarios including ORM frameworks, WCF services or complex business objects.</p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

