<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Formatting Cells</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Formatting Cells">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("gridview/cells/formatting-cells.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/gridview/cells/formatting-cells.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="formatting-cells"><a href="#formatting-cells">Formatting Cells</a></h1>

<h2 id="cellformatting"><a href="#cellformatting">CellFormatting</a></h2>

<table>
<th></th>
<tr>
<td>

RELATED VIDEOS</td>
<td></td>
</tr>
<tr>
<td>

[Formatting Data In RadGridView for WinForms](http://tv.telerik.com/radtips/radgrid/formatting-data-in-radgridview)

In this RadTip, John Kellar demonstrates how you can apply custom formatting to data within a RadGridView for Windows Forms. (Runtime: 09:14)
              </td>
<td>

![gridview-cells-formatting-cells 006](images/gridview-cells-formatting-cells006.png)</td>
</tr>
</table>

<p><strong>CellFormatting</strong> event is used to add formatting to grid <em>data</em> cells including the<br>
          <em>new row cells</em>. For example, the code sample below changes the ForeColor in all cells in the "KBytes" column<br>
          to red:</p>

<blockquote>
<p>Due to the UI virtualization in RadGridView, cell elements are created only for currently visible cells and are being reused<br>
            during operations like scrolling, filtering, grouping and so on.<br>
          In order to prevent applying the formatting to other columns' cell elements (because of the cell reuse) all customization should be<br>
            reset for the rest of the cell elements<br>
          Please refer to the Fundamentals<br>
            <a href="/devtools/winforms/gridview/fundamentals/logical-vs-visual-grid-structure">topic</a><br>
            for more information.</p>
</blockquote>

<pre><code>    Example: Changing the data cells font color
</code></pre>

<h4><strong>[C#] Formatting cells fore color</strong></h4>

<pre><code>        void radGridView1_CellFormatting1(object sender, Telerik.WinControls.UI.CellFormattingEventArgs e)
        {
            if (e.CellElement.ColumnInfo.Name == "KBytes")
            {
                e.CellElement.ForeColor = Color.Red;
            }
            else
            {
                e.CellElement.ResetValue(LightVisualElement.ForeColorProperty, ValueResetFlags.Local);
            }
        }
</code></pre>

<h4><strong>[VB.NET] Formatting cells fore color</strong></h4>

<pre><code>    Private Sub RadGridView1_CellFormatting1(ByVal sender As Object, ByVal e As Telerik.WinControls.UI.CellFormattingEventArgs) Handles RadGridView1.CellFormatting
        If e.CellElement.ColumnInfo.Name = "KBytes" Then
            e.CellElement.ForeColor = Color.Red
        Else
            e.CellElement.ResetValue(LightVisualElement.ForeColorProperty, ValueResetFlags.Local)
        End If
    End Sub
</code></pre>

<p><img src="images/gridview-cells-formatting-cells001.png" alt="gridview-cells-formatting-cells 001"></p>

<pre><code>    Example: Cells background formatting
</code></pre>

<p>This is an advanced example of using <em>CellFormatting</em> event to highlight certain cells in red color based on<br>
          the values of cells in the same row but <em>different</em> column. In the example, the values in the first column are<br>
          highlighted if the value in the check box column returns true:</p>

<p><img src="images/gridview-cells-formatting-cells002.png" alt="gridview-cells-formatting-cells 002"></p>

<h4><strong>[C#] Formatting cells</strong></h4>

<pre><code>        void radGridView1_CellFormatting2(object sender, Telerik.WinControls.UI.CellFormattingEventArgs e)
        {
            if (e.CellElement.ColumnInfo.HeaderText == "Id")
            {
                if (e.CellElement.RowInfo.Cells["BMP"].Value != null)
                {
                    if ((bool)e.CellElement.RowInfo.Cells["BMP"].Value == true)
                    {
                        e.CellElement.DrawFill = true;
                        e.CellElement.ForeColor = Color.Blue;
                        e.CellElement.NumberOfColors = 1;
                        e.CellElement.BackColor = Color.Aqua;
                    }
                    else
                    {
                        e.CellElement.DrawFill = true;
                        e.CellElement.ForeColor = Color.Yellow;
                        e.CellElement.NumberOfColors = 1;
                        e.CellElement.BackColor = Color.Green;
                    }
                }
            }
            else
            {
                e.CellElement.ResetValue(LightVisualElement.DrawFillProperty, ValueResetFlags.Local);
                e.CellElement.ResetValue(LightVisualElement.ForeColorProperty, ValueResetFlags.Local);
                e.CellElement.ResetValue(LightVisualElement.NumberOfColorsProperty, ValueResetFlags.Local);
                e.CellElement.ResetValue(LightVisualElement.BackColorProperty, ValueResetFlags.Local);
            }
        }
</code></pre>

<h4><strong>[VB.NET] Formatting cells</strong></h4>

<pre><code>    Private Sub RadGridView1_CellFormatting2(ByVal sender As Object, ByVal e As Telerik.WinControls.UI.CellFormattingEventArgs) Handles RadGridView1.CellFormatting
        If e.CellElement.ColumnInfo.HeaderText = "Id" Then
            If e.CellElement.RowInfo.Cells("BMP").Value IsNot Nothing Then
                If CBool(e.CellElement.RowInfo.Cells("BMP").Value) = True Then
                    e.CellElement.DrawFill = True
                    e.CellElement.ForeColor = Color.Blue
                    e.CellElement.NumberOfColors = 1
                    e.CellElement.BackColor = Color.Aqua
                Else
                    e.CellElement.DrawFill = True
                    e.CellElement.ForeColor = Color.Yellow
                    e.CellElement.NumberOfColors = 1
                    e.CellElement.BackColor = Color.Green
                End If
            End If
        Else
            e.CellElement.ResetValue(LightVisualElement.DrawFillProperty, ValueResetFlags.Local)
            e.CellElement.ResetValue(LightVisualElement.ForeColorProperty, ValueResetFlags.Local)
            e.CellElement.ResetValue(LightVisualElement.NumberOfColorsProperty, ValueResetFlags.Local)
            e.CellElement.ResetValue(LightVisualElement.BackColorProperty, ValueResetFlags.Local)
        End If
    End Sub
</code></pre>

<h2 id="viewcellformatting---formatting-non-data-cells"><a href="#viewcellformatting---formatting-non-data-cells">ViewCellFormatting - formatting non-data cells</a></h2>

<p>While CellFormatting event is fired only for data cells, ViewCellFormatting is fired for all RadGridView cells.<br>
          So if you want to format the grouping row or the header cells, you should use the ViewCellFormatting event.</p>

<pre><code>    Example: Change group and header cells font and removing the default filter operator text
</code></pre>

<p>For example, to change the font of the header cells and the group cells use the following code:</p>

<h4><strong>[C#] Formatting non-data rows</strong></h4>

<pre><code>        Font newFont = new Font("Arial", 12f, FontStyle.Bold);
        void radGridView1_ViewCellFormatting1(object sender, CellFormattingEventArgs e)
        {
            if (e.CellElement is GridHeaderCellElement || e.CellElement is GridGroupContentCellElement)
            {
                e.CellElement.Font = newFont;
                e.CellElement.ForeColor = Color.Blue;
            }
            else
            {
                e.CellElement.ResetValue(LightVisualElement.FontProperty, ValueResetFlags.Local);
                e.CellElement.ResetValue(LightVisualElement.ForeColorProperty, ValueResetFlags.Local);
            }

            //hiding the text from the filter cells
            GridFilterCellElement filterCell = e.CellElement as GridFilterCellElement;
            if (filterCell != null)
            {
                filterCell.FilterOperatorText.Visibility = Telerik.WinControls.ElementVisibility.Collapsed;
            }

        }
</code></pre>

<h4><strong>[VB.NET] Formatting non-data rows</strong></h4>

<pre><code>    Dim newFont = New Font("Arial", 12.0F, FontStyle.Bold)
    Private Sub RadGridView1_ViewCellFormatting1(ByVal sender As Object, ByVal e As Telerik.WinControls.UI.CellFormattingEventArgs) Handles RadGridView1.ViewCellFormatting
        If TypeOf e.CellElement Is GridHeaderCellElement OrElse TypeOf e.CellElement Is GridGroupContentCellElement Then
            e.CellElement.Font = newFont
            e.CellElement.ForeColor = Color.Blue
        Else
            e.CellElement.ResetValue(LightVisualElement.FontProperty, ValueResetFlags.Local)
            e.CellElement.ResetValue(LightVisualElement.ForeColorProperty, ValueResetFlags.Local)
        End If

        'hiding the text from the filter cells
        Dim filterCell As GridFilterCellElement = TryCast(e.CellElement, GridFilterCellElement)
        If filterCell IsNot Nothing Then
            filterCell.FilterOperatorText.Visibility = Telerik.WinControls.ElementVisibility.Collapsed
        End If
    End Sub
</code></pre>

<p><img src="images/gridview-cells-formatting-cells003.png" alt="gridview-cells-formatting-cells 003"></p>

<pre><code>    Example 2: Change TextAlignment and BackColor of group rows
</code></pre>

<p>To modify the text alignment and the back color in the group rows use the following code snippet:</p>

<h4><strong>[C#] Formatting non-data rows</strong></h4>

<pre><code>        void radGridView1_ViewCellFormatting2(object sender, CellFormattingEventArgs e)
        {
            if (e.CellElement.RowInfo is GridViewGroupRowInfo)
            {
                e.CellElement.DrawFill = true;
                e.CellElement.BackColor = Color.Aquamarine;
                e.CellElement.TextAlignment = ContentAlignment.MiddleRight;
                e.CellElement.GradientStyle = Telerik.WinControls.GradientStyles.Solid;
            }
            else
            {
                e.CellElement.ResetValue(LightVisualElement.DrawFillProperty, ValueResetFlags.Local);
                e.CellElement.ResetValue(LightVisualElement.BackColorProperty, ValueResetFlags.Local);
                e.CellElement.ResetValue(LightVisualElement.TextAlignmentProperty, ValueResetFlags.Local);
                e.CellElement.ResetValue(LightVisualElement.GradientStyleProperty, ValueResetFlags.Local);
            }
        }
</code></pre>

<h4><strong>[VB.NET] Formatting non-data rows</strong></h4>

<pre><code>    Private Sub RadGridView1_ViewCellFormatting2(ByVal sender As Object, ByVal e As Telerik.WinControls.UI.CellFormattingEventArgs) Handles RadGridView1.ViewCellFormatting
        If TypeOf e.CellElement.RowInfo Is GridViewGroupRowInfo Then
            e.CellElement.DrawFill = True
            e.CellElement.BackColor = Color.Aquamarine
            e.CellElement.TextAlignment = ContentAlignment.MiddleRight
            e.CellElement.GradientStyle = Telerik.WinControls.GradientStyles.Solid
        Else
            e.CellElement.ResetValue(LightVisualElement.DrawFillProperty, ValueResetFlags.Local)
            e.CellElement.ResetValue(LightVisualElement.BackColorProperty, ValueResetFlags.Local)
            e.CellElement.ResetValue(LightVisualElement.TextAlignmentProperty, ValueResetFlags.Local)
            e.CellElement.ResetValue(LightVisualElement.GradientStyleProperty, ValueResetFlags.Local)
        End If
    End Sub
</code></pre>

<p><img src="images/gridview-cells-formatting-cells004.png" alt="gridview-cells-formatting-cells 004"></p>

<blockquote>
<p>In certain cases, where a custom layout is needed (for example, when you want to place RadCheckBoxElement in a specific place in a header cell) <br>
            you should create your own type of cell instead of using ViewCellFormatting. Such an example is demonstrated in <a href="http://www.telerik.com/support/kb/winforms/gridview/add-check-uncheck-all-check-box-in-the-header-cell.aspx">this knowledge base article</a>.</p>
</blockquote>

<pre><code>    Example 3: Change the appearance of the buttons in GridViewCommandColumn
</code></pre>

<p>Sometimes, you may need to change the appearance of the buttons that appear in the cells of<br>
          the GridViewCommandColumn. These buttons are children of the RadGridView cells, so in order to access them,<br>
          you should take them from the Children collection of the visual cells. We will demonstrate how this should be<br>
          done by analyzing the following case.</p>

<p>Let's say that you have a number of employees. Only one employee is Vice President of the company,<br>
          while the others are managers and sales representatives. In RadGridView you have a<br>
          GridViewCommandColumn, the buttons of which allow<br>
          the end-users to edit the details of all records, except the one that belongs to the Vice President.<br>
          So, depending on the value of the Title cell, you should set the <strong>Enabled</strong> property<br>
          of the respective RadButtonElement to <em>true</em> or <em>false</em>.<br>
          Here is how we can achieve that:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        void radGridView1_CellFormatting(object sender, CellFormattingEventArgs e)
        {
            if (e.CellElement.ColumnInfo is GridViewCommandColumn)
            {
                // This is how we get the RadButtonElement instance from the cell
                RadButtonElement button = (RadButtonElement)e.CellElement.Children[0];

                if (e.CellElement.RowInfo.Cells["Title"].Value != null)
                {
                    string title = e.CellElement.RowInfo.Cells["Title"].Value.ToString();
                    if (title == "Vice President, Sales")
                    {
                        button.Enabled = false;
                    }
                    else
                    {
                        button.Enabled = true;
                    }
                }
            }
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub radGridView1_CellFormatting(ByVal sender As Object, ByVal e As CellFormattingEventArgs) Handles RadGridView1.CellFormatting
        If TypeOf e.CellElement.ColumnInfo Is GridViewCommandColumn Then
            'This is how we get the RadButtonElement instance from the cell
            Dim button As RadButtonElement = CType(e.CellElement.Children(0), RadButtonElement)

            If e.CellElement.RowInfo.Cells("Title").Value IsNot Nothing Then
                Dim title As String = e.CellElement.RowInfo.Cells("Title").Value.ToString()
                If title = "Vice President, Sales" Then
                    button.Enabled = False
                Else
                    button.Enabled = True
                End If
            End If
        End If
    End Sub
    '#End Region
End Class
</code></pre>

<p>And this is how the result looks:<br>
        <img src="images/gridview-cells-formatting-cells009.png" alt="gridview-cells-formatting-cells 009"></p>

<h2 id="example-4-hiding-child-tabs-when-no-data-is-available"><a href="#example-4-hiding-child-tabs-when-no-data-is-available">Example 4: Hiding child tabs when no data is available</a></h2>

<p>When <strong>RadGridView</strong> displays hierarchical data, you expand/collapse child levels in the hierarchy with the help of<br>
          <strong>GridGroupExpanderCellElement</strong> containing an expand/collapse image. If you have more than one template at a specific child level,<br>
          these templates are displayed by using the <strong>GridDetailViewCellElement</strong>. Consider the <strong>RadGridView</strong> has two<br>
          child templates under the master template. If you expand the parent row, two tabs will be displayed for the respective child level.<br>
          However, some of the child tabs may not contain any data. This example demonstrates a sample approach how to hide the child tabs if no data is available.<br>
          If none of the child tabs for a specific parent row contains any data, the expander image will be hidden.</p>

<blockquote>
<p>In order for a GridDetailViewCellElement to display a page view instead of a single table element, either the template of the row holding<br>
            it has to have more than one child template, or its <strong>ShowChildViewCaptions</strong> should be <em>true</em>.<br>
            Once there is a page view, the tabs in it will be visible at all times, except when some of the templates has no rows and <br>
            <strong>AllowAddNewRow</strong> for it is <em>false</em> – if it does not have any rows and the user cannot add row,<br>
            it is considered that there is no need from it.<br>
          <img src="images/gridview-cells-formatting-cells010.png" alt="gridview-cells-formatting-cells 010"></p>
</blockquote>

<h4><strong>[C#]</strong></h4>

<pre><code>        private void radGridView1_ViewCellFormatting(object sender, CellFormattingEventArgs e)
        {
            GridDetailViewCellElement cell = e.CellElement as GridDetailViewCellElement;
            GridGroupExpanderCellElement expanderCell = e.CellElement as GridGroupExpanderCellElement;
            if (expanderCell != null &amp;&amp; e.CellElement.RowElement is GridDataRowElement)
            {
                GridViewHierarchyRowInfo hierarchyRow = (GridViewHierarchyRowInfo)expanderCell.RowInfo;
                if (!IsExpandable(hierarchyRow))
                {
                    expanderCell.Expander.Visibility = Telerik.WinControls.ElementVisibility.Hidden;
                }
                else
                {
                    expanderCell.Expander.Visibility = Telerik.WinControls.ElementVisibility.Visible;
                }
            }
            else if (cell != null)
            {
                GridViewHierarchyRowInfo hierarchyRow = (GridViewHierarchyRowInfo)((GridViewDetailsRowInfo)cell.RowInfo).Owner;
                for (int i = 0; i &lt; cell.PageViewElement.Items.Count; i++)
                {
                    RadPageViewItem item = cell.PageViewElement.Items[i];
                    GridViewInfo viewInfo = hierarchyRow.Views[i];
                    item.Text = "Child Template " + i;
                    if (viewInfo.ChildRows.Count == 0)
                    {
                        if (i == 0 &amp;&amp; i &lt; cell.PageViewElement.Items.Count - 1)
                        {
                            cell.PageViewElement.Items[i + 1].IsSelected = true;
                        }
                        item.Visibility = Telerik.WinControls.ElementVisibility.Collapsed;
                    }
                    else
                    {
                        item.Visibility = Telerik.WinControls.ElementVisibility.Visible;
                    }
                }
            }
        }

        private bool IsExpandable(GridViewHierarchyRowInfo hierarchyRow)
        {
            foreach (GridViewInfo view in hierarchyRow.Views)
            {
                if (view.ChildRows.Count &gt; 0)
                {
                    return true;
                }
            }

            return false;
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub radGridView1_ViewCellFormatting(sender As Object, e As CellFormattingEventArgs)
        Dim cell As GridDetailViewCellElement = TryCast(e.CellElement, GridDetailViewCellElement)
        Dim expanderCell As GridGroupExpanderCellElement = TryCast(e.CellElement, GridGroupExpanderCellElement)
        If expanderCell IsNot Nothing AndAlso TypeOf e.CellElement.RowElement Is GridDataRowElement Then
            Dim hierarchyRow As GridViewHierarchyRowInfo = DirectCast(expanderCell.RowInfo, GridViewHierarchyRowInfo)
            If Not IsExpandable(hierarchyRow) Then
                expanderCell.Expander.Visibility = Telerik.WinControls.ElementVisibility.Hidden
            Else
                expanderCell.Expander.Visibility = Telerik.WinControls.ElementVisibility.Visible
            End If
        ElseIf cell IsNot Nothing Then
            Dim hierarchyRow As GridViewHierarchyRowInfo = DirectCast(DirectCast(cell.RowInfo, GridViewDetailsRowInfo).Owner, GridViewHierarchyRowInfo)
            For i As Integer = 0 To cell.PageViewElement.Items.Count - 1
                Dim item As RadPageViewItem = cell.PageViewElement.Items(i)
                Dim viewInfo As GridViewInfo = hierarchyRow.Views(i)
                item.Text = "Child Template " &amp; i
                If viewInfo.ChildRows.Count = 0 Then
                    If i = 0 AndAlso i &lt; cell.PageViewElement.Items.Count - 1 Then
                        cell.PageViewElement.Items(i + 1).IsSelected = True
                    End If
                    item.Visibility = Telerik.WinControls.ElementVisibility.Collapsed
                Else
                    item.Visibility = Telerik.WinControls.ElementVisibility.Visible
                End If
            Next
        End If
    End Sub

    Private Function IsExpandable(hierarchyRow As GridViewHierarchyRowInfo) As Boolean
        For Each view As GridViewInfo In hierarchyRow.Views
            If view.ChildRows.Count &gt; 0 Then
                Return True
            End If
        Next

        Return False
    End Function
    '#End Region

End Class

Public Class Car
    Public Property Id() As Integer
        Get
            Return m_Id
        End Get
        Set(value As Integer)
            m_Id = value
        End Set
    End Property
    Private m_Id As Integer

    Public Property Title() As String
        Get
            Return m_Title
        End Get
        Set(value As String)
            m_Title = value
        End Set
    End Property
    Private m_Title As String

    Public Sub New(id As Integer, title As String)
        Me.Id = id
        Me.Title = title
    End Sub
End Class

Public Class Part
    Public Property Id() As Integer
        Get
            Return m_Id
        End Get
        Set(value As Integer)
            m_Id = value
        End Set
    End Property
    Private m_Id As Integer

    Public Property PartName() As String
        Get
            Return m_PartName
        End Get
        Set(value As String)
            m_PartName = value
        End Set
    End Property
    Private m_PartName As String

    Public Property CarId() As Integer
        Get
            Return m_CarId
        End Get
        Set(value As Integer)
            m_CarId = value
        End Set
    End Property
    Private m_CarId As Integer

    Public Sub New(id As Integer, name As String, carId As Integer)
        Me.Id = id
        Me.PartName = name
        Me.CarId = carId
    End Sub
End Class

Public Class Service
    Public Property Id() As Integer
        Get
            Return m_Id
        End Get
        Set(value As Integer)
            m_Id = value
        End Set
    End Property
    Private m_Id As Integer

    Public Property ServiceName() As String
        Get
            Return m_ServiceName
        End Get
        Set(value As String)
            m_ServiceName = value
        End Set
    End Property
    Private m_ServiceName As String

    Public Property CarId() As Integer
        Get
            Return m_CarId
        End Get
        Set(value As Integer)
            m_CarId = value
        End Set
    End Property
    Private m_CarId As Integer

    Public Sub New(id As Integer, srviceName As String, carId As Integer)
        Me.Id = id
        Me.ServiceName = srviceName
        Me.CarId = carId
    End Sub
End Class
</code></pre>

<pre><code>    Formatting cells on demand
</code></pre>

<p>Sometimes you may need to format the cells on a specific user action, for example, on a button click.<br>
          Let's take the following scenario: you have a search box (RadTextBox) above RadGridView and a RadButton.<br>
          When you click the button, RadGridView should highlight the cells that match the text typed in the RadTextBox.<br>
          Here is how to do it:</p>

<ul>
<li>First, you should handle the CellFormatting event of RadGridView, setting
          the back color of those cells that have text that matches the text of RadTextBox</li>
</ul>

<h4><strong>[C#]</strong></h4>

<pre><code>        void radGridView1_CellFormatting(object sender, Telerik.WinControls.UI.CellFormattingEventArgs e)
        {
            if (e.CellElement.Text == this.radTextBox1.Text)
            {
                e.CellElement.DrawFill = true;
                e.CellElement.BackColor = Color.Yellow;
                e.CellElement.GradientStyle = Telerik.WinControls.GradientStyles.Solid;
            }
            else
            {
                e.CellElement.ResetValue(LightVisualElement.DrawFillProperty, Telerik.WinControls.ValueResetFlags.Local);
                e.CellElement.ResetValue(VisualElement.BackColorProperty, ValueResetFlags.Local);
                e.CellElement.ResetValue(LightVisualElement.GradientStyleProperty, ValueResetFlags.Local);
            }
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub RadGridView1_CellFormatting(ByVal sender As Object, ByVal e As Telerik.WinControls.UI.CellFormattingEventArgs) Handles RadGridView1.CellFormatting
        If e.CellElement.Text = Me.RadTextBox1.Text Then
            e.CellElement.DrawFill = True
            e.CellElement.BackColor = Color.Yellow
            e.CellElement.GradientStyle = Telerik.WinControls.GradientStyles.Solid
        Else
            e.CellElement.ResetValue(LightVisualElement.DrawFillProperty, Telerik.WinControls.ValueResetFlags.Local)
            e.CellElement.ResetValue(VisualElement.BackColorProperty, ValueResetFlags.Local)
            e.CellElement.ResetValue(LightVisualElement.GradientStyleProperty, ValueResetFlags.Local)
        End If
    End Sub
</code></pre>

<ul>
<li>Now comes the tricky part. The user types some text, but then we should somehow
          notify RadGridView that it needs to refresh itself. This is done by calling the Update
          method of the TableElement, passing the <em>StateChanged</em> argument as a parameter.</li>
</ul>

<h4><strong>[C#]</strong></h4>

<pre><code>        void searchButton_Click(object sender, EventArgs e)
        {
            this.radGridView1.TableElement.Update(GridUINotifyAction.StateChanged);
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub searchButton_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles searchButton.Click
        Me.RadGridView1.TableElement.Update(GridUINotifyAction.StateChanged)
    End Sub
</code></pre>

<p>As a result of the Update call, the CellFormatting (and the other formatting events as well) will be fired and you will<br>
          get the screenshot shown below:<br>
        <img src="images/gridview-cells-formatting-cells007.png" alt="gridview-cells-formatting-cells 007"></p>

<h2 id="format-cell-with-style-property"><a href="#format-cell-with-style-property">Format cell with Style property</a></h2>

<p>The GridViewCellInfo <strong>Style</strong> property gives direct access to the<br>
          cell’s visual properties. It makes it possible to set styles to cells in runtime without<br>
          using events like <strong>CellFormatting</strong> or the <strong>ConditionalFormattingObject</strong>.</p>

<blockquote>
<p>This approach lets you customize visual properties which are defined by the theme.<br>
            All changes set this way will have a greater priority than the theme.</p>
</blockquote>

<p>The first thing to do for using the cell’s <strong>Style</strong> is to<br>
          define what custom visual properties will use this cell. You can define that the cell will:</p>

<ul>
<li><p><strong>CustomizeFill</strong></p></li>
<li><p><strong>CustomizeBorder</strong></p></li>
</ul>

<p>Using the <strong>Style</strong> property allows you to define cell’s style properties:</p>

<ul>
<li><p><strong>Fill</strong></p></li>
<li><p><strong>Border</strong></p></li>
<li><p><strong>Font</strong></p></li>
<li><p><strong>ForeColor</strong></p></li>
</ul>

<p>The example below shows how to customize the <strong>Font</strong> and<br>
          <strong>BackColor</strong> of RadGridView cell.</p>

<h4><strong>[C#] Formatting cells vie Style property</strong></h4>

<pre><code>        Font myFont = new Font(new FontFamily("Calibri"), 12.0F, FontStyle.Bold);

        private void StyleCell(GridViewCellInfo cell)
        {
            cell.Style.Font = myFont;
            cell.Style.CustomizeFill = true;
            cell.Style.GradientStyle = GradientStyles.Solid;
            cell.Style.BackColor = Color.FromArgb(162, 215, 255);
        }
</code></pre>

<h4><strong>[VB.NET] Formatting cells vie Style property</strong></h4>

<pre><code>        Me.StyleCell(Me.RadGridView1.Rows(1).Cells(1))
</code></pre>

<p>Here is how to call this method of a certain cell:</p>

<h4><strong>[C#] Call StyleCell method</strong></h4>

<pre><code>            this.StyleCell(this.radGridView1.Rows[1].Cells[1]);
</code></pre>

<h4><strong>[VB.NET] Call StyleCell method</strong></h4>

<pre><code>        Me.StyleCell(Me.RadGridView1.Rows(1).Cells(1))
</code></pre>

<p><img src="images/gridview-cells-formatting-cells008.png" alt="gridview-cells-formatting-cells 008"></p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

