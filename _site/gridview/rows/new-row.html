<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>New Row</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="New Row">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-849dcaf701d866988e8c3593f15b66de.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/" title="WinForms Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/winforms.aspx" title="About UI for WinForms" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/winforms.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/winforms/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("gridview/rows/new-row.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/gridview/rows/new-row.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="new-row"><a href="#new-row">New Row</a></h1>

<p>RadGridView provides the end-users with a special row that allows them to add a new<br>
        data row. For brevity, we will call this row "new row". The following sections<br>
        describe useful events and properties which will allow you to achieve different scenarios<br>
        related to the new row.<br>
      <img src="images/gridview-rows-new-row005.png" alt="gridview-rows-new-row 005"></p>

<h2 id="enabling-the-new-row"><a href="#enabling-the-new-row">Enabling the New Row</a></h2>

<p>By default, the new row is visible to the end-user. You can explicitly set it to visible<br>
          by setting the <strong>AllowAddNewRow</strong> property to <em>true</em>:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>            this.radGridView1.AllowAddNewRow = true;
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Me.RadGridView1.AllowAddNewRow = True
</code></pre>

<p>If you want to hide the new row, just set the <strong>AllowAddNewRow</strong> to <em>false</em><br>
          and RadGridView will look as shown below:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>            this.radGridView1.AllowAddNewRow = false;
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Me.RadGridView1.AllowAddNewRow = False
</code></pre>

<p><img src="images/gridview-rows-new-row004.png" alt="gridview-rows-new-row 004"></p>

<h2 id="setting-the-new-row-text"><a href="#setting-the-new-row-text">Setting the new row text</a></h2>

<p>For the text displayed in the new row of <strong>RadGridView</strong> you have the option to set it directly to the corresponding template. This allows you to have a different text on the new row of each level of your hierarchical grid.</p>

<h4><strong>[C#] Change the new row text</strong></h4>

<pre><code>            this.radGridView1.MasterTemplate.NewRowText = "Click here to add a new category";
            this.radGridView1.MasterTemplate.Templates[0].NewRowText = "Click here to add a new product";
</code></pre>

<h4><strong>[VB.NET] Change the new row text</strong></h4>

<pre><code>        Me.RadGridView1.MasterTemplate.NewRowText = "Click here to add a new category"
        Me.RadGridView1.MasterTemplate.Templates(0).NewRowText = "Click here to add a new product"
</code></pre>

<h2 id="new-row-position"><a href="#new-row-position">New Row position</a></h2>

<p>The new row can be pinned to top or bottom. By default, the new row is pinned to top. You<br>
          can explicitly set its position to top by setting the <strong>AddNewRowPosition</strong> to <em>Top</em>:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>            this.radGridView1.AddNewRowPosition = SystemRowPosition.Top;
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Me.RadGridView1.AddNewRowPosition = SystemRowPosition.Top
</code></pre>

<p><img src="images/gridview-rows-new-row002.png" alt="gridview-rows-new-row 002"></p>

<p>In order to pin the new row to bottom, you should set the <strong>AddNewRowPosition</strong> to <em>Bottom</em>:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>            this.radGridView1.AddNewRowPosition = SystemRowPosition.Bottom;
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Me.RadGridView1.AddNewRowPosition = SystemRowPosition.Bottom
</code></pre>

<p><img src="images/gridview-rows-new-row003.png" alt="gridview-rows-new-row 003"></p>

<h2 id="accessing-the-new-row"><a href="#accessing-the-new-row">Accessing the new row</a></h2>

<p>If you, for some reason, want to access the New Row, you can do it by getting the <strong>TableAddNewRow</strong> object from<br>
          the <em>view</em> you are in. Let's say that you want to programmatically make the New Row current. Here is how to do that<br>
          for the main view:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>            this.radGridView1.CurrentRow = this.radGridView1.MasterView.TableAddNewRow;
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Me.RadGridView1.CurrentRow = Me.RadGridView1.MasterView.TableAddNewRow
</code></pre>

<p>In case your RadGridView is data-bound, it will try to set the CurrentRow to the first data row after it is filled with data.<br>
          Therefore, you have to set the CurrentRow to TableAddNewRow after you bind the grid (after the Fill call of the TableAdapter in case<br>
          you are following the ADO.NET approach for data-binding).</p>

<h2 id="defaultvaluesneeded-event"><a href="#defaultvaluesneeded-event">DefaultValuesNeeded event</a></h2>

<p><strong>DefaultValuesNeeded</strong> is one of the events that you will probably use in your application.<br>
          When you click the new row, the new row becomes current, the prompt text ("Click here to add a new row")<br>
          is removed, and RadGridView enters its edit mode. This is the moment when the DefaultValuesNeeded event is fired.<br>
          As the name of the event implies, it allows you to set the default values for the new row which, if unchanged<br>
          by the end-user, are saved in the row when the new row is committed by the end-user.</p>

<p>Let's have a RadGridView instance bound to the Employees table of the Northwind database.<br>
          We assume that most of the employees that will be added in the future will be "Sales Representative".<br>
          Moreover, the headquarters of the company is located in London, so most probably the new employees will<br>
          have London as their city. Taking these assumptions into considerations, we will subscribe to the<br>
          DefaultValuesNeeded event and will set the "Sales Representative"<br>
          for the Title column and London for the City column:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        void radGridView1_DefaultValuesNeeded(object sender, GridViewRowEventArgs e)
        {
            e.Row.Cells["Title"].Value = "Sales Representative";
            e.Row.Cells["City"].Value = "London";
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub RadGridView1_DefaultValuesNeeded(ByVal sender As Object, ByVal e As Telerik.WinControls.UI.GridViewRowEventArgs) Handles RadGridView1.DefaultValuesNeeded
        e.Row.Cells("Title").Value = "Sales Representative"
        e.Row.Cells("City").Value = "London"
    End Sub
</code></pre>

<p>As a result, when the end-user clicks the new row to add a new row, the following values will be<br>
          filled in for him:<br>
        <img src="images/gridview-rows-new-row001.png" alt="gridview-rows-new-row 001"></p>

<h2 id="adding-rows-to-the-underlying-data-source"><a href="#adding-rows-to-the-underlying-data-source">Adding rows to the underlying data source</a></h2>

<p>In some cases, you may need RadGridView to create a record in the underlying data source<br>
          after the end-user commits the new row. In other cases, you may want to have a new record created<br>
          immediately after the end-user starts editing the new row. RadGridView supports both modes. The behavior<br>
          of RadGridView in this situation is determined by the <strong>AddNewBoundRowBeforeEdit</strong><br>
          property:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>            this.radGridView1.MasterTemplate.AddNewBoundRowBeforeEdit = true;
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Me.RadGridView1.MasterTemplate.AddNewBoundRowBeforeEdit = True
</code></pre>

<p>As you can see in the code snippet above, <strong>AddNewBoundRowBeforeEdit</strong> is a boolean property<br>
          and here is what RadGridView does depending on its values:</p>

<ul>
<li><p><strong>False</strong>: RadGridView creates a new record in the underlying data source only after the new row is committed (validated). This is the default behavior.</p></li>
<li><p><strong>True</strong>: RadGridView creates a new record in the underlying data source right after the end-user starts editing the new row. If the end-user presses Escape to cancel the editing operation of the new<br>
          row and goes to another row, the newly created record is deleted.</p></li>
</ul>

<h2 id="enter-key-mode"><a href="#enter-key-mode">Enter key mode</a></h2>

<p>The Enter key may behave differently in the new row depending on the value of the<br>
          <strong>NewRowEnterKeyMode</strong><br>
          property. By default, when the end-user presses Enter while being in the new row, the new row is<br>
          committed, and the row next to the new row becomes current.<br>
          Here is how the default value can be set explicitly:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>            this.radGridView1.NewRowEnterKeyMode = RadGridViewNewRowEnterKeyMode.EnterMovesToNextRow;
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Me.RadGridView1.NewRowEnterKeyMode = RadGridViewNewRowEnterKeyMode.EnterMovesToNextRow
</code></pre>

<p>The rest of the values available to the <strong>NewRowEnterKeyMode</strong> property are:</p>

<ul>
<li><p><strong>EnterMovesToLastAddedRow</strong>: When the<br>
          end-user press the Enter key, the new row is committed and becomes are regular data row.<br>
          After that RadGridView sets it as CurrentRow.</p></li>
<li><p><strong>EnterMovesToNextCell</strong>:<br>
          When the end-user presses the Enter key, the next cell in the new row<br>
          receives the focus and becomes the currently edited cell. If the end-user<br>
          is at the last cell of the new row and he\she presses the Enter key, the<br>
          new row is committed and RadGridView exits its edit mode.</p></li>
<li><p><strong>None</strong>: If RadGridView has an opened editor in the new row<br>
          and the end-user presses the Enter key, the value that is in the editor is saved in the<br>
          respective cell in the new row and RadGridView exists its edit mode. The current cell is not changed<br>
          in this situation.</p></li>
</ul>

<h2 id="user-events"><a href="#user-events">User events</a></h2>

<p>RadGridView exposes several end-user events two of which you will find useful in the context of the<br>
          new row: <strong>UserAddingRow</strong> and <strong>UserAddedRow</strong>.<br>
          These events are fired when the user commits the new row (by pressing<br>
          the Enter key or by clicking somewhere in the grid). As the name of the UserAddingRow implies,<br>
          it allows for preventing the new row from being committed as a data row.<br>
          This may be useful in case some of the data entered by the end-user is invalid according to<br>
          some custom requirements.</p>

<p>In the examples below we will demonstrate what you can do by using the UserAddingRow and UserAddedRow events.</p>

<p><strong>UserAddingRow</strong><br>
          Let's say that the Address column should allow no more than 30 characters per cell. If<br>
          the end-user types 40 characters in the Address cell of the new row and tries to commit this row,<br>
          he will get a warning message box that the length of his input exceeds the allowed one, and the new row will<br>
          not be committed. This can be achieved with the following code snippet:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        void radGridView1_UserAddingRow(object sender, GridViewRowCancelEventArgs e)
        {
            if (e.Rows[0].Cells["Address"].Value != null)
            {
                if (e.Rows[0].Cells["Address"].Value.ToString().Length &gt; 30)
                {
                    RadMessageBox.Show("The text in the Address field is long. Please provide shorter address.");
                    e.Cancel = true;
                }
            }
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub RadGridView1_UserAddingRow(ByVal sender As Object, ByVal e As Telerik.WinControls.UI.GridViewRowCancelEventArgs) Handles RadGridView1.UserAddingRow
        If e.Rows(0).Cells("Address").Value IsNot Nothing Then
            If e.Rows(0).Cells("Address").Value.ToString().Length &gt; 30 Then
                RadMessageBox.Show("The text in the Address field is long. Please provide shorter address.")
                e.Cancel = True
            End If
        End If
    End Sub
</code></pre>

<p><strong>UserAddedRow</strong><br>
            This event comes in handy when you want to update your data base right after the end-user has added a new row.<br>
            Assuming that we are following the standard ADO.NET approach (DataTable\TableAdapter), in the following example<br>
            we take the row that the end-user has just added, and we process it to the data base, by passing the row<br>
            to the Update method of the TableAdapter:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        void radGridView1_UserAddedRow(object sender, GridViewRowEventArgs e)
        {
            DataRow[] rows = new DataRow[e.Rows.Length];
            for (int i = 0; i &lt; e.Rows.Length; i++)
            {
                DataRowView dataRowView = e.Rows[i].DataBoundItem as DataRowView;
                if (dataRowView != null)
                {
                    rows[i] = dataRowView.Row;
                }
            }

            this.employeesTableAdapter.Update(rows);    
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub RadGridView1_UserAddedRow(ByVal sender As Object, ByVal e As Telerik.WinControls.UI.GridViewRowEventArgs) Handles RadGridView1.UserAddedRow
        Dim rows(e.Rows.Length - 1) As DataRow
        For i As Integer = 0 To e.Rows.Length - 1
            Dim dataRowView As DataRowView = TryCast(e.Rows(i).DataBoundItem, DataRowView)
            If dataRowView IsNot Nothing Then
                rows(i) = dataRowView.Row
            End If
        Next i

        Me.EmployeesTableAdapter.Update(rows)
    End Sub
</code></pre>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

