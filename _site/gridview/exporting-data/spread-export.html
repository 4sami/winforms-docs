<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Spread export</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Spread export">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("gridview/exporting-data/spread-export.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/gridview/exporting-data/spread-export.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="spread-export"><a href="#spread-export">Spread export</a></h1>

<p>SpreadExport for RadGridView, utilizes our <a href="/devtools/winforms/spread-processing/spreadprocessing-overview">RadSpreadProcessing</a><br>
        libraries to export the contents of RadGridView to <em>xlsx, csv, pdf</em> and<br>
        <em>txt</em> formats.</p>

<pre><code>    This article will explain in detail the SpreadExport abilities and will demonstrate how to use it. 
    Here is how the following grid, looks when exported.
  ![gridview-exporting-data-spread-export 001](images/gridview-exporting-data-spread-export001.png)![gridview-exporting-data-spread-export 002](images/gridview-exporting-data-spread-export002.png)
</code></pre>

<blockquote>
<p>The SpreadExport export functionality is located in the <strong>TelerikExport.dll</strong> assembly.<br>
          You need to include the following namespaces in order to access the types contained in TelerikExport:</p>
</blockquote>

<ul>
<li><p>Telerik.WinControls.Data</p></li>
<li><p>Telerik.WinControls.UI.Export.SpreadExport</p></li>
</ul>

<h2 id="exporting"><a href="#exporting">Exporting</a></h2>

<p>To use the spread export functionality, an instance of the <strong>SpreadExport</strong> object should be<br>
          created, passing as parameter the RadGridView instance to export. Afterwards, the <em>RunExport</em><br>
          method will trigger the export process. The latter method accepts as parameter a filename of the file to be exported.</p>

<h4>__[C#]  __</h4>

<pre><code>            SpreadExport spreadExporter = new SpreadExport(radGridView1);
            spreadExporter.RunExport("D:\\exportedFile.xlsx");
</code></pre>

<h4>__[VB.NET]  __</h4>

<pre><code>            Dim spreadExporter As SpreadExport = New SpreadExport(radGridView1)
            spreadExporter.RunExport("D:\exportedFile.xlsx")

            '#End Region
        End Sub

        Private Sub radButton1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles radButton1.Click
            System.IO.File.Delete("D:\exportedFile.xlsx")
            Dim spreadExporter As SpreadExport = New SpreadExport(radGridView1)
            spreadExporter.HiddenColumnOption = Telerik.WinControls.UI.Export.HiddenOption.DoNotExport

           ' spreadExporter.CellFormatting += spreadExporter_CellFormatting;
            AddHandler spreadExporter.WorkbookCreated, AddressOf spreadExporter_WorkbookCreated
            spreadExporter.ExportVisualSettings = True

            'spreadExporter.ExportHierarchy = true;
            'spreadExporter.ChildViewExportMode = Telerik.WinControls.UI.Export.ChildViewExportMode.ExportCurrentlyActiveView
            'spreadExporter.HiddenRowOption
            'spreadExporter.PagingExportOption = Telerik.WinControls.UI.Export.PagingExportOption.
            'spreadExporter.SummariesExportOption
            'spreadExporter.RadGridViewToExport
            'spreadExporter.SheetMaxRows
            'spreadExporter.SheetName

            'spreadExporter.ChildViewExporting
            'spreadExporter.ExportCompleted

            spreadExporter.ExportHierarchy = False
            spreadExporter.RunExport("D:\exportedFile.xlsx")
            System.Diagnostics.Process.Start("D:\exportedFile.xlsx")
        End Sub

        #Region "WorbookCreated"

        Private Sub spreadExporter_WorkbookCreated(ByVal sender As Object, ByVal e As WorkbookCreatedEventArgs)
            Dim worksheet As Worksheet = CType(e.Workbook.Sheets(0), Worksheet)
            worksheet.Columns(worksheet.UsedCellRange).AutoFitWidth()
        End Sub

        #End Region

        #Region "CellFormatting"

        Private Sub spreadExporter_CellFormatting(ByVal sender As Object, ByVal e As Telerik.WinControls.UI.Export.SpreadExport.CellFormattingEventArgs)
            If e.GridRowInfoType Is GetType(GridViewTableHeaderRowInfo) Then
                e.CellStyleInfo.Underline = True

                If e.GridCellInfo.RowInfo.HierarchyLevel = 0 Then
                    e.CellStyleInfo.BackColor = Color.DeepSkyBlue
                ElseIf e.GridCellInfo.RowInfo.HierarchyLevel = 1 Then
                    e.CellStyleInfo.BackColor = Color.LightSkyBlue
                End If
            End If

            If e.GridRowInfoType Is GetType(GridViewHierarchyRowInfo) Then
                If e.GridCellInfo.RowInfo.HierarchyLevel = 0 Then
                    e.CellStyleInfo.IsItalic = True
                    e.CellStyleInfo.FontSize = 12
                    e.CellStyleInfo.BackColor = Color.GreenYellow
                ElseIf e.GridCellInfo.RowInfo.HierarchyLevel = 1 Then
                    e.CellStyleInfo.ForeColor = Color.DarkGreen
                    e.CellStyleInfo.BackColor = Color.LightGreen
                End If
            End If
        End Sub

        #End Region

    End Class
End Namespace
</code></pre>

<h2 id="properties"><a href="#properties">Properties</a></h2>

<p><strong>ExportFormat</strong> - defines the format the grid will be exported to. The available values are<br>
          <strong>Xslx, Pdf, Csv, Txt</strong>. The default value of the property is <strong>Xslx</strong>,<br>
          hence if not other specified, the exporter will export to <strong>Xslx</strong>.</p>

<p><strong>ExportVisualSettings</strong> - allows you to export the visual settings (themes) to the exported file.<br>
          RadGridView will also export all formatting to the Excel file. The column width and row height will also be matched in the exported file.</p>

<p><strong>ExportHierarchy</strong> - defines whether the exporter will export hierarchical data or not.</p>

<p><strong>ChildViewExportMode</strong> - defines which child view of a hierarchy row to be exported. Available modes are:</p>

<ul>
<li><p><em>ExportFirstView</em> - the exporter exports the first view.</p></li>
<li><p><em>ExportCurrentlyActiveView</em> - the exporter exports the view that is active in the grid.</p></li>
<li><p><em>SelectViewToExport</em> - in this mode the ChildViewExporing event is fired. The event allows to choose the view to export in row by row basis.</p></li>
</ul>

<p><strong>HiddenColumnOption</strong> - defines whether hidden columns will be exported. Available options are:</p>

<ul>
<li><p><em>ExportAlways</em> - the exporter will export hidden columns as well</p></li>
<li><p><em>DoNotExport</em> - the exporter will not export hidden columns</p></li>
<li><p><em>ExportAsHidden</em> - the exporter will export hidden columns as hidden in excel*</p></li>
</ul>

<p><strong>HiddenRowOption</strong> - defines whether hidden rows will be exported. Available options are:</p>

<ul>
<li><p><em>ExportAlways</em> - the exporter will export hidden rows as well</p></li>
<li><p><em>DoNotExport</em> - the exporter will not export hidden rows</p></li>
<li><p><em>ExportAsHidden</em> - the exporter will export hidden rows as hidden in excel*</p></li>
</ul>

<blockquote>
<p>MS Excel does not support other ways of hiding a column/row different from setting its width to zero. To avoid including hidden<br>
            columns or rows in the exported excel file you could set <strong>HiddenColumnOption</strong> or<br>
            <strong>HiddenRowOption</strong> property to <em>DoNotExport</em>:</p>
</blockquote>

<p><strong>PagingExportOption</strong> - defines which pages to be exported, when paging is used in RadGridView</p>

<ul>
<li><p><em>CurrentPageOnly</em> - the exporter will export only the data on the current page.</p></li>
<li><p><em>AllPAges</em> - the exporter will export the data from all pages.</p></li>
</ul>

<p><strong>SummariesExportOption</strong> - allows to specify how to export summary items. There are fourth option to chose:</p>

<ul>
<li><p><em>ExportAll (default)</em> - the exporter will export all summary rows. This is the default setting.</p></li>
<li><p><em>ExportOnlyTop</em> - the exporter will export only the top summary rows</p></li>
<li><p><em>ExportOnlyBottom</em> -  the exporter will export only the bottom summary rows</p></li>
<li><p><em>DoNotExport</em> - the exporter will not export any summary rows</p></li>
</ul>

<p><strong>RadGridViewToExport</strong> - this property is used to set the instance of RadGridView to export.</p>

<p><strong>SheetMaxRows</strong> - the exporter splits the data on separate sheets if the number of rows is greater than <br>
          the Excel maximum. You can control the maximum number of rows through this SheetMaxRows property. Available options are:</p>

<ul>
<li><p><em>1048576</em> -  Max rows for Excel 2007 and above</p></li>
<li><p><em>65536 (default)</em> - Max rows for previous versions of Excel. This is the default setting.</p></li>
</ul>

<p><strong>SheetName</strong> - defines the sheet name of the sheet to export to. If your data is large enough to be <br>
          split on more than one sheets, then the export method adds index to the names of the next sheets.</p>

<h2 id="events"><a href="#events">Events</a></h2>

<p><strong>CellFormatting</strong> - this event is used to format the cells to be exported. The event arguments provide:</p>

<ul>
<li><p><em>CellSelection</em> - provides access to the excel cells selection. More information about the abilities this<br>
          object introduces, can be found here: <a href="/devtools/winforms/spread-processing/working-with-cells/spreadprocessing-get-set-clear-properties">Get, Set and Clear Cell Properties</a></p></li>
<li><p><em>CellStyleInfo</em> - this object is a wrapper of the CellSelection object, and allows to easier modification<br>
          of the most common appearance settings.</p></li>
<li><p><em>GridCellInfo</em> - provides access to the grid cell to be exported</p></li>
<li><p><em>GridColumnIndex</em> - returns the index of the column to be exported</p></li>
<li><p><em>GridColumnIndex</em> - returns the index of the row to be exported</p></li>
<li><p><em>GridRowInfoType</em> - returns the type of the row to be exported</p></li>
</ul>

<p>Here is an example of formatting the exported grid: </p>

<h4>__[C#]  __</h4>

<pre><code>        void spreadExporter_CellFormatting(object sender, Telerik.WinControls.UI.Export.SpreadExport.CellFormattingEventArgs e)
        {
            if (e.GridRowInfoType == typeof(GridViewTableHeaderRowInfo))
            {
                e.CellStyleInfo.Underline = true;

                if (e.GridCellInfo.RowInfo.HierarchyLevel == 0)
                {
                    e.CellStyleInfo.BackColor = Color.DeepSkyBlue;
                }
                else if (e.GridCellInfo.RowInfo.HierarchyLevel == 1)
                {
                    e.CellStyleInfo.BackColor = Color.LightSkyBlue;
                }
            }

            if (e.GridRowInfoType == typeof(GridViewHierarchyRowInfo))
            {
                if (e.GridCellInfo.RowInfo.HierarchyLevel == 0)
                {
                    e.CellStyleInfo.IsItalic = true;
                    e.CellStyleInfo.FontSize = 12;
                    e.CellStyleInfo.BackColor = Color.GreenYellow;
                }
                else if (e.GridCellInfo.RowInfo.HierarchyLevel == 1)
                {
                    e.CellStyleInfo.ForeColor = Color.DarkGreen;
                    e.CellStyleInfo.BackColor = Color.LightGreen;
                }
            }
        }
</code></pre>

<h4>__[VB.NET]  __</h4>

<pre><code>        Private Sub spreadExporter_CellFormatting(ByVal sender As Object, ByVal e As Telerik.WinControls.UI.Export.SpreadExport.CellFormattingEventArgs)
            If e.GridRowInfoType Is GetType(GridViewTableHeaderRowInfo) Then
                e.CellStyleInfo.Underline = True

                If e.GridCellInfo.RowInfo.HierarchyLevel = 0 Then
                    e.CellStyleInfo.BackColor = Color.DeepSkyBlue
                ElseIf e.GridCellInfo.RowInfo.HierarchyLevel = 1 Then
                    e.CellStyleInfo.BackColor = Color.LightSkyBlue
                End If
            End If

            If e.GridRowInfoType Is GetType(GridViewHierarchyRowInfo) Then
                If e.GridCellInfo.RowInfo.HierarchyLevel = 0 Then
                    e.CellStyleInfo.IsItalic = True
                    e.CellStyleInfo.FontSize = 12
                    e.CellStyleInfo.BackColor = Color.GreenYellow
                ElseIf e.GridCellInfo.RowInfo.HierarchyLevel = 1 Then
                    e.CellStyleInfo.ForeColor = Color.DarkGreen
                    e.CellStyleInfo.BackColor = Color.LightGreen
                End If
            End If
        End Sub

        #End Region

    End Class
End Namespace
</code></pre>

<p><img src="images/gridview-exporting-data-spread-export003.png" alt="gridview-exporting-data-spread-export 003"></p>

<p><strong>WorkbookCreated</strong> - this event is triggered when the workbook is ready to be exported. Allows to introduce<br>
          final customizations. More information on how to work with Workbook is available here: <a href="76c31a52-0999-4bfb-bc1d-ee0e6f56b6c0">Working with Workbooks</a>.</p>

<pre><code>      Here is for example how to best fit all columns:
</code></pre>

<h4>__[C#]  __</h4>

<pre><code>        void spreadExporter_WorkbookCreated(object sender, WorkbookCreatedEventArgs e)
        {
            Worksheet worksheet = (Worksheet)e.Workbook.Sheets[0];
            worksheet.Columns[worksheet.UsedCellRange].AutoFitWidth();
        }
</code></pre>

<h4>__[VB.NET]  __</h4>

<pre><code>        Private Sub spreadExporter_WorkbookCreated(ByVal sender As Object, ByVal e As WorkbookCreatedEventArgs)
            Dim worksheet As Worksheet = CType(e.Workbook.Sheets(0), Worksheet)
            worksheet.Columns(worksheet.UsedCellRange).AutoFitWidth()
        End Sub

        #End Region

        #Region "CellFormatting"

        Private Sub spreadExporter_CellFormatting(ByVal sender As Object, ByVal e As Telerik.WinControls.UI.Export.SpreadExport.CellFormattingEventArgs)
            If e.GridRowInfoType Is GetType(GridViewTableHeaderRowInfo) Then
                e.CellStyleInfo.Underline = True

                If e.GridCellInfo.RowInfo.HierarchyLevel = 0 Then
                    e.CellStyleInfo.BackColor = Color.DeepSkyBlue
                ElseIf e.GridCellInfo.RowInfo.HierarchyLevel = 1 Then
                    e.CellStyleInfo.BackColor = Color.LightSkyBlue
                End If
            End If

            If e.GridRowInfoType Is GetType(GridViewHierarchyRowInfo) Then
                If e.GridCellInfo.RowInfo.HierarchyLevel = 0 Then
                    e.CellStyleInfo.IsItalic = True
                    e.CellStyleInfo.FontSize = 12
                    e.CellStyleInfo.BackColor = Color.GreenYellow
                ElseIf e.GridCellInfo.RowInfo.HierarchyLevel = 1 Then
                    e.CellStyleInfo.ForeColor = Color.DarkGreen
                    e.CellStyleInfo.BackColor = Color.LightGreen
                End If
            End If
        End Sub

        #End Region

    End Class
End Namespace
</code></pre>

<p><img src="images/gridview-exporting-data-spread-export004.png" alt="gridview-exporting-data-spread-export 004"></p>

<p><strong>ChildViewExporting</strong> - this event is used to specify which child view to be exported, for each exported row,<br>
          during the export. Will be triggered only when the <strong>ChildViewExportMode</strong> is set to <br>
          <em>SelectViewToExport</em>.</p>

<pre><code>      The event arguments provide the __ParentRow__ which active view should be set via the
      __ActiveViewIndex__ property.
</code></pre>

<p><strong>ExportCompleted</strong> - this event is triggered when the export operation completes.</p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

