<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Allow end-users to add items to DropDownListEditor</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Allow end-users to add items to DropDownListEditor">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-849dcaf701d866988e8c3593f15b66de.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/" title="WinForms Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/winforms.aspx" title="About UI for WinForms" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/winforms.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/winforms/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("gridview/editors/how-to/howto-allow-end-users-to-add-items-to-dropdownlisteditor.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/gridview/editors/how-to/howto-allow-end-users-to-add-items-to-dropdownlisteditor.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="allow-end-users-to-add-items-to-dropdownlisteditor"><a href="#allow-end-users-to-add-items-to-dropdownlisteditor">Allow end-users to add items to DropDownListEditor</a></h1>

<p>The purpose of this article is to demonstrate how you can implement a scenario<br>
        in which the end-users are able not only to choose from a predefined list of values<br>
        represented by RadDropDownListEditor, but to add their own values to that list.</p>

<p>In order to achieve this goal, you need to add the value typed by the end-user to the<br>
        datasource of the GridViewComboBoxColumn. This will allow the end-user to use the typed<br>
        value in his/her further operations with the RadComboBoxEditor of the GridViewComboBoxColumn.</p>

<h2 id="implementing-a-custom-raddropdownlisteditor"><a href="#implementing-a-custom-raddropdownlisteditor">Implementing a custom RadDropDownListEditor</a></h2>

<p>For the purposes for the example, we will build our custom RadComboBoxEditor in the context<br>
          of a sample scenario where RadGridView is bound to the Products table of the popular Northwind<br>
          database and where we have a GridViewComboBoxColumn bound to the Categories table of the same database.</p>

<p>Let's assume that:</p>

<ul>
<li><p>The name of the form on which the RadGridView instance lies is AllowEnd-usersAddItemsComboBoxEditor.</p></li>
<li><p>The appropriate instances of the DataSet, BindingSources and TableAdapters are created.</p></li>
<li><p>RadGridView is bound to the binding source of the Products table.</p></li>
<li><p>The AutoIncrementStep of the CategoryID of the Category table is set to one.</p></li>
</ul>

<ol>
<li>First, we need to create a GridViewComboBoxColumn that will later display our custom editor.
          This column should be bound to the binding source of the Categories table. For additional information about GridViewComboBoxColumn
          and its specifics, you can read <a href="/devtools/winforms/gridview/columns/column-types/gridviewcomboboxcolumn">this article</a>. The result of adding the GridViewComboBoxColumn should lead to the
          result shown below:</li>
</ol>

<h4><strong>[C#]</strong></h4>

<pre><code>            GridViewComboBoxColumn categoriesColumn = new GridViewComboBoxColumn();
            categoriesColumn.DisplayMember = "CategoryName";
            categoriesColumn.ValueMember = "CategoryID";
            categoriesColumn.FieldName = "CategoryID";
            categoriesColumn.HeaderText = "Category";
            categoriesColumn.DataSource = this.categoriesBindingSource;
            categoriesColumn.DropDownStyle = Telerik.WinControls.RadDropDownStyle.DropDown;
            categoriesColumn.Width = 150;
            this.radGridView1.Columns.Insert(4, categoriesColumn);
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Dim categoriesColumn As New GridViewComboBoxColumn()
        categoriesColumn.DisplayMember = "CategoryName"
        categoriesColumn.ValueMember = "CategoryID"
        categoriesColumn.FieldName = "CategoryID"
        categoriesColumn.HeaderText = "Category"
        categoriesColumn.DataSource = Me.CategoriesBindingSource
        categoriesColumn.DropDownStyle = Telerik.WinControls.RadDropDownStyle.DropDown
        categoriesColumn.Width = 150
        Me.RadGridView1.Columns.Insert(4, categoriesColumn)
        '#End Region

        AddHandler RadGridView1.EditorRequired, AddressOf radGridView1_EditorRequired
        AddHandler RadGridView1.CellEndEdit, AddressOf radGridView1_CellEndEdit
    End Sub

    Private Sub AllowEnd_usersAddItemsComboBoxEditor_Load(ByVal sender As Object, ByVal e As EventArgs)
        ' TODO: This line of code loads data into the 'nwindDataSet.Categories' table. You can move, or remove it, as needed.
        Me.CategoriesTableAdapter.Fill(Me.NwindDataSet.Categories)
        ' TODO: This line of code loads data into the 'nwindDataSet.Products' table. You can move, or remove it, as needed.
        Me.ProductsTableAdapter.Fill(Me.NwindDataSet.Products)

    End Sub

    '#Region "properties"
    Public ReadOnly Property DataSet() As NwindDataSet
        Get
            Return Me.NwindDataSet
        End Get
    End Property

    Public ReadOnly Property CategoriesTA() As CategoriesTableAdapter
        Get
            Return Me.CategoriesTableAdapter
        End Get
    End Property
    '#End Region

    '#Region "editorRequired"
    Private Sub radGridView1_EditorRequired(ByVal sender As Object, ByVal e As EditorRequiredEventArgs)
        If e.EditorType Is GetType(RadDropDownListEditor) Then
            e.Editor = New CustomDropDownEditor()
        End If
    End Sub
    '#End Region

    '#Region "cellEndEdit"
    Private Sub radGridView1_CellEndEdit(ByVal sender As Object, ByVal e As GridViewCellEventArgs)
        If Me.RadGridView1.CurrentCell.Tag IsNot Nothing Then
            Me.RadGridView1.CurrentCell.Value = Me.RadGridView1.CurrentCell.Tag
            Me.RadGridView1.CurrentCell.Tag = Nothing
        End If
    End Sub
    '#End Region

    Private Sub AllowEnd_usersAddItemsComboBoxEditor_Load_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        'TODO: This line of code loads data into the 'NwindDataSet.Products' table. You can move, or remove it, as needed.
        Me.ProductsTableAdapter.Fill(Me.NwindDataSet.Products)
        'TODO: This line of code loads data into the 'NwindDataSet.Categories' table. You can move, or remove it, as needed.
        Me.CategoriesTableAdapter.Fill(Me.NwindDataSet.Categories)

    End Sub
End Class
</code></pre>

<ol>
<li>Since we will need to get the instances of the DataSet and the TableAdapters of the Category table outside the context
          of the main form, let's expose two properties in the body of the form:</li>
</ol>

<h4><strong>[C#]</strong></h4>

<pre><code>        public NwindDataSet DataSet
        {
            get
            {
                return this.nwindDataSet;
            }
        }

        public CategoriesTableAdapter CategoriesTA
        {
            get
            {
                return this.categoriesTableAdapter;
            }
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Public ReadOnly Property DataSet() As NwindDataSet
        Get
            Return Me.NwindDataSet
        End Get
    End Property

    Public ReadOnly Property CategoriesTA() As CategoriesTableAdapter
        Get
            Return Me.CategoriesTableAdapter
        End Get
    End Property
    '#End Region

    '#Region "editorRequired"
    Private Sub radGridView1_EditorRequired(ByVal sender As Object, ByVal e As EditorRequiredEventArgs)
        If e.EditorType Is GetType(RadDropDownListEditor) Then
            e.Editor = New CustomDropDownEditor()
        End If
    End Sub
    '#End Region

    '#Region "cellEndEdit"
    Private Sub radGridView1_CellEndEdit(ByVal sender As Object, ByVal e As GridViewCellEventArgs)
        If Me.RadGridView1.CurrentCell.Tag IsNot Nothing Then
            Me.RadGridView1.CurrentCell.Value = Me.RadGridView1.CurrentCell.Tag
            Me.RadGridView1.CurrentCell.Tag = Nothing
        End If
    End Sub
    '#End Region

    Private Sub AllowEnd_usersAddItemsComboBoxEditor_Load_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        'TODO: This line of code loads data into the 'NwindDataSet.Products' table. You can move, or remove it, as needed.
        Me.ProductsTableAdapter.Fill(Me.NwindDataSet.Products)
        'TODO: This line of code loads data into the 'NwindDataSet.Categories' table. You can move, or remove it, as needed.
        Me.CategoriesTableAdapter.Fill(Me.NwindDataSet.Categories)

    End Sub
End Class
</code></pre>

<ol>
<li>Now it is time to create our custom editor. For the purposes of our goal, we need to
          create a class that derives from <strong>RadDropDownListEditor</strong> and override the <strong>EndEdit</strong> method.
          #__</li>
</ol>

<p>#__</p>

<p>We are going to replace the "TO DO" comment with the code snippets provided at 4) and 5).</p>

<ol>
<li>In the EndEdit method, we first need to check whether the value typed by the user exists or not in the datasource of the GridViewComboBoxColumn.
          If it exists, we should terminate the execution of the EndEdit method:</li>
</ol>

<h4><strong>[C#]</strong></h4>

<pre><code>            GridComboBoxCellElement cellElement = this.OwnerElement as GridComboBoxCellElement;

            RadGridView grid = cellElement.GridControl;
            AllowEnd_usersAddItemsComboBoxEditor f = (AllowEnd_usersAddItemsComboBoxEditor)grid.FindForm();

            // Checking if the typed value exists in the datasource of the column.
            NwindDataSet.CategoriesDataTable dt = f.DataSet.Categories;
            for (int i = 0; i &lt; dt.Rows.Count; i++)
            {
                if (dt.Rows[i]["CategoryName"].ToString() == ((RadDropDownListEditorElement)this.EditorElement).Text)
                {
                    return base.EndEdit();
                }
            }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Dim cellElement As GridComboBoxCellElement = TryCast(Me.OwnerElement, GridComboBoxCellElement)

        Dim grid As RadGridView = cellElement.GridControl
        Dim f As AllowEnd_usersAddItemsComboBoxEditor = CType(grid.FindForm(), AllowEnd_usersAddItemsComboBoxEditor)

        ' Checking if the typed value exists in the datasource of the column.
        Dim dt As NwindDataSet.CategoriesDataTable = f.DataSet.Categories
        For i As Integer = 0 To dt.Rows.Count - 1
            If dt.Rows(i)("CategoryName").ToString() = (CType(Me.EditorElement, RadDropDownListEditorElement)).Text Then
                Return MyBase.EndEdit()
            End If
        Next i
        '#End Region

        '#Region "addValue"
        ' An example of what we can do when we enter the custom text.
        ' In this case we are adding a new data row in the underlying datasource of 
        ' the combobox column and then in the CellEndEdit we are setting
        ' the ID value of the newly created row to RadGridView.
        Dim newCategoriesRow As NwindDataSet.CategoriesRow = dt.NewCategoriesRow()
        newCategoriesRow.CategoryName = (CType(Me.EditorElement, RadDropDownListEditorElement)).Text
        f.DataSet.Categories.Rows.Add(newCategoriesRow)

        ' Updating the database. You can do it here at another place
        ' you find suitable for this purpose, for example, on FormClosing.
        f.CategoriesTA.Update(f.DataSet.Categories)

        cellElement.Tag = newCategoriesRow.CategoryID

        Return MyBase.EndEdit()
        '#End Region
    End Function
End Class
'#End Region

Namespace SamplesCS.GridView.Editors.How_To1
    '#region customEditorClass1
    Public Class CustomDropDownEditor
        Inherits RadDropDownListEditor

        Public Overrides Function EndEdit() As Boolean
</code></pre>

<ol>
<li>If the typed value is not found in the datasource, we continue with the execution of our code in the EndEdit method.
          Since the typed value does not exist, we should add it to the data source. Here you can add it to the database as well:</li>
</ol>

<h4><strong>[C#]</strong></h4>

<pre><code>            // An example of what we can do when we enter the custom text.
            // In this case we are adding a new data row in the underlying datasource of 
            // the combobox column and then in the CellEndEdit we are setting
            // the ID value of the newly created row to RadGridView.
            NwindDataSet.CategoriesRow newCategoriesRow = dt.NewCategoriesRow();
            newCategoriesRow.CategoryName = ((RadDropDownListEditorElement)this.EditorElement).Text;
            f.DataSet.Categories.Rows.Add(newCategoriesRow);

            // Updating the database. You can do it here at another place
            // you find suitable for this purpose, for example, on FormClosing.
            f.CategoriesTA.Update(f.DataSet.Categories);

            cellElement.Tag = newCategoriesRow.CategoryID;

            return base.EndEdit();
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        ' An example of what we can do when we enter the custom text.
        ' In this case we are adding a new data row in the underlying datasource of 
        ' the combobox column and then in the CellEndEdit we are setting
        ' the ID value of the newly created row to RadGridView.
        Dim newCategoriesRow As NwindDataSet.CategoriesRow = dt.NewCategoriesRow()
        newCategoriesRow.CategoryName = (CType(Me.EditorElement, RadDropDownListEditorElement)).Text
        f.DataSet.Categories.Rows.Add(newCategoriesRow)

        ' Updating the database. You can do it here at another place
        ' you find suitable for this purpose, for example, on FormClosing.
        f.CategoriesTA.Update(f.DataSet.Categories)

        cellElement.Tag = newCategoriesRow.CategoryID

        Return MyBase.EndEdit()
        '#End Region
    End Function
End Class
'#End Region

Namespace SamplesCS.GridView.Editors.How_To1
    '#region customEditorClass1
    Public Class CustomDropDownEditor
        Inherits RadDropDownListEditor

        Public Overrides Function EndEdit() As Boolean
</code></pre>

<ol>
<li>The Tag value saved in the previous code snippet is used in the CellEndEdit event handler of RadGridView. It helps us
          to set the ID of the newly created record to the cell that the end-user has just edited. As a consequence, the
          correct string value is displayed in the cell of RadGridView.</li>
</ol>

<h4><strong>[C#]</strong></h4>

<pre><code>        void radGridView1_CellEndEdit(object sender, GridViewCellEventArgs e)
        {
            if (this.radGridView1.CurrentCell.Tag != null)
            {
                this.radGridView1.CurrentCell.Value = this.radGridView1.CurrentCell.Tag;
                this.radGridView1.CurrentCell.Tag = null;
            }
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub radGridView1_CellEndEdit(ByVal sender As Object, ByVal e As GridViewCellEventArgs)
        If Me.RadGridView1.CurrentCell.Tag IsNot Nothing Then
            Me.RadGridView1.CurrentCell.Value = Me.RadGridView1.CurrentCell.Tag
            Me.RadGridView1.CurrentCell.Tag = Nothing
        End If
    End Sub
    '#End Region

    Private Sub AllowEnd_usersAddItemsComboBoxEditor_Load_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        'TODO: This line of code loads data into the 'NwindDataSet.Products' table. You can move, or remove it, as needed.
        Me.ProductsTableAdapter.Fill(Me.NwindDataSet.Products)
        'TODO: This line of code loads data into the 'NwindDataSet.Categories' table. You can move, or remove it, as needed.
        Me.CategoriesTableAdapter.Fill(Me.NwindDataSet.Categories)

    End Sub
End Class
</code></pre>

<ol>
<li>Finally, we need to attach the custom editor to RadGridView. This is done in the EditorRequired event handler. Let's assume that
          the class of our custom editor is called CustomDropDownEditor:</li>
</ol>

<h4><strong>[C#]</strong></h4>

<pre><code>        void radGridView1_EditorRequired(object sender, EditorRequiredEventArgs e)
        {
            if (e.EditorType == typeof(RadDropDownListEditor))
            {
                e.Editor = new CustomDropDownEditor();
            }
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub radGridView1_EditorRequired(ByVal sender As Object, ByVal e As EditorRequiredEventArgs)
        If e.EditorType Is GetType(RadDropDownListEditor) Then
            e.Editor = New CustomDropDownEditor()
        End If
    End Sub
    '#End Region

    '#Region "cellEndEdit"
    Private Sub radGridView1_CellEndEdit(ByVal sender As Object, ByVal e As GridViewCellEventArgs)
        If Me.RadGridView1.CurrentCell.Tag IsNot Nothing Then
            Me.RadGridView1.CurrentCell.Value = Me.RadGridView1.CurrentCell.Tag
            Me.RadGridView1.CurrentCell.Tag = Nothing
        End If
    End Sub
    '#End Region

    Private Sub AllowEnd_usersAddItemsComboBoxEditor_Load_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        'TODO: This line of code loads data into the 'NwindDataSet.Products' table. You can move, or remove it, as needed.
        Me.ProductsTableAdapter.Fill(Me.NwindDataSet.Products)
        'TODO: This line of code loads data into the 'NwindDataSet.Categories' table. You can move, or remove it, as needed.
        Me.CategoriesTableAdapter.Fill(Me.NwindDataSet.Categories)

    End Sub
End Class
</code></pre>

<h2 id="end-user-experience"><a href="#end-user-experience">End-user experience</a></h2>

<p>So, how should this implementation work? Let's say that we have a list of categories available at each product<br>
          in RadGridView. However, we decide that this list does not cover the range of products, so<br>
          we have to add the category 'SpaceFood'. We should just start editing the appropriate cell in the GridViewComboBoxColumn<br>
          and type 'SpaceFood'. Then we can press Enter or we have press Tab to go to the next cell and the 'SpaceFood' value will be added.<br>
          As you can see in the screenshot below, the record 'SpaceFood' receives a new CategoryID 9, which is saved in the appropriate<br>
          RadGridView cell under the CategoryID column:<br>
        <img src="images/gridview-editors-howto-allow-end-users-to-add-items-to-dropdownlisteditor001.png" alt="gridview-editors-howto-allow-end-users-to-add-items-to-dropdownlisteditor 001"></p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

