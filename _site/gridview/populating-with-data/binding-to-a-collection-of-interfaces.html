<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Binding to a Collection of Interfaces</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Binding to a Collection of Interfaces">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("gridview/populating-with-data/binding-to-a-collection-of-interfaces.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/gridview/populating-with-data/binding-to-a-collection-of-interfaces.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="binding-to-a-collection-of-interfaces"><a href="#binding-to-a-collection-of-interfaces">Binding to a Collection of Interfaces</a></h1>

<p>There may be a case where you want to bind RadGridView to a collection of interfaces in order to be as abstract as possible or due to other reasons.<br>
        RadGridView does not support this out of the box since when a new item is added its parameterless constructor is being invoked and interfaces cannot be created<br>
        in such a way. The solution is to override the <strong>AddNew</strong> method of the <strong>GridViewListSource</strong>.</p>

<p>First, we will need to create a custom GridViewListSource:</p>

<h4>__[C#] Creating sample class __</h4>

<pre><code>        public class MyGrid : RadGridView
        {
            protected override RadGridViewElement CreateGridViewElement()
            {
                return new MyGridViewElement();
            }
        }

        public class MyGridViewElement : RadGridViewElement
        {
            protected override MasterGridViewTemplate CreateTemplate()
            {
                return new MyMasterGridViewTemplate();
            }

            protected override Type ThemeEffectiveType
            {
                get
                {
                    return typeof(RadGridViewElement);
                }
            }
        }

        public class MyMasterGridViewTemplate : MasterGridViewTemplate
        {
            protected override GridViewListSource CreateListSource()
            {
                return new MyGridViewListSource(this);
            }
        }

        public class MyGridViewListSource : GridViewListSource
        {
            private GridViewTemplate template;

            public MyGridViewListSource(GridViewTemplate template)
                : base(template)
            {
                this.template = template;
            }

            public override GridViewRowInfo AddNew()
            {
                GridObj gridObj = new GridObj();
                IList list = (this as ICurrencyManagerProvider).CurrencyManager.List;
                list.Add(gridObj);
                IDataItem dataItem = (this.template as IDataItemSource).NewItem();
                if (this.IsDataBound)
                {
                    this.InitializeBoundRow((GridViewRowInfo)dataItem, gridObj);
                }

                return dataItem as GridViewRowInfo;
            }
        }
</code></pre>

<h4><strong>[VB.NET] Creating sample class</strong></h4>

<pre><code>    Public Class MyGrid
        Inherits RadGridView
        Protected Overrides Function CreateGridViewElement() As RadGridViewElement
            Return New MyGridViewElement()
        End Function
    End Class

    Public Class MyGridViewElement
        Inherits RadGridViewElement
        Protected Overrides Function CreateTemplate() As MasterGridViewTemplate
            Return New MyMasterGridViewTemplate()
        End Function

        Protected Overrides ReadOnly Property ThemeEffectiveType() As Type
            Get
                Return GetType(RadGridViewElement)
            End Get
        End Property
    End Class

    Public Class MyMasterGridViewTemplate
        Inherits MasterGridViewTemplate
        Protected Overrides Function CreateListSource() As GridViewListSource
            Return New MyGridViewListSource(Me)
        End Function
    End Class

    Public Class MyGridViewListSource
        Inherits GridViewListSource
        Private template As GridViewTemplate

        Public Sub New(template As GridViewTemplate)
            MyBase.New(template)
            Me.template = template
        End Sub

        Public Overrides Function AddNew() As GridViewRowInfo
            Dim gridObj As New GridObj()
            Dim list As IList = TryCast(Me, ICurrencyManagerProvider).CurrencyManager.List
            list.Add(gridObj)
            Dim dataItem As IDataItem = TryCast(Me.template, IDataItemSource).NewItem()
            If Me.IsDataBound Then
                Me.InitializeBoundRow(DirectCast(dataItem, GridViewRowInfo), gridObj)
            End If

            Return TryCast(dataItem, GridViewRowInfo)
        End Function
    End Class
</code></pre>

<p>The GridObj type is a type, which inherits from the interface, which you have bound your RadGridView. Consider the following example:</p>

<h4>__[C#] Creating sample class __</h4>

<pre><code>        public BindingToCollectionOfInterfaces()
        {
            InitializeComponent();

            MyGrid grid = new MyGrid();
            this.Controls.Add(grid);
            grid.Dock = DockStyle.Fill;

            IEnumerable&lt;IGridObj&gt; dataSource = new BindingList&lt;IGridObj&gt;();

            grid.DataSource = dataSource;
            grid.AllowAddNewRow = true;
        }

        public interface IGridObj
        {
            int Id { get; set; }
            string Name { get; set; }
        }

        public class GridObj : IGridObj
        {
            public int Id { get; set; }

            public string Name { get; set; }

            public string RandomString { get; set; }
        }
</code></pre>

<h4><strong>[VB.NET] Creating sample class</strong></h4>

<pre><code>    Public Sub New()
        InitializeComponent()

        Dim grid As New MyGrid()
        Me.Controls.Add(grid)
        grid.Dock = DockStyle.Fill

        Dim dataSource As IEnumerable(Of IGridObj) = New BindingList(Of IGridObj)()

        grid.DataSource = dataSource
        grid.AllowAddNewRow = True
    End Sub

    Public Interface IGridObj
        Property Id() As Integer
        Property Name() As String
    End Interface

    Public Class GridObj
        Implements IGridObj
        Public Property Id() As Integer Implements BindingToCollectionOfInterfaces.IGridObj.Id
            Get
                Return m_Id
            End Get
            Set(value As Integer)
                m_Id = value
            End Set
        End Property
        Private m_Id As Integer

        Public Property Name() As String Implements BindingToCollectionOfInterfaces.IGridObj.Name
            Get
                Return m_Name
            End Get
            Set(value As String)
                m_Name = value
            End Set
        End Property
        Private m_Name As String

        Public Property RandomString() As String
            Get
                Return m_RandomString
            End Get
            Set(value As String)
                m_RandomString = value
            End Set
        End Property
        Private m_RandomString As String
    End Class
</code></pre>

<p>You will notice that we are creating a <strong>BindingList</strong> of <strong>IGridObject</strong>, because the new items are manually added and this way the grid will be notified for the new objects.</p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

