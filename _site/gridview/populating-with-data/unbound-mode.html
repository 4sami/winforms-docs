<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Unbound Mode</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Unbound Mode">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("gridview/populating-with-data/unbound-mode.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/gridview/populating-with-data/unbound-mode.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="unbound-mode"><a href="#unbound-mode">Unbound Mode</a></h1>

<p>When in unbound mode of RadGridView does not use a data source to generate its content. In this mode, you need to add/remove the grid columns and rows using the provided API or the <strong>RadGridView</strong> user interface (in design-time). You can also have a spreadsheet-like grid with empty rows and columns, letting the user enter own data. This topic described the three possible scenarios for creating unbound grids:</p>

<ul>
<li><p>Creating empty grids with <strong>RowCount</strong> property set to the number of desired rows</p></li>
<li><p>Creating grids and filling them with data, using the <strong>Cells</strong> collection</p></li>
<li><p>Creating grids and filling them with data, using the <strong>Rows</strong> collection</p></li>
</ul>

<h2 id="creating-empty-grid"><a href="#creating-empty-grid">Creating Empty Grid</a></h2>

<p>You can create a grid with empty rows and columns and let the user fill the data. You should add columns to the <strong>Columns</strong> collection of the corresponding <strong>GridViewTemplate</strong> (or <strong>RadGridView</strong> in cases of flat grid). Then you should set the <strong>RowCount</strong> property to the number of desired rows. The grid does take into account the number of the rows that are already set (as described further in this topic). If you have explicitly set 5 rows and set <strong>RowCount</strong> to 10, <strong>RadGridView</strong> will add 5 more empty rows so that the total number will be 10. </p>

<p>The following code demonstrates how to create a grid with two columns and ten rows: </p>

<h4><strong>[C#] Creating empty grid</strong></h4>

<pre><code>            this.radGridView1.RowCount = 10;
            this.radGridView1.Columns.Add(new GridViewTextBoxColumn("A"));
            this.radGridView1.Columns.Add(new GridViewTextBoxColumn("B"));
            this.radGridView1.MasterTemplate.AllowAddNewRow = false;
</code></pre>

<h4><strong>[VB.NET] Creating empty grid</strong></h4>

<pre><code>        Me.RadGridView1.RowCount = 10
        Me.RadGridView1.Columns.Add(New GridViewTextBoxColumn("A"))
        Me.RadGridView1.Columns.Add(New GridViewTextBoxColumn("B"))
        Me.RadGridView1.MasterTemplate.AllowAddNewRow = False
</code></pre>

<p>The result from the code above is on the screenshot below:</p>

<p><img src="images/gridview-populating-with-data-unbound-mode001.png" alt="gridview-populating-with-data-unbound-mode 001"></p>

<h2 id="adding-rows-programmatically-through-cells-collection"><a href="#adding-rows-programmatically-through-cells-collection">Adding rows programmatically (through Cells collection)</a></h2>

<p>In this scenario, you should add the data for each cell in the row, specifying the cell index or the column name. Note that you should first create the columns:</p>

<h4><strong>[C#] Adding rows through Cells collection</strong></h4>

<pre><code>            this.radGridView1.Columns.Add(new GridViewTextBoxColumn("A"));
            this.radGridView1.Columns.Add(new GridViewTextBoxColumn("B"));
            GridViewRowInfo rowInfo = this.radGridView1.Rows.AddNew();
            rowInfo.Cells[0].Value = "A1";
            rowInfo.Cells[1].Value = "B1";
            rowInfo = this.radGridView1.Rows.AddNew();
            rowInfo.Cells["A"].Value = "A2";
            rowInfo.Cells["B"].Value = "B2";
</code></pre>

<h4><strong>[VB.NET] Adding rows through Cells collection</strong></h4>

<pre><code>    Public Sub Form1_Load1(sender As Object, e As EventArgs)
        Me.RadGridView1.Columns.Add(New GridViewTextBoxColumn("A"))
        Me.RadGridView1.Columns.Add(New GridViewTextBoxColumn("B"))
        Dim rowInfo As GridViewRowInfo = Me.RadGridView1.Rows.AddNew()
        rowInfo.Cells(0).Value = "A1"
        rowInfo.Cells(1).Value = "B1"
        rowInfo = Me.RadGridView1.Rows.AddNew()
        rowInfo.Cells("A").Value = "A2"
        rowInfo.Cells("B").Value = "B2"
    End Sub
</code></pre>

<p>The code above results in the following grid: </p>

<p><img src="images/gridview-populating-with-data-unbound-mode002.png" alt="gridview-populating-with-data-unbound-mode 002"></p>

<h2 id="adding-rows-programmatically-through-rows-collection"><a href="#adding-rows-programmatically-through-rows-collection">Adding rows programmatically (through Rows collection)</a></h2>

<p>You can have the same result as the picture above by adding the rows data using the Add method of the Rows collection: </p>

<h4><strong>[C#] Adding data through Rows collection</strong></h4>

<pre><code>            this.radGridView1.Columns.Add(new GridViewTextBoxColumn("A"));
            this.radGridView1.Columns.Add(new GridViewTextBoxColumn("B"));
            this.radGridView1.Rows.Add("A1", "B1");
            this.radGridView1.Rows.Add("A2", "B2");
</code></pre>

<h4><strong>[VB.NET] Adding data through Rows collection</strong></h4>

<pre><code>    Public Sub Form1_Load2(sender As Object, e As EventArgs)
        Me.RadGridView1.Columns.Add(New GridViewTextBoxColumn("A"))
        Me.RadGridView1.Columns.Add(New GridViewTextBoxColumn("B"))
        Me.RadGridView1.Rows.Add("A1", "B1")
        Me.RadGridView1.Rows.Add("A2", "B2")
    End Sub
</code></pre>

<h2 id="hierarchical-grid-in-unbound-mode"><a href="#hierarchical-grid-in-unbound-mode">Hierarchical Grid in Unbound mode</a></h2>

<p>Setting the hierarchical grid in unbound mode is quite similar to that for the bound mode with only difference is setting the unbound mode itself. First of all you need to create and the columns you need. After that set up the relation and finally load the data.</p>

<h4><strong>[C#] Creating hierarchical grid in unbound mode</strong></h4>

<pre><code>        public void creatingHierarchicalGridInUnboundMode()
        {
            //setup the master template
            GridViewImageColumn column = new GridViewImageColumn("Photo");
            column.ImageLayout = ImageLayout.Stretch;
            radGridView1.MasterTemplate.Columns.Add(column);
            GridViewTextBoxColumn textColumn = new GridViewTextBoxColumn("Name");
            textColumn.Width = 150;
            radGridView1.MasterTemplate.Columns.Add(textColumn);
            radGridView1.MasterTemplate.Columns.Add(new GridViewDecimalColumn("Salary"));
            GridViewDateTimeColumn dateTimeColumn = new GridViewDateTimeColumn("Hire Date");
            dateTimeColumn.Width = 100;
            dateTimeColumn.TextAlignment = ContentAlignment.MiddleCenter;
            radGridView1.MasterTemplate.Columns.Add(dateTimeColumn);
            textColumn = new GridViewTextBoxColumn("Title");
            textColumn.Width = 150;
            radGridView1.MasterTemplate.Columns.Add(textColumn);
            radGridView1.MasterTemplate.Columns.Add(new GridViewCheckBoxColumn("Active"));
            radGridView1.MasterTemplate.Columns.Add(new GridViewCommandColumn("Action"));

            //setup the child template
            GridViewTemplate template = new GridViewTemplate();
            template.AllowAddNewRow = true;
            template.Columns.Add(new GridViewTextBoxColumn("Name"));
            template.Columns.Add(new GridViewTextBoxColumn("Product Number"));
            template.Columns.Add(new GridViewDecimalColumn("Quantity"));
            template.Columns.Add(new GridViewDecimalColumn("Discount"));
            template.Columns.Add(new GridViewDecimalColumn("Total"));
            radGridView1.MasterTemplate.Templates.Add(template);

            //create the relation
            GridViewRelation relation = new GridViewRelation(radGridView1.MasterTemplate);
            relation.ChildTemplate = template;
            relation.RelationName = "EmployeesOrders";
            relation.ParentColumnNames.Add("Name");
            relation.ChildColumnNames.Add("Name");
            radGridView1.Relations.Add(relation);

            //load data
            LoadUnboundData();
        }

        private void LoadUnboundData()
        {
            using (radGridView1.DeferRefresh())
            {
                for (int i = 0; i &lt; nwindDataSet.Employees.Count; i++)
                {
                    Random random = new Random((int)DateTime.Now.Ticks);
                    NwindDataSet.EmployeesRow row = nwindDataSet.Employees[i];
                    string name = row.FirstName + " " + row.LastName;
                    radGridView1.MasterTemplate.Rows.Add(GetImageFromData(row.Photo), name, random.Next(45000), row.HireDate, row.Title, (random.Next(100) &gt; 50), "View");
                    GridViewTemplate template = radGridView1.MasterTemplate.Templates[0];
                    int rowCount = random.Next(20);
                    for (int j = 0; j &lt; rowCount; j++)
                    {
                        template.Rows.Add(name, random.Next(1000), random.Next(50), random.Next(100), random.Next(10000));
                    }
                }
            }
        }

        private Image GetImageFromData(byte[] imageData)
        {
            const int OleHeaderLength = 78;

            MemoryStream memoryStream = new MemoryStream();

            if (HasOleContainerHeader(imageData))
            {
                memoryStream.Write(imageData, OleHeaderLength, imageData.Length - OleHeaderLength);
            }
            else
            {
                memoryStream.Write(imageData, 0, imageData.Length);
            }

            Bitmap bitmap = new Bitmap(memoryStream);

            return bitmap.GetThumbnailImage(55, 65, null, new IntPtr());
        }

        private bool HasOleContainerHeader(byte[] imageByteArray)
        {
            const byte OleByte0 = 21;

            const byte OleByte1 = 28;

            return (imageByteArray[0] == OleByte0) &amp;&amp; (imageByteArray[1] == OleByte1);
        }
</code></pre>

<h4><strong>[VB.NET] Creating hierarchical grid in unbound mode</strong></h4>

<pre><code>    Public Sub creatingHierarchicalGridInUnboundMode()
        'setup the master template
        Dim column As New GridViewImageColumn("Photo")
        column.ImageLayout = ImageLayout.Stretch
        RadGridView1.MasterTemplate.Columns.Add(column)
        Dim textColumn As New GridViewTextBoxColumn("Name")
        textColumn.Width = 150
        RadGridView1.MasterTemplate.Columns.Add(textColumn)
        RadGridView1.MasterTemplate.Columns.Add(New GridViewDecimalColumn("Salary"))
        Dim dateTimeColumn As New GridViewDateTimeColumn("Hire Date")
        dateTimeColumn.Width = 100
        dateTimeColumn.TextAlignment = ContentAlignment.MiddleCenter
        RadGridView1.MasterTemplate.Columns.Add(dateTimeColumn)
        textColumn = New GridViewTextBoxColumn("Title")
        textColumn.Width = 150
        RadGridView1.MasterTemplate.Columns.Add(textColumn)
        RadGridView1.MasterTemplate.Columns.Add(New GridViewCheckBoxColumn("Active"))
        RadGridView1.MasterTemplate.Columns.Add(New GridViewCommandColumn("Action"))

        'setup the child template
        Dim template As New GridViewTemplate()
        template.AllowAddNewRow = True
        template.Columns.Add(New GridViewTextBoxColumn("Name"))
        template.Columns.Add(New GridViewTextBoxColumn("Product Number"))
        template.Columns.Add(New GridViewDecimalColumn("Quantity"))
        template.Columns.Add(New GridViewDecimalColumn("Discount"))
        template.Columns.Add(New GridViewDecimalColumn("Total"))
        RadGridView1.MasterTemplate.Templates.Add(template)

        'create the relation
        Dim relation As New GridViewRelation(RadGridView1.MasterTemplate)
        relation.ChildTemplate = template
        relation.RelationName = "EmployeesOrders"
        relation.ParentColumnNames.Add("Name")
        relation.ChildColumnNames.Add("Name")
        RadGridView1.Relations.Add(relation)

        'load data
        LoadUnboundData()
    End Sub

    Private Sub LoadUnboundData()
        Using RadGridView1.DeferRefresh()
            For i As Integer = 0 To NwindDataSet.Employees.Count - 1
                Dim now As Long = Date.Now.Ticks
                Dim seed As Integer = CType(now And Integer.MaxValue, Integer)
                Dim random As New Random(seed)
                Dim row As NwindDataSet.EmployeesRow = NwindDataSet.Employees(i)
                Dim name As String = row.FirstName &amp; " " &amp; row.LastName
                RadGridView1.MasterTemplate.Rows.Add(GetImageFromData(row.Photo), name, random.Next(45000), row.HireDate, row.Title, (random.Next(100) &gt; 50), "View")
                Dim template As GridViewTemplate = RadGridView1.MasterTemplate.Templates(0)
                Dim rowCount As Integer = random.Next(20)
                For j As Integer = 0 To rowCount - 1
                    template.Rows.Add(name, random.Next(1000), random.Next(50), random.Next(100), random.Next(10000))
                Next j
            Next i
        End Using
    End Sub

    Private Function GetImageFromData(ByVal imageData() As Byte) As Image

        Const OleHeaderLength As Integer = 78

        Dim memoryStream As New MemoryStream()

        If HasOleContainerHeader(imageData) Then

            memoryStream.Write(imageData, OleHeaderLength, imageData.Length - OleHeaderLength)


        Else

            memoryStream.Write(imageData, 0, imageData.Length)

        End If

        Dim bitmap As New Bitmap(memoryStream)

        Return bitmap.GetThumbnailImage(55, 65, Nothing, New IntPtr())

    End Function

    Private Function HasOleContainerHeader(ByVal imageByteArray() As Byte) As Boolean

        Const OleByte0 As Byte = 21

        Const OleByte1 As Byte = 28

        Return (imageByteArray(0) = OleByte0) AndAlso (imageByteArray(1) = OleByte1)

    End Function
</code></pre>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

