<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Find and Replace</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Find and Replace">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("spread-processing/features/spreadprocessing-find-and-replace.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/spread-processing/features/spreadprocessing-find-and-replace.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="find-and-replace"><a href="#find-and-replace">Find and Replace</a></h1>

<p>The document model offers a convenient way to find and replace text and numbers in a workbook, worksheet or a specified range of cells. This article provides information about the options of the find and replace features and demonstrates how they can be used.</p>

<ul>
<li><p><a href="#find-and-findall">Find and FindAll</a></p></li>
<li><p><a href="#replace-and-replaceall">Replace and ReplaceAll</a></p></li>
</ul>

<h2 id="find-and-findall"><a href="#find-and-findall">Find and FindAll</a></h2>

<p>Both Workbook and Worksheet classes expose methods that search their contents for a specific value. The two classes offer a <strong>Find()</strong> method that returns the first occurrence of the sought string and a <strong>FindAll()</strong> method that displays all occurrences of the specified value. Both methods require a single parameter of type <strong>FindOptions</strong> that determines how the search is performed. The following list outlines the properties of the <strong>FindOptions</strong> class:</p>

<ul>
<li><p><strong>FindWhat</strong>: Specifies the sought string.</p></li>
<li><p><strong>FindWithin</strong>: Determines if the search is conducted for the whole Workbook or for a particular Worksheet. If you call the <strong>Find()</strong> method of the Workbook class and the <strong>FindWithin</strong> option is set to Workbook, the search is done for the entire workbook and if the option is Worksheet â€“ the search is performed only for the active worksheet. Note that if you call the <strong>Find()</strong> method of the Worksheet class, the <strong>FindWithin</strong> property is ignored and the search is done for the worksheet instance that invokes the search.</p></li>
<li><p><strong>FindBy</strong>: Indicates whether the search is performed by rows or by columns.</p></li>
<li><p><strong>FindIn</strong>: Shows if the search includes formulas or only result values.</p></li>
<li><p><strong>MatchCase</strong>: Determines if the search should match the casing of the sought string.</p></li>
<li><p><strong>MatchEntireCellContents</strong>: Indicates whether the sought string should match the entire cell content.</p></li>
<li><p><strong>StartCell</strong>: Marks the cell from which the search begins.</p></li>
<li><p><strong>SearchRanges</strong>: If the property is set to <strong>null</strong>, the search is performed in the entire workbook or worksheet, depending on the <strong>FindWithin</strong> property. If ranges are defined, the search is performed only for these ranges of the active sheet. Note that this property is taken into account only in the <strong>Find()</strong> and <strong>Replace()</strong> methods and disregarded in the <strong>FindAll()</strong> and <strong>ReplaceAll()</strong> methods.</p></li>
</ul>

<p><strong>Example 1</strong> creates a new workbook with two empty worksheets and assigns sample values to the sheets. The <strong>FindOptions</strong> created below specifies that the search will be conducted for the whole workbook and will start from cell A1 of the first worksheet. The sample snippet illustrates how to use <strong>Find()</strong> and <strong>FindAll()</strong> methods.</p>

<h4><strong>[C#] Example 1: Perform find an find all</strong></h4>

<pre><code>            Workbook workbook = new Workbook();
            Worksheet worksheet1 = workbook.Worksheets.Add();
            Worksheet worksheet2 = workbook.Worksheets.Add();

            worksheet1.Cells[1, 1].SetValue("SUMMARY");
            worksheet1.Cells[1, 2].SetValue("=SUM(5, 6)");

            worksheet2.Cells[2, 2].SetValue("=SUM(4, 4)");
            worksheet2.Cells[2, 3].SetValue("SUM");

            FindOptions options = new FindOptions()
            {
                StartCell = new WorksheetCellIndex(worksheet1, 0, 0),
                FindBy = FindBy.Rows,
                FindIn = FindInContentType.Formulas,
                FindWhat = "SUM",
                FindWithin = FindWithin.Workbook,
            };

            FindResult findResult = workbook.Find(options);
            IEnumerable&lt;FindResult&gt; findResults = workbook.FindAll(options);
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim workbook As New Workbook()
        Dim worksheet1 As Worksheet = workbook.Worksheets.Add()
        Dim worksheet2 As Worksheet = workbook.Worksheets.Add()

        worksheet1.Cells(1, 1).SetValue("SUMMARY")
        worksheet1.Cells(1, 2).SetValue("=SUM(5, 6)")

        worksheet2.Cells(2, 2).SetValue("=SUM(4, 4)")
        worksheet2.Cells(2, 3).SetValue("SUM")

        Dim options As New FindOptions() With { _
             .StartCell = New WorksheetCellIndex(worksheet1, 0, 0), _
            .FindBy = FindBy.Rows, _
            .FindIn = FindInContentType.Formulas, _
            .FindWhat = "SUM", _
            .FindWithin = FindWithin.Workbook _
        }

        Dim findResult As FindResult = workbook.Find(options)
        Dim findResults As IEnumerable(Of FindResult) = workbook.FindAll(options)
        '#End Region
    End Sub

    Public Sub Find2()
        ' #Region radspreadprocessing-features-find-and-replace_1
        Dim workbook As New Workbook()
        Dim worksheet1 As Worksheet = workbook.Worksheets.Add()
        Dim worksheet2 As Worksheet = workbook.Worksheets.Add()

        worksheet1.Cells(1, 1).SetValue("SUMMARY")
        worksheet1.Cells(1, 2).SetValue("=SUM(5, 6)")

        worksheet2.Cells(2, 2).SetValue("=SUM(4, 4)")
        worksheet2.Cells(2, 3).SetValue("SUM")

        Dim options As New ReplaceOptions() With { _
            .StartCell = New WorksheetCellIndex(worksheet1, 0, 0), _
            .FindBy = FindBy.Rows, _
            .FindIn = FindInContentType.Formulas, _
            .FindWhat = "SUM", _
            .ReplaceWith = "Test", _
            .FindWithin = FindWithin.Workbook _
        }

        Dim findResult = workbook.Find(options)

        options.StartCell = findResult.FoundCell

        If workbook.Replace(options) Then
            RadMessageBox.Show("Replace was successful!")
        End If

        workbook.ReplaceAll(options)
        '#End Region

    End Sub
End Class
</code></pre>

<h2 id="replace-and-replaceall"><a href="#replace-and-replaceall">Replace and ReplaceAll</a></h2>

<p>As a supplement to the <strong>Find()</strong> and <strong>FindAll()</strong> methods, the Workbook and Worksheet classes offer two more methods that allow you to alter the found strings: <strong>Replace()</strong> and <strong>ReplaceAll()</strong>. The former method replaces the string of the first occurrence while the latter alters all encountered occurrences. The two methods take one argument of type <strong>ReplaceOptions</strong> that specifies how the search is performed and also the string that should replace the occurrences. The class derives from <strong>FindOptions</strong> and defines one more property:</p>

<ul>
<li>
<strong>ReplaceWith</strong>: Specifies the string that will replace any found value.</li>
</ul>

<p><strong>Example 2</strong> creates a workbook from scratch with two empty worksheet and adds some sample values. The <strong>ReplaceOptions</strong> instance specifies that the replace is performed on the whole workbook and includes formula values. The operation starts from cell A1 of the first worksheet and the search is done by columns.</p>

<h4><strong>[C#] Example 2: Perform replace and replace all</strong></h4>

<pre><code>            Workbook workbook = new Workbook();
            Worksheet worksheet1 = workbook.Worksheets.Add();
            Worksheet worksheet2 = workbook.Worksheets.Add();

            worksheet1.Cells[1, 1].SetValue("SUMMARY");
            worksheet1.Cells[1, 2].SetValue("=SUM(5, 6)");

            worksheet2.Cells[2, 2].SetValue("=SUM(4, 4)");
            worksheet2.Cells[2, 3].SetValue("SUM");

            ReplaceOptions options = new ReplaceOptions()
            {
                StartCell = new WorksheetCellIndex(worksheet1, 0, 0),
                FindBy = FindBy.Rows,
                FindIn = FindInContentType.Formulas,
                FindWhat = "SUM",
                ReplaceWith = "Test",
                FindWithin = FindWithin.Workbook,
            };

            var findResult = workbook.Find(options);

            options.StartCell = findResult.FoundCell;

            if (workbook.Replace(options))
            {
                RadMessageBox.Show("Replace was successful!");
            }

            workbook.ReplaceAll(options);
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim workbook As New Workbook()
        Dim worksheet1 As Worksheet = workbook.Worksheets.Add()
        Dim worksheet2 As Worksheet = workbook.Worksheets.Add()

        worksheet1.Cells(1, 1).SetValue("SUMMARY")
        worksheet1.Cells(1, 2).SetValue("=SUM(5, 6)")

        worksheet2.Cells(2, 2).SetValue("=SUM(4, 4)")
        worksheet2.Cells(2, 3).SetValue("SUM")

        Dim options As New ReplaceOptions() With { _
            .StartCell = New WorksheetCellIndex(worksheet1, 0, 0), _
            .FindBy = FindBy.Rows, _
            .FindIn = FindInContentType.Formulas, _
            .FindWhat = "SUM", _
            .ReplaceWith = "Test", _
            .FindWithin = FindWithin.Workbook _
        }

        Dim findResult = workbook.Find(options)

        options.StartCell = findResult.FoundCell

        If workbook.Replace(options) Then
            RadMessageBox.Show("Replace was successful!")
        End If

        workbook.ReplaceAll(options)
        '#End Region

    End Sub
End Class
</code></pre>

<h1 id="see-also"><a href="#see-also">See Also</a></h1>

<ul>
<li><a href="/devtools/winforms/spread-processing/working-with-worksheets/spreadprocessing-activate-worksheet">Activate a Worksheet</a></li>
</ul>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

