<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Shapes and Images</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Shapes and Images">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-849dcaf701d866988e8c3593f15b66de.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/" title="WinForms Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/winforms.aspx" title="About UI for WinForms" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/winforms.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/winforms/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("spread-processing/features/spreadprocessing-shapes-and-images.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/spread-processing/features/spreadprocessing-shapes-and-images.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="shapes-and-images"><a href="#shapes-and-images">Shapes and Images</a></h1>

<p>This article briefly describes what are shapes and images, and how to create and work with them.  It contains the following sections:</p>

<ul>
<li><p><a href="#what-are-shapes-and-images?">What Are Shapes and Images?</a></p></li>
<li><p><a href="#properties-of-shapes-and-images">Properties of Shapes and Images</a></p></li>
<li><p><a href="#creating-and-inserting-an-image">Creating and Inserting an Image</a></p></li>
<li><p><a href="#deleting-a-shape">Deleting a Shape</a></p></li>
<li><p><a href="#changing-the-shape's-position-and-size">Changing the Shape's Position and Size</a></p></li>
<li><p><a href="#relationship-between-the-cell-index-of-the-shape-and-its-rotation-angle">Relationship Between the Cell Index of the Shape and Its Rotation Angle</a></p></li>
</ul>

<h2 id="what-are-shapes-and-images"><a href="#what-are-shapes-and-images">What Are Shapes and Images?</a></h2>

<p>The shapes are objects which represent a visual illustration which can be inserted in a worksheet. In the document model they are represented by the abstract class <strong>FloatingShapeBase</strong>.</p>

<p>The image is a kind of shape which is characterized by having an image source. They are represented by the <strong>FloatingImage</strong> class, which inherits FloatingShapeBase.</p>

<h2 id="properties-of-shapes-and-images"><a href="#properties-of-shapes-and-images">Properties of Shapes and Images</a></h2>

<p>Shapes have the following properties:</p>

<ul>
<li><p>__CellIndex:__The cell index where the top left corner of the shape is located when the shape is not rotated.</p></li>
<li><p>__OffsetX:__The offset between the left side of the shape and the left side of the cell index.</p></li>
<li><p>__OffsetY:__The offset between the top of the shape and the top of the cell index.</p></li>
<li><p>__Width:__The width of the shape.</p></li>
<li><p>__Height:__The height of the shape.</p></li>
<li><p>__RotationAngle:__The angle (in degrees) by which the shape is rotated about its center.</p></li>
<li><p>__IsHorizontallyFlipped:__Indicates whether the shape has been flipped across the y-axis.</p></li>
<li><p>__IsVerticallyFlipped:__Indicates whether the shape has been flipped across the x-axis.</p></li>
<li><p>__Name:__The name of the shape.</p></li>
<li><p><strong>LockAspectRatio</strong>: Determines whether the aspect ratio between the width and the height of the image will be preserved.</p></li>
<li><p>__Id:__A unique number assigned to the image after it has been added to a worksheet.</p></li>
<li><p>__Worksheet:__The worksheet in which the shape is or will be inserted.</p></li>
</ul>

<p>Images have one additional property:</p>

<ul>
<li>__ImageSource:__Represents the source of the image.</li>
</ul>

<h2 id="creating-and-inserting-an-image"><a href="#creating-and-inserting-an-image">Creating and Inserting an Image</a></h2>

<p>To insert an image into a worksheet do the following:</p>

<ol>
<li><p>Create a <strong>FloatingImage</strong> instance as in <strong>Example 1</strong>.</p></li>
<li><p>Configure its properties as in <strong>Example 2</strong>.</p></li>
<li><p>Insert the image into the worksheet as shown in <strong>Example 3</strong>.</p></li>
</ol>

<p>In order to create an instance of <strong>FloatingImage</strong> you need the worksheet in which you want to insert the image, the cell index and the offset.</p>

<h4><strong>[C#] Example 1: Create FloatingImage</strong></h4>

<pre><code>            FloatingImage image = new FloatingImage(worksheet, new CellIndex(7, 1), 35, 10);
</code></pre>

<h4><strong>[VB] Example 1: Create FloatingImage</strong></h4>

<pre><code>        Dim image As New FloatingImage(worksheet, New CellIndex(7, 1), 35, 10)

        '#End Region
        Dim filePath As String = ""
        '#Region "radspreadprocessing-features-shapes-and-images_01"
        Dim stream As FileStream = File.Open(filePath, FileMode.Open)

        Using stream
            image.ImageSource = New Telerik.Windows.Documents.Media.ImageSource(stream, "jpg")
        End Using

        image.Width = 330
        image.Height = 45
        image.RotationAngle = 20


        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_02"
        worksheet.Shapes.Add(image)

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_03"
        worksheet.Shapes.Remove(image)

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_04"
        image.CellIndex = New CellIndex(4, 5)
        image.OffsetX = 10
        image.OffsetY = 10

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_05"
        image.Width -= 50
        image.Height += 50

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_06"
        image.RotationAngle = 40

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_07"
        image.IsHorizontallyFlipped = True

        '#End Region


        '#Region "radspreadprocessing-features-shapes-and-images_08"

        image.SetWidth(False, 330)
        image.SetHeight(True, 45)

        '#End Region
    End Sub
End Class
</code></pre>

<p>The next step is to configure the other properties of the image as needed.</p>

<h4><strong>[C#] Example 2: Configure image properties</strong></h4>

<pre><code>            FileStream stream = File.Open(filePath, FileMode.Open);

            using (stream)
            {
                image.ImageSource = new Telerik.Windows.Documents.Media.ImageSource(stream, "jpg");
            }

            image.Width = 330;
            image.Height = 45;
            image.RotationAngle = 20;
</code></pre>

<h4><strong>[VB] Example 2: Configure image properties</strong></h4>

<pre><code>        Dim stream As FileStream = File.Open(filePath, FileMode.Open)

        Using stream
            image.ImageSource = New Telerik.Windows.Documents.Media.ImageSource(stream, "jpg")
        End Using

        image.Width = 330
        image.Height = 45
        image.RotationAngle = 20


        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_02"
        worksheet.Shapes.Add(image)

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_03"
        worksheet.Shapes.Remove(image)

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_04"
        image.CellIndex = New CellIndex(4, 5)
        image.OffsetX = 10
        image.OffsetY = 10

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_05"
        image.Width -= 50
        image.Height += 50

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_06"
        image.RotationAngle = 40

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_07"
        image.IsHorizontallyFlipped = True

        '#End Region


        '#Region "radspreadprocessing-features-shapes-and-images_08"

        image.SetWidth(False, 330)
        image.SetHeight(True, 45)

        '#End Region
    End Sub
End Class
</code></pre>

<p>Insert the image into the collection of shapes of the worksheet.  Note that the worksheet needs to be the same as the one passed in the FloatingImage constructor, otherwise an exception is thrown.</p>

<h4><strong>[C#] Example 3: Add image to worksheet</strong></h4>

<pre><code>            worksheet.Shapes.Add(image);
</code></pre>

<h4><strong>[VB] Example 3: Add image to worksheet</strong></h4>

<pre><code>        worksheet.Shapes.Add(image)

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_03"
        worksheet.Shapes.Remove(image)

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_04"
        image.CellIndex = New CellIndex(4, 5)
        image.OffsetX = 10
        image.OffsetY = 10

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_05"
        image.Width -= 50
        image.Height += 50

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_06"
        image.RotationAngle = 40

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_07"
        image.IsHorizontallyFlipped = True

        '#End Region


        '#Region "radspreadprocessing-features-shapes-and-images_08"

        image.SetWidth(False, 330)
        image.SetHeight(True, 45)

        '#End Region
    End Sub
End Class
</code></pre>

<h2 id="deleting-a-shape"><a href="#deleting-a-shape">Deleting a Shape</a></h2>

<p>In order to delete a shape from a worksheet, you need the shape's instance. The collection of shapes of the worksheet exposes a <strong>Remove()</strong> method with two overloads which you can use.</p>

<p><strong>Example 4</strong> demonstrates how you can remove the image added in <strong>Example 3</strong>.</p>

<h4><strong>[C#] Delete shape</strong></h4>

<pre><code>            worksheet.Shapes.Remove(image);
</code></pre>

<h4><strong>[VB] Delete shape</strong></h4>

<pre><code>        worksheet.Shapes.Remove(image)

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_04"
        image.CellIndex = New CellIndex(4, 5)
        image.OffsetX = 10
        image.OffsetY = 10

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_05"
        image.Width -= 50
        image.Height += 50

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_06"
        image.RotationAngle = 40

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_07"
        image.IsHorizontallyFlipped = True

        '#End Region


        '#Region "radspreadprocessing-features-shapes-and-images_08"

        image.SetWidth(False, 330)
        image.SetHeight(True, 45)

        '#End Region
    End Sub
End Class
</code></pre>

<h2 id="changing-the-shapes-position-and-size"><a href="#changing-the-shapes-position-and-size">Changing the Shape's Position and Size</a></h2>

<p>After the initial values of the properties of the shapes have been assigned, they can always be changed in order to reposition, resize and rotate the shape. You can change the following characteristics of the shapes:</p>

<ol>
<li>Repositioning the shape</li>
</ol>

<h4><strong>[C#] Example 5: Move image</strong></h4>

<pre><code>            image.CellIndex = new CellIndex(4, 5);
            image.OffsetX = 10;
            image.OffsetY = 10;
</code></pre>

<h4><strong>[VB] Example 5: Move image</strong></h4>

<pre><code>        image.CellIndex = New CellIndex(4, 5)
        image.OffsetX = 10
        image.OffsetY = 10

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_05"
        image.Width -= 50
        image.Height += 50

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_06"
        image.RotationAngle = 40

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_07"
        image.IsHorizontallyFlipped = True

        '#End Region


        '#Region "radspreadprocessing-features-shapes-and-images_08"

        image.SetWidth(False, 330)
        image.SetHeight(True, 45)

        '#End Region
    End Sub
End Class
</code></pre>

<ol>
<li>Changing the shape's width and height</li>
</ol>

<h4><strong>[C#] Example 6: Change width and height</strong></h4>

<pre><code>            image.Width -= 50;
            image.Height += 50;
</code></pre>

<h4><strong>[VB] Example 6: Change width and height</strong></h4>

<pre><code>        image.Width -= 50
        image.Height += 50

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_06"
        image.RotationAngle = 40

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_07"
        image.IsHorizontallyFlipped = True

        '#End Region


        '#Region "radspreadprocessing-features-shapes-and-images_08"

        image.SetWidth(False, 330)
        image.SetHeight(True, 45)

        '#End Region
    End Sub
End Class
</code></pre>

<p>The Width and Height properties do not take the LockAspectRatio property into account. If you would like more control on whether the aspect ratio of the shape should be observed, you can also use the following methods.</p>

<ul>
<li><p>void SetWidth(bool respectLockAspectRatio, double width, bool adjustCellIndex = false)</p></li>
<li><p>void SetHeight(bool respectLockAspectRatio, double height, bool adjustCellIndex = false)</p></li>
</ul>

<h4><strong>[C#] Example 7: Set width and whether lock aspect ratio is respected</strong></h4>

<pre><code>            image.SetWidth(false, 330);
            image.SetHeight(true, 45);
</code></pre>

<h4><strong>[VB] Example 7: Set width and whether lock aspect ratio is respected</strong></h4>

<pre><code>        image.SetWidth(False, 330)
        image.SetHeight(True, 45)

        '#End Region
    End Sub
End Class
</code></pre>

<p>These two methods will be further explained in the next section.</p>

<ol>
<li>Rotating the shape</li>
</ol>

<h4><strong>[C#] Example 7: Rotate</strong></h4>

<pre><code>            image.RotationAngle = 40;
</code></pre>

<h4><strong>[VB] Example 7: Rotate</strong></h4>

<pre><code>        image.RotationAngle = 40

        '#End Region

        '#Region "radspreadprocessing-features-shapes-and-images_07"
        image.IsHorizontallyFlipped = True

        '#End Region


        '#Region "radspreadprocessing-features-shapes-and-images_08"

        image.SetWidth(False, 330)
        image.SetHeight(True, 45)

        '#End Region
    End Sub
End Class
</code></pre>

<p>The rotation angle of the shape can affect the <strong>CellIndexM</strong> property and the offset. The relationship between these properties is described in more detail in the next section of this article.</p>

<ol>
<li>Flipping the shape</li>
</ol>

<h4><strong>[C#] Example 8: Flip</strong></h4>

<pre><code>            image.IsHorizontallyFlipped = true;
</code></pre>

<h4><strong>[VB] Example 8: Flip</strong></h4>

<pre><code>        image.IsHorizontallyFlipped = True

        '#End Region


        '#Region "radspreadprocessing-features-shapes-and-images_08"

        image.SetWidth(False, 330)
        image.SetHeight(True, 45)

        '#End Region
    End Sub
End Class
</code></pre>

<h2 id="relationship-between-the-cell-index-of-the-shape-and-its-rotation-angle"><a href="#relationship-between-the-cell-index-of-the-shape-and-its-rotation-angle">Relationship Between the Cell Index of the Shape and Its Rotation Angle</a></h2>

<p>The <strong>CellIndex</strong> of the shape and the cell index where the top left corner of the shape is visually located do not necessarily coincide when there is rotation applied. Consider the following image which has CellIndex B8.<br>
        <img src="images/spreadprocessing-features-shapes-and-images001.png" alt="spreadprocessing-features-shapes-and-images 001"></p>

<p>If we increase the rotation angle of the image, it will be visualized differently.<br>
        <img src="images/spreadprocessing-features-shapes-and-images002.png" alt="spreadprocessing-features-shapes-and-images 002"></p>

<p>It appears that the top left cell index is B5, however, the CellIndex property of the image will remain unchanged, B8, as will the offset.</p>

<p>This set up is convenient as it allows for more intuitive rotation of the shapes. However, when the rotation angle increases substantially, the underlying CellIndex of the shape might become too distant to be useful. In order to avoid this, once the rotation angle becomes 45° and more, the CellIndex switches to where the top left corner would be at 90° rotation.</p>

<p>This is illustrated in the following images:<br>
        <img src="images/spreadprocessing-features-shapes-and-images003.png" alt="spreadprocessing-features-shapes-and-images 003"></p>

<p>At this point, the CellIndex property of the shape is D1 and the offset is also recalculated accordingly.<br>
        <img src="images/spreadprocessing-features-shapes-and-images004.png" alt="spreadprocessing-features-shapes-and-images 004"></p>

<p>As rotation increases, the CellIndex of the shape will switch between B8 and D1, depending on what is closer to the visual top left corner of the shape. The result will be the following:</p>

<ul>
<li><p>0° - 45° (excluded): <strong>B8</strong></p></li>
<li><p>45° (included) - 135° (excluded): <strong>D1</strong></p></li>
<li><p>135° (included) - 225° (excluded): <strong>B8</strong></p></li>
<li><p>225° (included) - 315° (excluded): <strong>D1</strong></p></li>
<li><p>315° (included) - 360°: <strong>B8</strong></p></li>
</ul>

<p>Another occasion when adjustments to the top left cell index and offset of a shape might be necessary is when the size of a rotated image is changed. Changing the top left position of the image might be necessary if it is desired that the visual top left corner of the shape remains unmoved.</p>

<p>Additionally, if the size and the rotation angle of the image will result in a top left position outside of the worksheet, the position needs to be automatically adjusted to fit inside it.</p>

<p>In order to provide more flexibility, the model gives the option to have these changes of the top left position of the shape automatically performed or not. The properties <strong>RotationAngle</strong>, <strong>Width</strong> and <strong>Height</strong> do not make any adjustments to the position of the shape. If you would like to enable the adjustments, you can use the following methods:</p>

<ul>
<li><p>void SetWidth(bool respectLockAspectRatio, double width, bool adjustCellIndex = false)</p></li>
<li><p>void SetHeight(bool respectLockAspectRatio, double height, bool adjustCellIndex = false)</p></li>
<li><p>void SetRotationAngle(double rotationAngle, bool adjustCellIndex = false)</p></li>
</ul>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

