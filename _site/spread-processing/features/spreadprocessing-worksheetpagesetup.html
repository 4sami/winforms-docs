<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Worksheet Page Setup</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Worksheet Page Setup">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("spread-processing/features/spreadprocessing-worksheetpagesetup.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/spread-processing/features/spreadprocessing-worksheetpagesetup.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="worksheet-page-setup"><a href="#worksheet-page-setup">Worksheet Page Setup</a></h1>

<p>There are cases, such as printing or exporting scenarios, when you need to present the <strong>Worksheet</strong>'s content on a set of pages. In these cases particularly handy comes the <strong>WorksheetPageSetup</strong> class which provides you with the needed properties for controlling how the content is split and presented into pages.</p>

<p>This article aims to present the WorksheetPageSetup API and demonstrate how to use it. It contains the following sections:</p>

<ul>
<li><p><a href="#worksheetpagesetup-properties">WorksheetPageSetup Properties</a></p></li>
<li><p><a href="#using-print-area">Using Print Area</a></p></li>
<li><p><a href="#using-page-breaks">Using Page Breaks</a></p></li>
</ul>

<h2 id="worksheetpagesetup-properties"><a href="#worksheetpagesetup-properties">WorksheetPageSetup Properties</a></h2>

<p>Through the Worksheet's <strong>WorksheetPageSetup</strong> property you may change the following worksheet's page setup properties:</p>

<ul>
<li><p><strong>PaperType</strong>: Specify paper type using the<br>
          <a href="http://www.telerik.com/help/wpf/t_telerik_windows_documents_model_papertypes.html">PaperType</a><br>
          enumeration.</p></li>
<li><p><strong>PageOrientation</strong>: Specify whether the page orientation should be Portrait or Landscape.</p></li>
<li><p><strong>Margins</strong>: Specify the sizes of the page margins.</p></li>
<li><p><strong>PageOrder</strong>: Specify whether the page order should be "Down, then over" or "Over, then down".</p></li>
<li><p><strong>CenterHorizontally</strong>: Specify whether the print content should be centered horizontally within the area between the page margins.</p></li>
<li><p><strong>CenterVertically</strong>: Specify whether the print content should be centered vertically within the area between the page margins.</p></li>
<li><p><strong>ScaleFactor</strong>: Specify the scale factor to print with value in range from 50% to 400%.</p></li>
<li><p><strong>PrintOptions</strong>: Specify print options such as whether to print gridlines or row and column headings.</p></li>
<li><p><strong>PrintArea</strong>: Change the print area in the selected worksheet.</p></li>
<li><p><strong>PageBreaks</strong>: Change the page breaks collection in the selected worksheet.</p></li>
</ul>

<p><strong>Figures 1 and 2</strong> show an example of Worksheet's page setup usage. In the example we have spreadsheet data that has bigger width than height. Previewing the print pages with the default settings we can see that it doesn't fit well as the print content is split in 2 pages.</p>

<p>Figure 1: Initial Print Preview of Data<img src="images/spreadprocessing-features-worksheetpagesetup001.png" alt="spreadprocessing-features-worksheetpagesetup 001"></p>

<p>In order to fit the print content better we use the Worksheet's page setup and change page orientation as well as the scale factor and some additional print settings. <strong>Example 1</strong> shows the code that needs to be executed.</p>

<h4><strong>[C#] Example 1: Use WorksheetPageSetup</strong></h4>

<pre><code>            WorksheetPageSetup pageSetup = workbook.ActiveWorksheet.WorksheetPageSetup;

            pageSetup.PaperType = PaperTypes.A4;
            pageSetup.PageOrientation = PageOrientation.Landscape;
            pageSetup.ScaleFactor = new Size(0.9, 0.9);
            pageSetup.CenterHorizontally = true;
</code></pre>

<h4><strong>[VB] Example 1: Use WorksheetPageSetup</strong></h4>

<pre><code>        Dim pageSetup As WorksheetPageSetup = workbook.ActiveWorksheet.WorksheetPageSetup

        pageSetup.PaperType = PaperTypes.A4
        pageSetup.PageOrientation = PageOrientation.Landscape
        pageSetup.ScaleFactor = New Size(0.9, 0.9)
        pageSetup.CenterHorizontally = True
        '#End Region
    End Sub

    Private Sub SetPrintArea(workbook As Workbook)
        '#Region "radspreadprocessing-features-worksheetpagesetup_1"
        Dim printArea As PrintArea = workbook.ActiveWorksheet.WorksheetPageSetup.PrintArea

        printArea.SetPrintArea(New CellRange() {New CellRange(0, 0, 4, 8), New CellRange(1, 1, 25, 3)})
        '#End Region
    End Sub

    Private Sub InsertPageBreaks(workbook As Workbook)
        '#Region "radspreadprocessing-features-worksheetpagesetup_2"
        Dim pageBreaks As PageBreaks = workbook.ActiveWorksheet.WorksheetPageSetup.PageBreaks

        pageBreaks.TryInsertHorizontalPageBreak(5, 0)
        pageBreaks.TryInsertHorizontalPageBreak(8, 0)
        pageBreaks.TryInsertHorizontalPageBreak(11, 0)
        pageBreaks.TryInsertHorizontalPageBreak(14, 0)
        pageBreaks.TryInsertHorizontalPageBreak(17, 0)
        pageBreaks.TryInsertHorizontalPageBreak(20, 0)
        pageBreaks.TryInsertHorizontalPageBreak(23, 0)
        '#End Region
    End Sub
End Class
</code></pre>

<p>As a result we managed to fit the data in to a single page with size A4 as shown in <strong>Figure 2</strong>.</p>

<p>Figure 2: Result After Page Setup<img src="images/spreadprocessing-features-worksheetpagesetup002.png" alt="spreadprocessing-features-worksheetpagesetup 002"></p>

<h2 id="using-print-area"><a href="#using-print-area">Using Print Area</a></h2>

<p>When printing a worksheet by default the whole used cell range is used for printing. If you do not need to print the whole worksheet's content you can set a print area by specifying a list of ranges to print.</p>

<p>Through WorksheetPageSetup's <strong>PrintArea</strong> property you can access the print area of a worksheet and change its print ranges with the following methods:</p>

<ul>
<li><p><strong>SetPrintArea()</strong>: Sets the print area ranges using some given set of CellRange instances. This method clears all previously set ranges.</p></li>
<li><p><strong>CanAddToPrintArea()</strong>: Returns a Boolean indicating whether the passed set of print ranges can be added in the existing print area. If some of the given ranges intersects with an already existing print area range, the result is false.</p></li>
<li><p><strong>TryAddToPrintArea()</strong>: Tries to add some given set of CellRange instances to the collection of areas and returns a Boolean indicating the success of this operation.</p></li>
<li><p><strong>Clear()</strong>: Clears the existing print area ranges.</p></li>
</ul>

<p>The example shown in <strong>Figures 3</strong> demonstrates how to use Worksheet's print area. In the example we have a big table with data and we want to print only two specific ranges. To achieve that the print area is set with these cell ranges in <strong>Example 2</strong> code snippet.</p>

<h4><strong>[C#] Example 2: Set PrintArea</strong></h4>

<pre><code>            PrintArea printArea = workbook.ActiveWorksheet.WorksheetPageSetup.PrintArea;

            printArea.SetPrintArea(new CellRange[]
            {
                new CellRange(0, 0, 4, 8),
                new CellRange(1, 1, 25, 3)
            });
</code></pre>

<h4><strong>[VB] Example 2: Set PrintArea</strong></h4>

<pre><code>        Dim printArea As PrintArea = workbook.ActiveWorksheet.WorksheetPageSetup.PrintArea

        printArea.SetPrintArea(New CellRange() {New CellRange(0, 0, 4, 8), New CellRange(1, 1, 25, 3)})
        '#End Region
    End Sub

    Private Sub InsertPageBreaks(workbook As Workbook)
        '#Region "radspreadprocessing-features-worksheetpagesetup_2"
        Dim pageBreaks As PageBreaks = workbook.ActiveWorksheet.WorksheetPageSetup.PageBreaks

        pageBreaks.TryInsertHorizontalPageBreak(5, 0)
        pageBreaks.TryInsertHorizontalPageBreak(8, 0)
        pageBreaks.TryInsertHorizontalPageBreak(11, 0)
        pageBreaks.TryInsertHorizontalPageBreak(14, 0)
        pageBreaks.TryInsertHorizontalPageBreak(17, 0)
        pageBreaks.TryInsertHorizontalPageBreak(20, 0)
        pageBreaks.TryInsertHorizontalPageBreak(23, 0)
        '#End Region
    End Sub
End Class
</code></pre>

<p>Figure 3: Resulting PrintArea Preview<img src="images/spreadprocessing-features-worksheetpagesetup003.png" alt="spreadprocessing-features-worksheetpagesetup 003"></p>

<h2 id="using-page-breaks"><a href="#using-page-breaks">Using Page Breaks</a></h2>

<p>When a big cell range cannot fit into a single page it gets split onto multiple pages. If you need your pages to be split in some concrete places you can specify these places by placing a PageBreak.</p>

<p>Through WorksheetPageSetup's <strong>PageBreaks</strong> property you can manipulate the page breaks collection of a worksheet using the following methods:</p>

<ul>
<li><p><strong>TryInsertHorizontalPageBreak()</strong>: Tries to insert a horizontal page break at some specific index. Returns true when a page break is inserted.</p></li>
<li><p><strong>TryInsertHorizontalPageBreak()</strong>: Tries to insert a horizontal page break at some specific index. Returns true when a page break is inserted.</p></li>
<li><p><strong>TryInsertVerticalPageBreak()</strong>: Tries to insert a vertical page break at some specific index. Returns true when a page break is inserted.</p></li>
<li><p><strong>TryRemoveHorizontalPageBreak()</strong>: Tries to remove a horizontal page break at some specific index. Returns true when a page break is removed.</p></li>
<li><p><strong>TryRemoveVerticalPageBreak()</strong>: Tries to remove a vertical page break at some specific index. Returns true when a page break is removed.</p></li>
<li><p><strong>TryInsertPageBreaks()</strong>: Tries to insert horizontal and vertical page break at some specific index. Returns true when at least one page break is inserted.</p></li>
<li><p><strong>TryRemovePageBreaks()</strong>: Tries to remove horizontal and vertical page break at some specific index. Returns true when at least one page break is removed.</p></li>
<li><p><strong>Clear()</strong>: Clears all existing page breaks from the page breaks collection.</p></li>
</ul>

<p><strong>Figure 4</strong> shows a preview of large amount of data.</p>

<p>Figure 4: Initial Preview of Data<img src="images/spreadprocessing-features-worksheetpagesetup004.png" alt="spreadprocessing-features-worksheetpagesetup 004"></p>

<p>In order to separate semantically-correct the print data onto several pages we are going to place horizontal page breaks at the place where we need the splitting to happen. <strong>Example 3</strong> shows exactly how this can be achieved:</p>

<h4><strong>[C#] Example 3: Insert PageBreaks</strong></h4>

<pre><code>            PageBreaks pageBreaks = workbook.ActiveWorksheet.WorksheetPageSetup.PageBreaks;

            pageBreaks.TryInsertHorizontalPageBreak(5, 0);
            pageBreaks.TryInsertHorizontalPageBreak(8, 0);
            pageBreaks.TryInsertHorizontalPageBreak(11, 0);
            pageBreaks.TryInsertHorizontalPageBreak(14, 0);
            pageBreaks.TryInsertHorizontalPageBreak(17, 0);
            pageBreaks.TryInsertHorizontalPageBreak(20, 0);
            pageBreaks.TryInsertHorizontalPageBreak(23, 0);
</code></pre>

<h4><strong>[VB] Example 3: Insert PageBreaks</strong></h4>

<pre><code>        Dim pageBreaks As PageBreaks = workbook.ActiveWorksheet.WorksheetPageSetup.PageBreaks

        pageBreaks.TryInsertHorizontalPageBreak(5, 0)
        pageBreaks.TryInsertHorizontalPageBreak(8, 0)
        pageBreaks.TryInsertHorizontalPageBreak(11, 0)
        pageBreaks.TryInsertHorizontalPageBreak(14, 0)
        pageBreaks.TryInsertHorizontalPageBreak(17, 0)
        pageBreaks.TryInsertHorizontalPageBreak(20, 0)
        pageBreaks.TryInsertHorizontalPageBreak(23, 0)
        '#End Region
    End Sub
End Class
</code></pre>

<p>As a result from inserting these horizontal page breaks we have eight pages to print. The first one is shown in <strong>Figure 5</strong>.</p>

<p>Figure 5: Result of PageBreaks<img src="images/spreadprocessing-features-worksheetpagesetup005.png" alt="spreadprocessing-features-worksheetpagesetup 005"></p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

