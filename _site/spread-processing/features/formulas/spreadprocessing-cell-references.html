<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Cell References</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Cell References">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("spread-processing/features/formulas/spreadprocessing-cell-references.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/spread-processing/features/formulas/spreadprocessing-cell-references.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="cell-references"><a href="#cell-references">Cell References</a></h1>

<p>Apart from values, operators and functions, formulas can refer to other cells or ranges of cells. Using cell references in expressions is very convenient since they allow you to process data that is already in the workbook and thus avoid duplication of data. Further, when the value of the referred cell changes, the formula that holds the reference updates automatically.</p>

<h2 id="cell-reference-overview"><a href="#cell-reference-overview">Cell Reference Overview</a></h2>

<p>To include a cell reference in a formula, simply specify the column letter of the cell followed by its row number, e.g. <em>A1, C15, BD12</em> etc. Cell references can be used in expressions like variables; they can appear as standalone values, operands, and arguments of functions.</p>

<p>To display the sum of cells A1 and B1 in cell C1, you can invoke the <strong>SetValue()</strong> method for cell C1 and pass the string <em>=A1+B1</em> as a parameter.</p>

<p><strong>Example 1</strong> creates a workbook with a single worksheet before setting the value of C1:</p>

<h4><strong>[C#] Example 1: Set reference value</strong></h4>

<pre><code>            Workbook workbook = new Workbook();
            workbook.Worksheets.Add();
            workbook.ActiveWorksheet.Cells[0, 2].SetValue("=A1+B1");
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim workbook As New Workbook()
        workbook.Worksheets.Add()
        workbook.ActiveWorksheet.Cells(0, 2).SetValue("=A1+B1")
        '#End Region

        '#Region "radspreadprocessing-features-formulas-cell-references_1"
        workbook.Worksheets.Add()
        Dim sheet1 As Worksheet = workbook.Worksheets(0)
        Dim samsWorksheet As Worksheet = workbook.Worksheets(1)
        samsWorksheet.Name = "Sam'sWorksheet"

        sheet1.Cells(0, 0).SetValue("='Sam''sWorksheet'!B2")
        '#End Region

        '#Region "radspreadprocessing-features-formulas-cell-references_2"
       sheet1.Cells(2, 2).SetValue("=SUM(A1:B2)")
        samsWorksheet.Cells(0, 0).SetValue("=PRODUCT(D3:F5)")
        '#End Region

    End Sub

End Class
</code></pre>

<p>Cell references may optionally specify the worksheet of the referenced cell. To use such references in expressions specify the worksheet name followed by exclamation mark and the name of the cell you would like to refer to. If the name of the worksheet contains symbols other than letters and digits, the name should be escaped using single quotes. First, the value should be surrounded with single quotes and if the name itself contains single quotes, these should be doubled. For instance, to create an absolute reference to cell A1 in <em>Sam'sSheet</em> worksheet, add to your formula the string <em>'Sam''sSheet'!A1</em>. If the worksheet is not specified, it is assumed that the referenced cell is in the current worksheet.</p>

<p><strong>Example 2</strong> adds a worksheet to the workbook and renames the newly created instance. Moreover, the example sets the value of cell A1 in <em>Sheet1</em> to refer to cell B2 in the new sheet:</p>

<h4><strong>[C#] Example 2: Set reference value from another sheet</strong></h4>

<pre><code>            workbook.Worksheets.Add();
            Worksheet sheet1 = workbook.Worksheets[0];
            Worksheet samsWorksheet = workbook.Worksheets[1];
            samsWorksheet.Name = "Sam'sWorksheet";

            sheet1.Cells[0, 0].SetValue("='Sam''sWorksheet'!B2");
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        workbook.Worksheets.Add()
        Dim sheet1 As Worksheet = workbook.Worksheets(0)
        Dim samsWorksheet As Worksheet = workbook.Worksheets(1)
        samsWorksheet.Name = "Sam'sWorksheet"

        sheet1.Cells(0, 0).SetValue("='Sam''sWorksheet'!B2")
        '#End Region

        '#Region "radspreadprocessing-features-formulas-cell-references_2"
       sheet1.Cells(2, 2).SetValue("=SUM(A1:B2)")
        samsWorksheet.Cells(0, 0).SetValue("=PRODUCT(D3:F5)")
        '#End Region

    End Sub

End Class
</code></pre>

<p>Formulas can also refer to whole ranges of cells. References to cell ranges are constructed via the colon (:) operator â€“ a binary operator that takes two cell references and returns a reference to all cells between the two operands, including these operands. For example, the value =SUM(A1:B2) adds the values of cells A1, A2, B1 and B2. Similarly, the expression <strong>=PRODUCT(D3:F5)</strong> multiplies the contents of the cells D3, D4, D5, E3, E4, E5, F3, F4 and F5.</p>

<p><strong>Example 3</strong> demonstrates how to add a reference to a whole cell range.</p>

<h4><strong>[C#] Example 3: Set reference to cell range</strong></h4>

<pre><code>            sheet1.Cells[2, 2].SetValue("=SUM(A1:B2)");
            samsWorksheet.Cells[0, 0].SetValue("=PRODUCT(D3:F5)");
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>       sheet1.Cells(2, 2).SetValue("=SUM(A1:B2)")
        samsWorksheet.Cells(0, 0).SetValue("=PRODUCT(D3:F5)")
        '#End Region

    End Sub

End Class
</code></pre>

<h2 id="cell-reference-types"><a href="#cell-reference-types">Cell Reference Types</a></h2>

<p>Based on whether a reference relates to the referenced cell or the cell that holds the reference, the reference falls in one of the following categories: absolute, relative, mixed. This relation also determines the behavior of the cell reference when the formula that contains it is copied.<br>
        Absolute Cell References</p>

<p>Absolute cell references require a dollar sign ($) to be placed before the column letter and row number, e.g. <em>$A$1, $BC$100</em>. References of this type are bound to the cell they reference. When you copy the formula that holds the reference and paste it to another location, the reference still points to the same cell. Also, if the formula is a subject to auto fill, the newly produced formulas contain references to one and the same cell.</p>

<p>If cell B2 has the value =$A$1*12 and you copy and paste the contents of B2 in cell D10, the pasted formula will again point to A1 and, in fact, the string value of D10 will be exactly the same as in B2 =$A$1*12.<br>
            Relative Cell References</p>

<p>Unlike absolute references, relative cell references are based on their position relative to the cell holding the reference. The relative reference is specified through the horizontal and vertical offset between the referenced cell and the cell that contains the reference using the latter as a starting point. Thus, when a formula holding relative reference is copied and pasted, the newly created formula points to a cell with same horizontal and vertical offset as specified in the original expression.</p>

<p>For example, if cell C2 contains the value =A1 and you copy cell C2 and paste it in cell E4, the new value will point to a cell that is one row above and two columns to the left, i.e. the contents of E4 will be =C3. Also, if you apply auto fill to the range C2:C5, starting from C2, the values of C3, C4 and C5 will be =A2, =A3, and =A4, respectively.</p>

<p>In certain cases, the newly created value might relate to a cell that goes beyond the boundaries of the worksheet. For example, if B2 has the value =A1 and we paste its value in cell A2, the new expression will try to find a cell that is one row above and one column to the left of A2. Since such a cell does not exist, the value of A2 is changed to reference error (<strong>#REF!</strong>). This error indicates that the cell reference is not correct.<br>
            Mixed Cell References</p>

<p>A mixed cell reference specifies its row as absolute and its column as relative or vice versa. Upon copy/paste mixed cell references keep their absolute part unchanged and translate only the relative part. For instance, if B1 contains the value =SUM(A$1:A1) and we paste the value in the range B1:B5, each of the newly produced values will hold the sum of all cells in the column A between A1 and the current row. Note that if you move the contents of B1 to a cell in another column, say E2, the new value will translate the columns of both references =SUM(D$1:D2).</p>

<h1 id="see-also"><a href="#see-also">See Also</a></h1>

<ul>
<li><p><a href="/devtools/winforms/spread-processing/working-with-worksheets/spreadprocessing-activate-worksheet">Activate a Worksheet</a></p></li>
<li><p><a href="/devtools/winforms/spread-processing/features/formulas/spreadprocessing-errors">Errors</a></p></li>
</ul>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

