<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Filtering</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Filtering">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-849dcaf701d866988e8c3593f15b66de.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/" title="WinForms Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/winforms.aspx" title="About UI for WinForms" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/winforms.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/winforms/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("spread-processing/features/spreadprocessing-filtering.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/spread-processing/features/spreadprocessing-filtering.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="filtering"><a href="#filtering">Filtering</a></h1>

<p>This article describes what is filtering and filters and how to work with them through the document model. It contains the following sections:</p>

<ul>
<li><p><a href="#what-is-filtering?">What is Filtering?</a></p></li>
<li><p><a href="#autofilter">AutoFilter</a></p></li>
<li><p><a href="#ifilter">IFilter</a></p></li>
<li><p><a href="#valuescollectionfilter">ValuesCollectionFilter</a></p></li>
<li><p><a href="#customfilter">CustomFilter</a></p></li>
<li><p><a href="#topfilter">TopFilter</a></p></li>
<li><p><a href="#dynamicfilter">DynamicFilter</a></p></li>
<li><p><a href="#forecolorfilter">ForeColorFilter</a></p></li>
<li><p><a href="#fillcolorfilter">FillColorFilter</a></p></li>
<li><p><a href="#setting-a-filter">Setting a Filter</a></p></li>
<li><p><a href="#reapplying-a-filter">Reapplying a Filter</a></p></li>
<li><p><a href="#removing-and-clearing-filters">Removing and Clearing Filters</a></p></li>
</ul>

<h2 id="what-is-filtering"><a href="#what-is-filtering">What is Filtering?</a></h2>

<p>The filtering feature allows the user to hide and show certain rows of a range, based on different criteria. It provides an easy way to work with just the relevant set of data.</p>

<p>The information about the filtering applied to a worksheet is contained in the <a href="/devtools/winforms/spread-processing/working-with-worksheets/spreadprocessing-what-is-worksheet">worksheet</a> property <strong>Filter</strong>, which is of type <strong>AutoFilter</strong>. Through it you can set and modify the current range which is filtered and add and remove filters to its columns. Each column can have only one filter applied to it. The interface implemented by all filters is <strong>IFilter</strong>.</p>

<h2 id="autofilter"><a href="#autofilter">AutoFilter</a></h2>

<p>The <strong>AutoFilter</strong> class exposes the following public members:</p>

<ul>
<li><p><strong>FilterRange</strong>: Property of type <strong>CellRange</strong>. Represents the range to which a filter is currently applied. The worksheet can have only one range filtered at a time. If filtering is not applied, the filtered range is <strong>null</strong>.</p></li>
<li><p><strong>void SetFilters(IEnumerable<ifilter> filters)</ifilter></strong>: Sets multiple filters on the filtered range and applies them.</p></li>
<li><p><strong>void SetFilter(IFilter filter)</strong>: Sets a single filter on the filtered range and applies it.</p></li>
<li><p><strong>IFilter GetFilter(int relativeColumnIndex)</strong>: Retrieves the filter applied on the column with the specified index.</p></li>
<li><p><strong>bool RemoveFilter(IFilter filter)</strong>: Removes the specified filter and shows all rows which were hidden by it.</p></li>
<li><p><strong>bool RemoveFilter(int relativeColumnIndex)</strong>: Removes the filter applied on the column with the specified index and shows all rows which were hidden by it.</p></li>
<li><p><strong>void ClearFilters()</strong>: Removes all filters and shows all rows of the filtered range.</p></li>
<li><p><strong>void ReapplyFilter(IFilter filter)</strong>: Reapplies the specified filter.</p></li>
<li><p><strong>void ReapplyFilter(int relativeColumnIndex)</strong>: Reapplies the filter applied to the column with the specified index.</p></li>
</ul>

<blockquote>
<p>The column indices which are used to work with the filters are zero-based and relative to the filtered range.</p>
</blockquote>

<h2 id="ifilter"><a href="#ifilter">IFilter</a></h2>

<p>All the filters which can be applied to the filter range implement the <strong>IFilter</strong> interface. The interface exposes the following members:</p>

<ul>
<li><p><strong>RelativeColumnIndex</strong>: Gets the index of the column to which the filter is applied. The index is relative to the beginning of the filter range.</p></li>
<li><p><strong>object GetValue(Cells cells, int rowIndex, int columnIndex)</strong>: Gets the value of the cell at the specified index. This value is used to determine whether the row should be hidden by the filter.</p></li>
<li><p><strong>bool ShouldShowValue(object value)</strong>: Determines whether the row which contains the specified value should be shown.</p></li>
</ul>

<p>The <strong>GetValue()</strong> method provides the value which the <strong>ShouldShowValue()</strong> method uses to evaluate whether the current row should be hidden or shown.</p>

<p>The diagram in <strong>Figure 1</strong> shows the different types of filters, which inherit the <strong>IFilter</strong> interface, and the classes which implement them:</p>

<p>Figure 1<img src="images/spreadprocessing-filtering001.png" alt="spreadprocessing-filtering 001"></p>

<h2 id="valuescollectionfilter"><a href="#valuescollectionfilter">ValuesCollectionFilter</a></h2>

<p>The values collection filter is a filter which holds a collection of strings and date group items. If the filter encounters a date in the column it filters, it compares it to the date group items in its collection. If there isn't a date group item which matches it, the row is hidden. If the value is not a date the filter compares the formatted string representation of the cell value with the collection of string values. If it is present in the collection, the row is shown, otherwise it is hidden. If the cell is empty, the filter uses the value of the boolean property <strong>Blank</strong> to determine whether the row should be shown or hidden.</p>

<p>Other than the members of the <strong>IFilter</strong> interface, the <strong>ValuesCollectionFilter</strong> class exposes the following members specific to it:</p>

<ul>
<li><p><strong>StringValues</strong>: The collection of strings values.</p></li>
<li><p><strong>DateItems</strong>: The collection of date group items.</p></li>
<li><p><strong>Blank</strong>: The value indicating whether the blank cells will be shown or not.</p></li>
</ul>

<p><strong>Example 1</strong> shows how to create a <strong>ValuesCollectionFilter</strong>.</p>

<h4><strong>[C#] Example 1: Create ValuesCollectionFilter</strong></h4>

<pre><code>            IEnumerable&lt;string&gt; stringItems = new List&lt;string&gt;() { "test", "1%", "1.0" };
            IEnumerable&lt;DateGroupItem&gt; dateItems = new List&lt;DateGroupItem&gt;()
            {
                new DateGroupItem(2013),
                new DateGroupItem(2014, 3)
            };

            ValuesCollectionFilter filter = new ValuesCollectionFilter(0, stringItems, dateItems, true);
</code></pre>

<h4><strong>[VB] Example 1: Create ValuesCollectionFilter</strong></h4>

<pre><code>        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From { New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub

    Public Sub CreateCustomFilter()
        '#Region "radspreadprocessing-features-filtering_1"
        Dim critera1 As New CustomFilterCriteria(ComparisonOperator.EqualsTo, "Test string")
        Dim critera2 As New CustomFilterCriteria(ComparisonOperator.GreaterThan, "-5")
        Dim filter As New CustomFilter(0, critera1, LogicalOperator.[Or], critera2)
        '#End Region
    End Sub

    Public Sub CreateTopFilter()
        '#Region "radspreadprocessing-features-filtering_2"
        Dim filter As New TopFilter(0, TopFilterType.BottomPercent, 30)
        '#End Region
    End Sub

    Public Sub CreateDynamicFilter()
        '#Region "radspreadprocessing-features-filtering_3"
        Dim filter As New DynamicFilter(0, DynamicFilterType.LastWeek)
        '#End Region
    End Sub

    Public Sub CreateForeColorFilter()
        '#Region "radspreadprocessing-features-filtering_4"
        Dim color As New ThemableColor(Colors.Red)
        Dim filter As New ForeColorFilter(0, color)
        '#End Region
    End Sub

    Public Sub CreateFillColorFilter()
        '#Region "radspreadprocessing-features-filtering_5"
        Dim fill As IFill = New PatternFill(PatternType.Solid, Colors.Red, Colors.Red)
        Dim filter As New FillColorFilter(0, fill)
        '#End Region
    End Sub

    Public Sub SetFilter(workbook As Workbook)
        '#Region "radspreadprocessing-features-filtering_6"
        Dim worksheet As Worksheet = workbook.ActiveWorksheet

        Dim filterRange As New CellRange(0, 1, 5, 2)
        worksheet.Filter.FilterRange = filterRange
        '#End Region

        '#Region "radspreadprocessing-features-filtering_7"
        Dim filter As New DynamicFilter(1, DynamicFilterType.AboveAverage)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_8"
        worksheet.Filter.SetFilter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_9"
        worksheet.Cells(filterRange).Filter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_10"
        worksheet.Filter.ReapplyFilter(1)
        '#End Region
    End Sub

    Public Sub RemoveFilter(worksheet As Worksheet)
        '#Region "radspreadprocessing-features-filtering_11"
        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<p>This filter created in <strong>Example 1</strong> will hide all rows which contain dates which are not within the year of 2013 or within March 2014. It will also hide the rows where the formatted string value of the cell does not correspond to any of the strings of the stringItems list. The blank items will be shown.</p>

<h2 id="customfilter"><a href="#customfilter">CustomFilter</a></h2>

<p>The custom filter is a filter which contains one or two critera which are used to filter the column to which the filter is assigned. If the value of the cell doesn't satisfy the criteria, the respective row is hidden by the filter.</p>

<p>Other than the members of the <strong>IFilter</strong> interface, the <strong>CustomFilter</strong> class exposes the following members specific to it:</p>

<ul>
<li><p><strong>Criteria1</strong>: Property of type CustomFilterCriteria specisying the first criteria.</p></li>
<li><p><strong>Criteria2</strong>: Property of type CustomFilterCriteria specisying the second criteria. The second critera can be null.</p></li>
<li><p><strong>LogicalOperator</strong>: The logical operator which determines the logical relationship between the critera. It can have two values:</p></li>
<li><p>And</p></li>
<li><p>Or</p></li>
</ul>

<p>The criteria is represented by the <strong>CustomFilterCriteria</strong> class. Each criteria contains the following:</p>

<ul>
<li><p><strong>FilterValue</strong>: The value to which the cell value is compared.</p></li>
<li><p><strong>ComparisonOperator</strong>: The operator which indicates how the cell value should compare to the FilterValue. The comparison operator can be:</p></li>
<li><p>EqualsTo</p></li>
<li><p>GreaterThan</p></li>
<li><p>GreaterThanOrEqualsTo</p></li>
<li><p>LessThan</p></li>
<li><p>LessThanOrEqualsTo</p></li>
<li><p>NotEqualsTo</p></li>
</ul>

<p><strong>Example 2</strong> shows how to create a custom filter.</p>

<h4><strong>[C#] Example 2: Create CustomFilter</strong></h4>

<pre><code>            CustomFilterCriteria critera1 = new CustomFilterCriteria(ComparisonOperator.EqualsTo, "Test string");
            CustomFilterCriteria critera2 = new CustomFilterCriteria(ComparisonOperator.GreaterThan, "-5");
            CustomFilter filter = new CustomFilter(0, critera1, LogicalOperator.Or, critera2);
</code></pre>

<h4><strong>[VB] Example 2: Create CustomFilter</strong></h4>

<pre><code>        Dim critera1 As New CustomFilterCriteria(ComparisonOperator.EqualsTo, "Test string")
        Dim critera2 As New CustomFilterCriteria(ComparisonOperator.GreaterThan, "-5")
        Dim filter As New CustomFilter(0, critera1, LogicalOperator.[Or], critera2)
        '#End Region
    End Sub

    Public Sub CreateTopFilter()
        '#Region "radspreadprocessing-features-filtering_2"
        Dim filter As New TopFilter(0, TopFilterType.BottomPercent, 30)
        '#End Region
    End Sub

    Public Sub CreateDynamicFilter()
        '#Region "radspreadprocessing-features-filtering_3"
        Dim filter As New DynamicFilter(0, DynamicFilterType.LastWeek)
        '#End Region
    End Sub

    Public Sub CreateForeColorFilter()
        '#Region "radspreadprocessing-features-filtering_4"
        Dim color As New ThemableColor(Colors.Red)
        Dim filter As New ForeColorFilter(0, color)
        '#End Region
    End Sub

    Public Sub CreateFillColorFilter()
        '#Region "radspreadprocessing-features-filtering_5"
        Dim fill As IFill = New PatternFill(PatternType.Solid, Colors.Red, Colors.Red)
        Dim filter As New FillColorFilter(0, fill)
        '#End Region
    End Sub

    Public Sub SetFilter(workbook As Workbook)
        '#Region "radspreadprocessing-features-filtering_6"
        Dim worksheet As Worksheet = workbook.ActiveWorksheet

        Dim filterRange As New CellRange(0, 1, 5, 2)
        worksheet.Filter.FilterRange = filterRange
        '#End Region

        '#Region "radspreadprocessing-features-filtering_7"
        Dim filter As New DynamicFilter(1, DynamicFilterType.AboveAverage)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_8"
        worksheet.Filter.SetFilter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_9"
        worksheet.Cells(filterRange).Filter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_10"
        worksheet.Filter.ReapplyFilter(1)
        '#End Region
    End Sub

    Public Sub RemoveFilter(worksheet As Worksheet)
        '#Region "radspreadprocessing-features-filtering_11"
        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<p>Note that even though the <strong>FilterValue</strong> is of type string, internally the filter will attempt to parse it. This is the opposite behavior to the <strong>ValuesCollectionFilter</strong> which compares only the string representations of the values. In this case, the filter will display all rows which contain a number value greater than -5 or a text value equal to "Test string".</p>

<h2 id="topfilter"><a href="#topfilter">TopFilter</a></h2>

<p>The top filter is a filter which displays a given number or percent of the total values in the column it filters, taking the first top or bottom values. It hides all other rows.</p>

<p>Other than the members of the <strong>IFilter</strong> interface, the <strong>TopFilter</strong> class exposes the following members specific to it:</p>

<ul>
<li><p><strong>TopFilterType</strong>: The value indicating whether the filter should display the top or bottom values and whether the number of values will be indicated as a number of items or as percent of the total number of items. The top filter type can be:</p></li>
<li><p>TopNumber</p></li>
<li><p>BottomNumber</p></li>
<li><p>TopPercent</p></li>
<li><p>BottomPercent</p></li>
<li><p><strong>Value</strong>: The number of items or the percent of the total number of items which will be displayed by the filter.</p></li>
</ul>

<p><strong>Example 3</strong> shows how to create a top filter.</p>

<h4><strong>[C#] Example 3: Create TopFilter</strong></h4>

<pre><code>            TopFilter filter = new TopFilter(0, TopFilterType.BottomPercent, 30);
</code></pre>

<h4><strong>[VB] Example 3: Create TopFilter</strong></h4>

<pre><code>        Dim filter As New TopFilter(0, TopFilterType.BottomPercent, 30)
        '#End Region
    End Sub

    Public Sub CreateDynamicFilter()
        '#Region "radspreadprocessing-features-filtering_3"
        Dim filter As New DynamicFilter(0, DynamicFilterType.LastWeek)
        '#End Region
    End Sub

    Public Sub CreateForeColorFilter()
        '#Region "radspreadprocessing-features-filtering_4"
        Dim color As New ThemableColor(Colors.Red)
        Dim filter As New ForeColorFilter(0, color)
        '#End Region
    End Sub

    Public Sub CreateFillColorFilter()
        '#Region "radspreadprocessing-features-filtering_5"
        Dim fill As IFill = New PatternFill(PatternType.Solid, Colors.Red, Colors.Red)
        Dim filter As New FillColorFilter(0, fill)
        '#End Region
    End Sub

    Public Sub SetFilter(workbook As Workbook)
        '#Region "radspreadprocessing-features-filtering_6"
        Dim worksheet As Worksheet = workbook.ActiveWorksheet

        Dim filterRange As New CellRange(0, 1, 5, 2)
        worksheet.Filter.FilterRange = filterRange
        '#End Region

        '#Region "radspreadprocessing-features-filtering_7"
        Dim filter As New DynamicFilter(1, DynamicFilterType.AboveAverage)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_8"
        worksheet.Filter.SetFilter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_9"
        worksheet.Cells(filterRange).Filter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_10"
        worksheet.Filter.ReapplyFilter(1)
        '#End Region
    End Sub

    Public Sub RemoveFilter(worksheet As Worksheet)
        '#Region "radspreadprocessing-features-filtering_11"
        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<p>The filter will show the top 30 percent of all values in the filtered column. Note that the filter includes only number values both in its estimate how many values to show and which values to show. If the filtered column includes for example a text value, it will be hidden, even if the filter is supposed to show the top 100 percent of values.</p>

<h2 id="dynamicfilter"><a href="#dynamicfilter">DynamicFilter</a></h2>

<p>The dynamic filter is a filter which shows or hides the rows in the column it filters based on a condition chosen from a set of predetermined conditions.</p>

<p>Other than the members of the <strong>IFilter</strong> interface, the <strong>DynamicFilter</strong> class exposes only one property specific to it:</p>

<ul>
<li>
<strong>DynamicFilterType</strong>: The type of the dynamic filter, which determines what condition the filter should use to filter the column it is assigned to. The dynamic filter type can be used from the values of the
          <a href="http://www.telerik.com/help/winforms/t_telerik_windows_documents_spreadsheet_model_filtering_dynamicfiltertype.html">DynamicFilterType</a>
          enumaration.</li>
</ul>

<p><strong>Example 4</strong> demonstrates how to create a dynamic filter.</p>

<h4><strong>[C#] Example 4: Create DynamicFilter</strong></h4>

<pre><code>            DynamicFilter filter = new DynamicFilter(0, DynamicFilterType.LastWeek);
</code></pre>

<h4><strong>[VB] Example 4: Create DynamicFilter</strong></h4>

<pre><code>        Dim filter As New DynamicFilter(0, DynamicFilterType.LastWeek)
        '#End Region
    End Sub

    Public Sub CreateForeColorFilter()
        '#Region "radspreadprocessing-features-filtering_4"
        Dim color As New ThemableColor(Colors.Red)
        Dim filter As New ForeColorFilter(0, color)
        '#End Region
    End Sub

    Public Sub CreateFillColorFilter()
        '#Region "radspreadprocessing-features-filtering_5"
        Dim fill As IFill = New PatternFill(PatternType.Solid, Colors.Red, Colors.Red)
        Dim filter As New FillColorFilter(0, fill)
        '#End Region
    End Sub

    Public Sub SetFilter(workbook As Workbook)
        '#Region "radspreadprocessing-features-filtering_6"
        Dim worksheet As Worksheet = workbook.ActiveWorksheet

        Dim filterRange As New CellRange(0, 1, 5, 2)
        worksheet.Filter.FilterRange = filterRange
        '#End Region

        '#Region "radspreadprocessing-features-filtering_7"
        Dim filter As New DynamicFilter(1, DynamicFilterType.AboveAverage)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_8"
        worksheet.Filter.SetFilter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_9"
        worksheet.Cells(filterRange).Filter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_10"
        worksheet.Filter.ReapplyFilter(1)
        '#End Region
    End Sub

    Public Sub RemoveFilter(worksheet As Worksheet)
        '#Region "radspreadprocessing-features-filtering_11"
        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<p>The filter will show only the values which are dates and which fall within the week prior to the application of the filter.</p>

<h2 id="forecolorfilter"><a href="#forecolorfilter">ForeColorFilter</a></h2>

<p>The fore color filter hides or displays the cells in the column it filters based on the color of the text in it.</p>

<p>Other than the members of the <strong>IFilter</strong> interface, the <strong>ForeColorFilter</strong> class exposes only one property specific to it:</p>

<ul>
<li>
<strong>Color</strong>: A <strong>ThemableColor</strong> object representing the color which should be set on the text of the cell in order for it to be displayed. All other cells of the column are hidden.</li>
</ul>

<p><strong>Example 5</strong> demonstrates how to create a fore color filter.</p>

<h4><strong>[C#] Example 5: Create ForeColorFilter</strong></h4>

<pre><code>            ThemableColor color = new ThemableColor(Colors.Red);
            ForeColorFilter filter = new ForeColorFilter(0, color);
</code></pre>

<h4><strong>[VB] Example 5: Create ForeColorFilter</strong></h4>

<pre><code>        Dim color As New ThemableColor(Colors.Red)
        Dim filter As New ForeColorFilter(0, color)
        '#End Region
    End Sub

    Public Sub CreateFillColorFilter()
        '#Region "radspreadprocessing-features-filtering_5"
        Dim fill As IFill = New PatternFill(PatternType.Solid, Colors.Red, Colors.Red)
        Dim filter As New FillColorFilter(0, fill)
        '#End Region
    End Sub

    Public Sub SetFilter(workbook As Workbook)
        '#Region "radspreadprocessing-features-filtering_6"
        Dim worksheet As Worksheet = workbook.ActiveWorksheet

        Dim filterRange As New CellRange(0, 1, 5, 2)
        worksheet.Filter.FilterRange = filterRange
        '#End Region

        '#Region "radspreadprocessing-features-filtering_7"
        Dim filter As New DynamicFilter(1, DynamicFilterType.AboveAverage)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_8"
        worksheet.Filter.SetFilter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_9"
        worksheet.Cells(filterRange).Filter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_10"
        worksheet.Filter.ReapplyFilter(1)
        '#End Region
    End Sub

    Public Sub RemoveFilter(worksheet As Worksheet)
        '#Region "radspreadprocessing-features-filtering_11"
        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<p>This filter will hide all cells whose text color is not red.</p>

<h2 id="fillcolorfilter"><a href="#fillcolorfilter">FillColorFilter</a></h2>

<p>The fill color filter hides or displays the cells in the column it filters based on their fill.</p>

<p>Other than the members of the <strong>IFilter</strong> interface, the <strong>FillColorFilter</strong> class exposes only one property specific to it:</p>

<ul>
<li>
<strong>Fill</strong>: The fill the cell needs to have in order for it to be displayed. All other cells of the column are hidden.</li>
</ul>

<p><strong>Example 6</strong> shows hot to create a fill color filter.</p>

<h4><strong>[C#] Example 6: Create FillColorFilter</strong></h4>

<pre><code>            IFill fill = new PatternFill(PatternType.Solid, Colors.Red, Colors.Red);
            FillColorFilter filter = new FillColorFilter(0, fill);
</code></pre>

<h4><strong>[VB] Example 6: Create FillColorFilter</strong></h4>

<pre><code>        Dim fill As IFill = New PatternFill(PatternType.Solid, Colors.Red, Colors.Red)
        Dim filter As New FillColorFilter(0, fill)
        '#End Region
    End Sub

    Public Sub SetFilter(workbook As Workbook)
        '#Region "radspreadprocessing-features-filtering_6"
        Dim worksheet As Worksheet = workbook.ActiveWorksheet

        Dim filterRange As New CellRange(0, 1, 5, 2)
        worksheet.Filter.FilterRange = filterRange
        '#End Region

        '#Region "radspreadprocessing-features-filtering_7"
        Dim filter As New DynamicFilter(1, DynamicFilterType.AboveAverage)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_8"
        worksheet.Filter.SetFilter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_9"
        worksheet.Cells(filterRange).Filter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_10"
        worksheet.Filter.ReapplyFilter(1)
        '#End Region
    End Sub

    Public Sub RemoveFilter(worksheet As Worksheet)
        '#Region "radspreadprocessing-features-filtering_11"
        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<p>This filter will hide all cells whose fill is not solid red.</p>

<h2 id="setting-a-filter"><a href="#setting-a-filter">Setting a Filter</a></h2>

<p>In order to set a filter on a range, you need to follow the steps below:</p>

<ol>
<li>Set the filter range.</li>
</ol>

<h4><strong>[C#] Example 7: Set FilterRange</strong></h4>

<pre><code>            Worksheet worksheet = workbook.ActiveWorksheet;

            CellRange filterRange = new CellRange(0, 1, 5, 2);
            worksheet.Filter.FilterRange = filterRange;
</code></pre>

<h4><strong>[VB] Example 7: Set FilterRange</strong></h4>

<pre><code>        Dim worksheet As Worksheet = workbook.ActiveWorksheet

        Dim filterRange As New CellRange(0, 1, 5, 2)
        worksheet.Filter.FilterRange = filterRange
        '#End Region

        '#Region "radspreadprocessing-features-filtering_7"
        Dim filter As New DynamicFilter(1, DynamicFilterType.AboveAverage)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_8"
        worksheet.Filter.SetFilter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_9"
        worksheet.Cells(filterRange).Filter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_10"
        worksheet.Filter.ReapplyFilter(1)
        '#End Region
    End Sub

    Public Sub RemoveFilter(worksheet As Worksheet)
        '#Region "radspreadprocessing-features-filtering_11"
        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<ol>
<li>Create a filter.</li>
</ol>

<h4><strong>[C#] Example 8: Create DynamicFilter</strong></h4>

<pre><code>            DynamicFilter filter = new DynamicFilter(1, DynamicFilterType.AboveAverage);
</code></pre>

<h4><strong>[VB] Example 8: Create DynamicFilter</strong></h4>

<pre><code>        Dim filter As New DynamicFilter(1, DynamicFilterType.AboveAverage)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_8"
        worksheet.Filter.SetFilter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_9"
        worksheet.Cells(filterRange).Filter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_10"
        worksheet.Filter.ReapplyFilter(1)
        '#End Region
    End Sub

    Public Sub RemoveFilter(worksheet As Worksheet)
        '#Region "radspreadprocessing-features-filtering_11"
        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<p>The relative index specified in the constructor is 1, which means that the filter will be set on the second column of the range, that is, column C.</p>

<ol>
<li>Set the filter on the necessary column.</li>
</ol>

<h4><strong>[C#] Example 9: Set Filter</strong></h4>

<pre><code>            worksheet.Filter.SetFilter(filter);
</code></pre>

<h4><strong>[VB] Example 9: Set Filter</strong></h4>

<pre><code>        worksheet.Filter.SetFilter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_9"
        worksheet.Cells(filterRange).Filter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_10"
        worksheet.Filter.ReapplyFilter(1)
        '#End Region
    End Sub

    Public Sub RemoveFilter(worksheet As Worksheet)
        '#Region "radspreadprocessing-features-filtering_11"
        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<p>Alternatively, you can set the filter through the cell selection like in <strong>Example 10</strong>. This approach will automatically set the filter range anew.</p>

<h4><strong>[C#] Example 10: Set Filter through Selection</strong></h4>

<pre><code>            worksheet.Cells[filterRange].Filter(filter);
</code></pre>

<h4><strong>[VB] Example 10: Set Filter through Selection</strong></h4>

<pre><code>        worksheet.Cells(filterRange).Filter(filter)
        '#End Region

        '#Region "radspreadprocessing-features-filtering_10"
        worksheet.Filter.ReapplyFilter(1)
        '#End Region
    End Sub

    Public Sub RemoveFilter(worksheet As Worksheet)
        '#Region "radspreadprocessing-features-filtering_11"
        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<blockquote>
<p>Keep in mind that the first row of the FilterRange is reserved for column headers and will not be included in the actual filtering.</p>
</blockquote>

<blockquote class="tip"><p>Note that the filter cannot be set before the range. Attempting to do so will cause an exception.</p></blockquote>
          

<h2 id="reapplying-a-filter"><a href="#reapplying-a-filter">Reapplying a Filter</a></h2>

<p>When a filter is set it is automatically applied. The application of a filter happens only once and if the values or properties of the filtered column change afterwards, the filter needs to be reapplied. This is done by using the overloads of the <strong>ReapplyFilter()</strong> method. The first overload allows reapplying a filter by the relative index of the column it is applied to. The second - by a <strong>IFilter</strong> instance.</p>

<h4><strong>[C#] Example 11: Set FilterRange</strong></h4>

<pre><code>            worksheet.Filter.ReapplyFilter(1);
</code></pre>

<h4><strong>[VB] Example 11: Set FilterRange</strong></h4>

<pre><code>        worksheet.Filter.ReapplyFilter(1)
        '#End Region
    End Sub

    Public Sub RemoveFilter(worksheet As Worksheet)
        '#Region "radspreadprocessing-features-filtering_11"
        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<blockquote class="tip"><p>Note that attempting to reapply filter on a column which is not filtered causes an exception.</p></blockquote>
          

<h2 id="removing-and-clearing-filters"><a href="#removing-and-clearing-filters">Removing and Clearing Filters</a></h2>

<p>Removing and clearing filters is done using the following methods exposed by the <strong>AutoFilter</strong> class:</p>

<ul>
<li><p><strong>RemoveFilter(IFilter filter)</strong>: Removes the specified filter and shows all rows which were hidden by it. Returns true if successful.</p></li>
<li><p><strong>RemoveFilter(int relativeColumnIndex)</strong>: Removes the filter applied on the column with the specified index and shows all rows which were hidden by it. Returns true if successful.</p></li>
<li><p><strong>ClearFilters()</strong>: Removes all filters and shows all rows of the filtered range.</p></li>
</ul>

<p>As is the case with the <strong>ReapplyFilter()</strong> method, you can remove a filter by instance and by relative index of the column it is applied to.</p>

<h4><strong>[C#] Example 12: Remove Filter</strong></h4>

<pre><code>            bool success = worksheet.Filter.RemoveFilter(1);
</code></pre>

<h4><strong>[VB] Example 12: Remove Filter</strong></h4>

<pre><code>        Dim success As Boolean = worksheet.Filter.RemoveFilter(1)
        '#End Region
    End Sub
End Class
</code></pre>

<p>In order to remove all applied filters at once use the <strong>ClearFilters()</strong> method. <strong>ClearFilters()</strong> will display all rows which were hidden by filtering on the worksheet. However, it will not remove the filtering itself. In order to do this, you need to set the <strong>FilteredRange</strong> property to <strong>null</strong>.</p>

<p>Setting the <strong>FilteredRange</strong> property to null without removing the filters beforehand will automatically remove them.</p>

<h1 id="see-also"><a href="#see-also">See Also</a></h1>

<ul>
<li><p><a href="/devtools/winforms/spread-processing/features/spreadprocessing-sorting">Sorting</a></p></li>
<li><p><a href="/devtools/winforms/spread-processing/working-with-worksheets/spreadprocessing-what-is-worksheet">What is a Worksheet?</a></p></li>
<li><p><a href="/devtools/winforms/spread-processing/features/styling/spreadprocessing-document-themes">Document Themes</a></p></li>
</ul>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

