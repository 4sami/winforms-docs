<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Custom timeline</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Custom timeline">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            


<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">


</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("ganttview-/timeline/ganttview-custom-timeline.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/ganttview-/timeline/ganttview-custom-timeline.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="custom-timeline"><a href="#custom-timeline">Custom timeline</a></h1>

<p><strong>RadGanttView</strong> offers a number of built-in <em>TimeRange</em> settings which allow users to display the timeline in different views.<br>
      Although these settings would cover most cases the users might require a view that is not available out-of-the-box. In this case<br>
      developers can build their own timeline views. This article demonstrates the process for creating a custom timeline view which<br>
      displays items in decades (10-year time spans). The following image demonstrates the final goal:<img src="images/ganttview-timeline-custom-timeline001.png" alt="ganttview-timeline-custom-timeline 001"></p>

<ol>
<li>First you need to set the <em>TimelineRange</em> property of the gantt view graphical element to Custom. If you want you can override and modify the default views as well but
           for this example we will use the Custom value.</li>
</ol>

<h4><strong>[C#]</strong></h4>

<pre><code>            this.radGanttView1.GanttViewElement.GraphicalViewElement.TimelineRange = TimeRange.Custom;
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Me.radGanttView1.GanttViewElement.GraphicalViewElement.TimelineRange = TimeRange.Custom
</code></pre>

<ol>
<li>Next you need to create a custom timeline behavior class and assign it to the graphical view. In this class you will add the logic for the new decades view.</li>
</ol>

<h4><strong>[C#]</strong></h4>

<pre><code>            this.radGanttView1.GanttViewElement.GraphicalViewElement.TimelineBehavior = new DecadesGanttViewTimelineBehavior();
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Me.radGanttView1.GanttViewElement.GraphicalViewElement.TimelineBehavior = New DecadesGanttViewTimelineBehavior()
</code></pre>

<ol>
<li><p>Now you can fill the class with the code that will create the view. You should note that because we want to preserve the built-in views throughout<br>
    the example we will check whether the time range is Custom and only handle this case.</p></li>
</ol>

<ul>
<li>First you have to override the <em>AdjustedTimelineStart</em> and <em>AdjustedTimelineEnd</em> properties. What these properties do is
            to enlarge the timeline start and end to allow only whole timeline cells to be displayed. Here is an example. Imagine you use a view with quarters and your <em>TimelineStart</em> property is
            set to 15.05.2013. This date is somewhere in the middle of the yearâ€™s second quarter. The <em>AdjustedTimelineStart</em> property takes this date and the fact you use quarters and returns
            an adjusted date which is the actual start of the quarter. In this particular case the property will return 03.04.2013 which is the start date of the quarter that contains the <em>TimelineStart</em> date.
            The <em>AdjustedTimelineEnd</em> property does the same for the end of the timeline. For the decades view this properties will adjust the start and end dates to years:</li>
</ul>

<h4><strong>[C#]</strong></h4>

<pre><code>        public override DateTime AdjustedTimelineStart
        {
            get
            {
                if (this.GraphicalViewElement.TimelineRange != TimeRange.Custom)
                {
                    return base.AdjustedTimelineStart;
                }

                return new DateTime(this.GraphicalViewElement.TimelineStart.Year, 1, 1);
            }
        }

        public override DateTime AdjustedTimelineEnd
        {
            get
            {
                if (this.GraphicalViewElement.TimelineRange != TimeRange.Custom)
                {
                    return base.AdjustedTimelineEnd;
                }

                return new DateTime(this.GraphicalViewElement.TimelineEnd.Year + 1, 1, 1);
            }
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Public Overrides ReadOnly Property AdjustedTimelineStart() As DateTime
        Get
            If Me.GraphicalViewElement.TimelineRange &lt;&gt; TimeRange.[Custom] Then
                Return MyBase.AdjustedTimelineStart
            End If
            Return New DateTime(Me.GraphicalViewElement.TimelineStart.Year, 1, 1)
        End Get
    End Property

    Public Overrides ReadOnly Property AdjustedTimelineEnd As DateTime
        Get
            If Me.GraphicalViewElement.TimelineRange &lt;&gt; TimeRange.[Custom] Then
                Return MyBase.AdjustedTimelineEnd
            End If
            Return New DateTime(Me.GraphicalViewElement.TimelineEnd.Year + 1, 1, 1)
        End Get
    End Property
</code></pre>

<ul>
<li>Next you should override the <em>BuildTimelineDataItems</em> method. The method returns a list of <strong>GanttViewTimelineDataItems</strong>. Each data item will represent a decade.</li>
</ul>

<h4><strong>[C#]</strong></h4>

<pre><code>        public override IList&lt;GanttViewTimelineDataItem&gt; BuildTimelineDataItems(TimeRange range)
        {
            if (range != TimeRange.Custom)
            {
                return base.BuildTimelineDataItems(range);
            }

            return this.BuildTimelineDataItemsForDecadesRange();
        }

        public IList&lt;GanttViewTimelineDataItem&gt; BuildTimelineDataItemsForDecadesRange()
        {
            List&lt;GanttViewTimelineDataItem&gt; result = new List&lt;GanttViewTimelineDataItem&gt;();

            DateTime adjustedStart = this.AdjustedTimelineStart;
            DateTime adjustedEnd = this.AdjustedTimelineEnd;

            DateTime currentDate = adjustedStart.Date;
            int currentYearNumber = currentDate.Year;
            int newYearNumber = currentYearNumber;
            GanttViewTimelineDataItem item = new GanttViewTimelineDataItem(currentDate.Date, currentDate.AddYears(1), this.GraphicalViewElement.TimelineRange, this.GraphicalViewElement.OnePixelTime);
            result.Add(item);

            while (currentDate &lt; adjustedEnd)
            {
                item.End = currentDate.AddYears(1);

                currentDate = currentDate.AddYears(1);
                newYearNumber = currentDate.Year;

                if (newYearNumber != currentYearNumber &amp;&amp; newYearNumber % 10 == 0 &amp;&amp; currentDate &lt;= adjustedEnd)
                {
                    currentYearNumber = newYearNumber;
                    item = new GanttViewTimelineDataItem(currentDate, currentDate, this.GraphicalViewElement.TimelineRange, this.GraphicalViewElement.OnePixelTime);
                    result.Add(item);
                }
            }

            return result;
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>        Public Overrides Function BuildTimelineDataItems(range As TimeRange) As IList(Of GanttViewTimelineDataItem)
        If range &lt;&gt; TimeRange.[Custom] Then
            Return MyBase.BuildTimelineDataItems(range)
        End If
        Return Me.BuildTimelineDataItemsForDecadesRange()
    End Function

    Public Function BuildTimelineDataItemsForDecadesRange() As IList(Of GanttViewTimelineDataItem)
        Dim result As New List(Of GanttViewTimelineDataItem)()
        Dim adjustedStart As DateTime = Me.AdjustedTimelineStart
        Dim adjustedEnd As DateTime = Me.AdjustedTimelineEnd
        Dim currentDate As DateTime = adjustedStart.[Date]
        Dim currentYearNumber As Integer = currentDate.Year
        Dim newYearNumber As Integer = currentYearNumber
        Dim item As New GanttViewTimelineDataItem(currentDate.[Date], currentDate.AddYears(1), Me.GraphicalViewElement.TimelineRange, Me.GraphicalViewElement.OnePixelTime)
        result.Add(item)
        While currentDate &lt; adjustedEnd
            item.[End] = currentDate.AddYears(1)
            currentDate = currentDate.AddYears(1)
            newYearNumber = currentDate.Year
            If newYearNumber &lt;&gt; currentYearNumber AndAlso newYearNumber Mod 10 = 0 AndAlso currentDate &lt;= adjustedEnd Then
                currentYearNumber = newYearNumber
                item = New GanttViewTimelineDataItem(currentDate, currentDate, Me.GraphicalViewElement.TimelineRange, Me.GraphicalViewElement.OnePixelTime)
                result.Add(item)
            End If
        End While
        Return result
    End Function
</code></pre>

<ul>
<li>Next we have to calculate the timeline cells for each timeline data item. To this we override the <em>GetTimelineCellInfoForItem</em> method. The method returns an instance of the 
             <strong>GanttTimelineCellsInfo</strong> struct. This struct contains two properties. The first one, <em>NumberOfcells</em>, indicates how many cells the given timeline data item will display.
             The second one, <em>StartIndex</em>, is useful in the case where you use repeatable cell items e.g. quarters, halves, thirds etc. The property is useful when the start of the timeline is not the first
             item in the repeatable values collection. Here is an example. Imagine the timeline starts is the third quarter of the year with this property you will later be able to set the proper text to the cell item. If you do not
             have this info your cells will always start at 0 or 1. Since in this example the start is the third quarter starting at 0 or 1 would be wrong. In our example we have continuous data so we will not use this property:</li>
</ul>

<h4><strong>[C#]</strong></h4>

<pre><code>        public override GanttTimelineCellsInfo GetTimelineCellInfoForItem(GanttViewTimelineDataItem item, TimeRange timeRange)
        {
            if (timeRange != TimeRange.Custom)
            {
                return base.GetTimelineCellInfoForItem(item, timeRange);
            }

            return this.GetTimelineCellInfoForDecadeRange(item);
        }

        public GanttTimelineCellsInfo GetTimelineCellInfoForDecadeRange(GanttViewTimelineDataItem item)
        {
            int years = 10;

            if (item.Start == this.AdjustedTimelineStart)
            {
                if (item.Start.Year % 10 &gt; 0)
                {
                    years = 10 - (item.Start.Year % 10);
                }
            }

            if (item.End == this.AdjustedTimelineEnd)
            {
                if (item.End.Year % 10 &gt; 0)
                {
                    years = item.End.Year % 10;
                }
            }

            return new GanttTimelineCellsInfo(years);
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Public Overrides Function GetTimelineCellInfoForItem(item As GanttViewTimelineDataItem, range As TimeRange) As GanttTimelineCellsInfo
        If range &lt;&gt; TimeRange.[Custom] Then
            Return MyBase.GetTimelineCellInfoForItem(item, range)
        End If
        Return Me.GetTimelineCellInfoForDecadeRange(item)
    End Function

    Public Function GetTimelineCellInfoForDecadeRange(item As GanttViewTimelineDataItem) As GanttTimelineCellsInfo
        Dim years As Integer = 10
        If item.Start = Me.AdjustedTimelineStart Then
            If item.Start.Year Mod 10 &gt; 0 Then
                years = 10 - (item.Start.Year Mod 10)
            End If
        End If
        If item.[End] = Me.AdjustedTimelineEnd Then
            If item.[End].Year Mod 10 &gt; 0 Then
                years = item.[End].Year Mod 10
            End If
        End If
        Return New GanttTimelineCellsInfo(years)
    End Function
</code></pre>

<ul>
<li>Finally we want to have a proper text inside our decade timeline items. For this purpose we override the <em>GetTimelineTopElementText</em> and <em>GetTimelineBottomElementText</em> methods.</li>
</ul>

<h4><strong>[C#]</strong></h4>

<pre><code>        public override string GetTimelineTopElementText(GanttViewTimelineDataItem item)
        {
            if (item.Range != TimeRange.Custom)
            {
                return base.GetTimelineTopElementText(item);
            }

            string format = "{0:yyyy} - {1:yyyy}";
            return string.Format(System.Threading.Thread.CurrentThread.CurrentUICulture, format, item.Start, item.End.AddYears(-1));
        }

        public override string GetTimelineBottomElementText(GanttViewTimelineDataItem item, int index)
        {
            if (item.Range != TimeRange.Custom)
            {
                return base.GetTimelineBottomElementText(item, index);
            }

            string format = "{0:yyyy}";
            return string.Format(System.Threading.Thread.CurrentThread.CurrentCulture, format, new DateTime(item.Start.Year + index, 1, 1));
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>      Public Overrides Function GetTimelineTopElementText(item As GanttViewTimelineDataItem) As String
        If item.Range &lt;&gt; TimeRange.[Custom] Then
            Return MyBase.GetTimelineTopElementText(item)
        End If
        Dim format As String = "{0:yyyy} - {1:yyyy}"
        Return String.Format(System.Threading.Thread.CurrentThread.CurrentUICulture, format, item.Start, item.[End].AddYears(-1))
    End Function

    Public Overrides Function GetTimelineBottomElementText(item As GanttViewTimelineDataItem, index As Integer) As String
        If item.Range &lt;&gt; TimeRange.[Custom] Then
            Return MyBase.GetTimelineBottomElementText(item, index)
        End If
        Dim format As String = "{0:yyyy}"
        Return String.Format(System.Threading.Thread.CurrentThread.CurrentCulture, format, New DateTime(item.Start.Year + index, 1, 1))
    End Function
</code></pre>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

