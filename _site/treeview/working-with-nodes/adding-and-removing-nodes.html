<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Adding and Removing Nodes</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Adding and Removing Nodes">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("treeview/working-with-nodes/adding-and-removing-nodes.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/treeview/working-with-nodes/adding-and-removing-nodes.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="adding-and-removing-nodes"><a href="#adding-and-removing-nodes">Adding and Removing Nodes</a></h1>

<h2 id="adding-nodes"><a href="#adding-nodes">Adding Nodes</a></h2>

<p>RadTreeView nodes are arranged in a hierarchical structure. To add a node to the first level in a<br>
          <strong>RadTreeView</strong> use the <strong>Nodes.Add()</strong> method. To add a<br>
          child node to another node use the parent nodes <strong>Nodes.Add()</strong> method.<br>
          <strong>Nodes.Add()__places the node at the end of the __Nodes</strong> collection. <br>
          You may also use <strong>Nodes.Insert()</strong> to place the node anywhere in the <strong>Nodes</strong><br>
          collection.</p>

<p>The following example demonstrates how to add nodes using code:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        private void AddNodes()
        {
            RadTreeNode Node1 = new RadTreeNode("Node1");
            Node1.Tag = 1234;
            Node1.BackColor = Color.Blue;
            RadTreeNode Node2 = new RadTreeNode("Node2");
            RadTreeNode Node3 = new RadTreeNode("Node3");
            RadTreeNode Node4 = new RadTreeNode("Node4");
            radTreeView1.Nodes.Add(Node1);
            radTreeView1.Nodes.Add(Node2);
            Node1.Nodes.Add(Node3);
            Node2.Nodes.Add(Node4);
            //Alternative methods for adding nodes
            //RadTreeNode Node1 = radTreeView1.Nodes.Add("Node1");
            //RadTreeNode Node2 = radTreeView1.Nodes.Add("Node2");
            //Node1.Nodes.Add("Node3");
            //Node2.Nodes.Add("Node4");
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub AddNodes()
        Dim Node1 As New RadTreeNode("Node1")
        Node1.Tag = 1234
        Node1.BackColor = Color.Blue
        Dim Node2 As New RadTreeNode("Node2")
        Dim Node3 As New RadTreeNode("Node3")
        Dim Node4 As New RadTreeNode("Node4")
        RadTreeView1.Nodes.Add(Node1)
        RadTreeView1.Nodes.Add(Node2)
        Node1.Nodes.Add(Node3)
        Node2.Nodes.Add(Node4)
        'Alternative methods for adding nodes
        'RadTreeNode Node1 = radTreeView1.Nodes.Add("Node1");
        'RadTreeNode Node2 = radTreeView1.Nodes.Add("Node2");
        'Node1.Nodes.Add("Node3");
        'Node2.Nodes.Add("Node4");
    End Sub
    '#End Region

    '#Region removeNodes
    Private Sub RemoveNodes()
        'Remove a single node
        RadTreeView1.Nodes(0).Remove()
        ' removes all nodes from TreeView
        RadTreeView1.Nodes.Clear()
    End Sub
    '#End Region
End Class
</code></pre>

<p>Just before a node is added, the  <strong>NodeAdding</strong> event is fired. The event arguments of this event allow<br>
          you to cancel the adding of the node. If the operation was not canceled, then the node will be added to the RadTreeView and<br>
          the  <strong>NodeAdded</strong> event will be fired. The following code snippet demonstrates the usage of these events:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        void radTreeView1_NodeAdding(object sender, RadTreeViewCancelEventArgs e)
        {
            if (e.Node.Text.Contains("Non-insertable"))
            {
                e.Cancel = true;
            }
        }

        void radTreeView1_NodeAdded(object sender, RadTreeViewEventArgs e)
        {
            RadMessageBox.Show("Node {" + e.Node.Text + "} was added");
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub RadTreeView1_NodeAdding(sender As Object, e As RadTreeViewCancelEventArgs) Handles RadTreeView1.NodeAdding
        If e.Node.Text.Contains("Non-insertable") Then
            e.Cancel = True
        End If
    End Sub

    Private Sub RadTreeView1_NodeAdded(sender As Object, e As RadTreeViewEventArgs) Handles RadTreeView1.NodeAdded
        RadMessageBox.Show("Node {" + e.Node.Text + "} was added")
    End Sub

#End Region

#Region "NodeRemoving"

    Private Sub RadTreeView1_NodeRemoving(sender As Object, e As RadTreeViewCancelEventArgs) Handles RadTreeView1.NodeRemoving
        If e.Node.Text.Contains("Unremovable") Then
            e.Cancel = True
        End If
    End Sub

    Private Sub RadTreeView1_NodeRemoved(sender As Object, e As RadTreeViewEventArgs) Handles RadTreeView1.NodeRemoved
        RadMessageBox.Show("Node {" + e.Node.Text + "} was removed")
    End Sub

#End Region

    Private Sub InsertingNodes()
        '#Region insertingNodes
        ' Create two parent nodes
        Dim parentNode1 As New RadTreeNode("First Parent")
        Dim parentNode2 As New RadTreeNode("Second Parent")
        ' Add the parent nodes to tree view's nodes collection
        Me.RadTreeView1.Nodes.Add(parentNode1)
        Me.RadTreeView1.Nodes.Add(parentNode2)
        ' Create child nodes
        Dim childNode As New RadTreeNode("Child Node")
        Dim childNode2 As New RadTreeNode("Child Node2")
        Dim childNode3 As New RadTreeNode("Child Node3")
        Dim childNode4 As New RadTreeNode("Child Node4")
        Dim childNode5 As New RadTreeNode("Child Node5")
        ' Add a single child node to the parentNode1 nodes collection and
        ' multiple nodes to the parentNode2 nodes collection
        parentNode1.Nodes.Add(childNode)
        parentNode2.Nodes.Add(childNode2)
        parentNode2.Nodes.Add(childNode3)
        parentNode2.Nodes.Add(childNode4)
        parentNode2.Nodes.Add(childNode5)
        ' Insert the childNode instance to the parentNode2 nodes collection
        parentNode2.Nodes.Insert(1, childNode)
        '#End Region
    End Sub

    Private Sub OptionList()
        '#Region optionList
        Dim Node1 As New RadTreeNode("Node1")
        Node1.Expanded = True
        Node1.CheckType = ChildListType.OptionList
        Dim Node2 As New RadTreeNode("Node2")
        Dim Node3 As New RadTreeNode("Node3")
        Dim Node4 As New RadTreeNode("Node4")
        RadTreeView1.Nodes.Add(Node1)
        RadTreeView1.Nodes.Add(Node2)
        Node1.Nodes.Add(Node3)
        Node1.Nodes.Add(Node4)
        '#End Region
    End Sub

    '#Region doubleClick
    Private Sub radTreeView1_DoubleClick(ByVal sender As Object, ByVal e As EventArgs)
        Dim args As MouseEventArgs = TryCast(e, MouseEventArgs)
        Dim clickedNode As RadTreeNode = RadTreeView1.GetNodeAt(args.X, args.Y)
        If clickedNode IsNot Nothing Then
            MessageBox.Show("Node Text: " &amp; clickedNode.Text &amp; "  Node Value: " &amp; clickedNode.Tag)
        End If
    End Sub
    '#End Region

    '#Region addNodes
    Private Sub AddNodes()
        Dim Node1 As New RadTreeNode("Node1")
        Node1.Tag = 1234
        Node1.BackColor = Color.Blue
        Dim Node2 As New RadTreeNode("Node2")
        Dim Node3 As New RadTreeNode("Node3")
        Dim Node4 As New RadTreeNode("Node4")
        RadTreeView1.Nodes.Add(Node1)
        RadTreeView1.Nodes.Add(Node2)
        Node1.Nodes.Add(Node3)
        Node2.Nodes.Add(Node4)
        'Alternative methods for adding nodes
        'RadTreeNode Node1 = radTreeView1.Nodes.Add("Node1");
        'RadTreeNode Node2 = radTreeView1.Nodes.Add("Node2");
        'Node1.Nodes.Add("Node3");
        'Node2.Nodes.Add("Node4");
    End Sub
    '#End Region

    '#Region removeNodes
    Private Sub RemoveNodes()
        'Remove a single node
        RadTreeView1.Nodes(0).Remove()
        ' removes all nodes from TreeView
        RadTreeView1.Nodes.Clear()
    End Sub
    '#End Region
End Class
</code></pre>

<h2 id="removing-nodes"><a href="#removing-nodes">Removing Nodes</a></h2>

<p>To remove a single node use the <strong>Remove()</strong> method of the node. To remove *all *nodes of the RadTreeView use the <strong>Nodes.Clear()</strong> method__.__</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        private void RemoveNodes()
        {
            //Remove a single node
            radTreeView1.Nodes[0].Remove();
            // removes all nodes from TreeView
            radTreeView1.Nodes.Clear();
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub RemoveNodes()
        'Remove a single node
        RadTreeView1.Nodes(0).Remove()
        ' removes all nodes from TreeView
        RadTreeView1.Nodes.Clear()
    End Sub
    '#End Region
End Class
</code></pre>

<p>Just before a node is removed, the <strong>NodeRemoving</strong> event is fired. The event arguments of this event allow you to<br>
          cancel the remove operation. If the operation was not canceled, then the node will be removed from RadTreeView and the <strong>NodeRemoved</strong><br>
          event will be fired. The following code snippet demonstrates the usage of these events:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        void radTreeView1_NodeRemoving(object sender, RadTreeViewCancelEventArgs e)
        {
            if (e.Node.Text.Contains("Unremovable"))
            {
                e.Cancel = true;
            }
        }

        void radTreeView1_NodeRemoved(object sender, RadTreeViewEventArgs e)
        {
            RadMessageBox.Show("Node {" + e.Node.Text + "} was removed");
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub RadTreeView1_NodeRemoving(sender As Object, e As RadTreeViewCancelEventArgs) Handles RadTreeView1.NodeRemoving
        If e.Node.Text.Contains("Unremovable") Then
            e.Cancel = True
        End If
    End Sub

    Private Sub RadTreeView1_NodeRemoved(sender As Object, e As RadTreeViewEventArgs) Handles RadTreeView1.NodeRemoved
        RadMessageBox.Show("Node {" + e.Node.Text + "} was removed")
    End Sub

#End Region

    Private Sub InsertingNodes()
        '#Region insertingNodes
        ' Create two parent nodes
        Dim parentNode1 As New RadTreeNode("First Parent")
        Dim parentNode2 As New RadTreeNode("Second Parent")
        ' Add the parent nodes to tree view's nodes collection
        Me.RadTreeView1.Nodes.Add(parentNode1)
        Me.RadTreeView1.Nodes.Add(parentNode2)
        ' Create child nodes
        Dim childNode As New RadTreeNode("Child Node")
        Dim childNode2 As New RadTreeNode("Child Node2")
        Dim childNode3 As New RadTreeNode("Child Node3")
        Dim childNode4 As New RadTreeNode("Child Node4")
        Dim childNode5 As New RadTreeNode("Child Node5")
        ' Add a single child node to the parentNode1 nodes collection and
        ' multiple nodes to the parentNode2 nodes collection
        parentNode1.Nodes.Add(childNode)
        parentNode2.Nodes.Add(childNode2)
        parentNode2.Nodes.Add(childNode3)
        parentNode2.Nodes.Add(childNode4)
        parentNode2.Nodes.Add(childNode5)
        ' Insert the childNode instance to the parentNode2 nodes collection
        parentNode2.Nodes.Insert(1, childNode)
        '#End Region
    End Sub

    Private Sub OptionList()
        '#Region optionList
        Dim Node1 As New RadTreeNode("Node1")
        Node1.Expanded = True
        Node1.CheckType = ChildListType.OptionList
        Dim Node2 As New RadTreeNode("Node2")
        Dim Node3 As New RadTreeNode("Node3")
        Dim Node4 As New RadTreeNode("Node4")
        RadTreeView1.Nodes.Add(Node1)
        RadTreeView1.Nodes.Add(Node2)
        Node1.Nodes.Add(Node3)
        Node1.Nodes.Add(Node4)
        '#End Region
    End Sub

    '#Region doubleClick
    Private Sub radTreeView1_DoubleClick(ByVal sender As Object, ByVal e As EventArgs)
        Dim args As MouseEventArgs = TryCast(e, MouseEventArgs)
        Dim clickedNode As RadTreeNode = RadTreeView1.GetNodeAt(args.X, args.Y)
        If clickedNode IsNot Nothing Then
            MessageBox.Show("Node Text: " &amp; clickedNode.Text &amp; "  Node Value: " &amp; clickedNode.Tag)
        End If
    End Sub
    '#End Region

    '#Region addNodes
    Private Sub AddNodes()
        Dim Node1 As New RadTreeNode("Node1")
        Node1.Tag = 1234
        Node1.BackColor = Color.Blue
        Dim Node2 As New RadTreeNode("Node2")
        Dim Node3 As New RadTreeNode("Node3")
        Dim Node4 As New RadTreeNode("Node4")
        RadTreeView1.Nodes.Add(Node1)
        RadTreeView1.Nodes.Add(Node2)
        Node1.Nodes.Add(Node3)
        Node2.Nodes.Add(Node4)
        'Alternative methods for adding nodes
        'RadTreeNode Node1 = radTreeView1.Nodes.Add("Node1");
        'RadTreeNode Node2 = radTreeView1.Nodes.Add("Node2");
        'Node1.Nodes.Add("Node3");
        'Node2.Nodes.Add("Node4");
    End Sub
    '#End Region

    '#Region removeNodes
    Private Sub RemoveNodes()
        'Remove a single node
        RadTreeView1.Nodes(0).Remove()
        ' removes all nodes from TreeView
        RadTreeView1.Nodes.Clear()
    End Sub
    '#End Region
End Class
</code></pre>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

