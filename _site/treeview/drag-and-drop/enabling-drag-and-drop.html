<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Enabling Drag and Drop</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Enabling Drag and Drop">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            


<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">


</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("treeview/drag-and-drop/enabling-drag-and-drop.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/treeview/drag-and-drop/enabling-drag-and-drop.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="enabling-drag-and-drop"><a href="#enabling-drag-and-drop">Enabling Drag and Drop</a></h1>

<p>The key RadTreeView boolean properties enable Drag and Drop functionality: <strong>AllowDragDrop</strong>,<br>
        and <strong>AllowDrop</strong>.</p>

<ul>
<li><p><strong>AllowDragDrop</strong> enables the drag and drop functionality for a tree view control. Drag and drop functionality can also be used to reorder nodes.</p></li>
<li><p>__AllowDrop__when true accepts data that the user drags onto it. This event is used to interact with drag and drop for standard Windows controls.</p></li>
</ul>

<blockquote>
<p>Multiple nodes can be dragged if the RadTreeView <strong>AllowMultiSelect</strong> property is true.</p>
</blockquote>

<h2 id="allowdragdrop"><a href="#allowdragdrop">AllowDragDrop</a></h2>

<p><strong>AllowDragDrop</strong> when true enables fully automatic drag and drop. The selected node and child nodes are all moved to the target location with user interaction only.  No code is required. The following screenshots show drag and drop behaviors. Notice the visual cues that assist the user in navigating the tree.</p>

<table>
<tr>
<td>

<b>Description</b>
</td>
<td>

<b>User Action</b>
</td>
</tr>
<tr>
<td>

"Node"2" is dropped on "Node8". The result is that "Node2" is added as a child node of "Node8".</td>
<td>![treeview-drag-and-drop-enabling-drag-and-drop 001](images/treeview-drag-and-drop-enabling-drag-and-drop001.gif)</td>
</tr>
<tr>
<td>

For the other cases the dashed line described there the dragged node will be inserted. In this case "Node9" is going to me placed between
                nodes "Node5.2" and "Node5.3". The result is that "Node9" will be added as a sibling of "Node5.2" and located just above "Node5.3". 
              </td>
<td>![treeview-drag-and-drop-enabling-drag-and-drop 002](images/treeview-drag-and-drop-enabling-drag-and-drop002.gif)</td>
</tr>
</table>

<h2 id="allowdrop"><a href="#allowdrop">AllowDrop </a></h2>

<p><strong>AllowDrop</strong> when true enables RadTreeView to accept data dropped onto it. This event can be used to allow interaction between standard Windows controls<br>
          and RadTreeView. In the example below a RadTextBox control is dragged to a RadTreeNode.<br>
        <img src="images/treeview-drag-and-drop-enabling-drag-and-drop005.png" alt="treeview-drag-and-drop-enabling-drag-and-drop 005"></p>

<p>To implement this functionality:</p>

<ul>
<li><p>Set __AllowDrop__for both RadTreeView and the RadTextBox control to true.</p></li>
<li><p>Code the MouseDown event handler of the RadTextBox HostedControl to call the control's <strong>DoDragDrop()</strong> method.</p></li>
<li><p>Code the RadTreeView DragEnter event handler to set the arguments <strong>Effects</strong> property.</p></li>
<li><p>Code the RadTreeView DragDrop event handler to react to the drop operation. In the code sample below the RadTreeView <strong>PointToClient()</strong> and <strong>GetNodeAt()</strong> methods are used to retrieve the dropped node.</p></li>
</ul>

<h4><strong>[C#]</strong></h4>

<pre><code>        public EnablingDragAndDrop()
        {
            InitializeComponent();

            radTextBox1.TextBoxElement.TextBoxItem.HostedControl.MouseDown +=new MouseEventHandler(textBox1_MouseDown);
            radTreeView1.DragEnter+=new DragEventHandler(radTreeView_DragEnter);
            radTreeView1.DragDrop+=new DragEventHandler(radTreeView_DragDrop);

            radTreeView1.AllowDrop = true;
            this.radTextBox1.AllowDrop = true;
        }

        private void textBox1_MouseDown(object sender, MouseEventArgs e)
        {
            this.radTextBox1.DoDragDrop(this.radTextBox1.Text, DragDropEffects.Copy | DragDropEffects.Move);
        }

        private void radTreeView_DragEnter(object sender, DragEventArgs e)
        {
            if (e.Data.GetDataPresent(DataFormats.Text))
            {
                e.Effect = DragDropEffects.Copy;
            }
            else
            {
                e.Effect = DragDropEffects.None;
            }
        }

        private void radTreeView_DragDrop(object sender, DragEventArgs e)
        {
            Point p = radTreeView1.PointToClient(new Point(e.X, e.Y));
            RadTreeNode hoverNode = radTreeView1.GetNodeAt(p.X, p.Y);
            if (hoverNode == null)
            {
                radTreeView1.Nodes.Add(e.Data.GetData(DataFormats.Text).ToString());
                return;
            }
            hoverNode.Nodes.Add(e.Data.GetData(DataFormats.Text).ToString());
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Public Sub New()
        InitializeComponent()

        AddHandler RadTextBox1.TextBoxElement.TextBoxItem.HostedControl.MouseDown, AddressOf textBox1_MouseDown
        AddHandler RadTreeView1.DragEnter, AddressOf radTreeView_DragEnter
        AddHandler RadTreeView1.DragDrop, AddressOf radTreeView_DragDrop

        RadTreeView1.AllowDrop = True
        Me.RadTextBox1.AllowDrop = True
    End Sub

    Private Sub textBox1_MouseDown(ByVal sender As Object, ByVal e As MouseEventArgs)
        Me.RadTextBox1.DoDragDrop(Me.RadTextBox1.Text, DragDropEffects.Copy Or DragDropEffects.Move)
    End Sub

    Private Sub radTreeView_DragEnter(ByVal sender As Object, ByVal e As DragEventArgs)
        If e.Data.GetDataPresent(DataFormats.Text) Then
            e.Effect = DragDropEffects.Copy
        Else
            e.Effect = DragDropEffects.None
        End If
    End Sub

    Private Sub radTreeView_DragDrop(ByVal sender As Object, ByVal e As DragEventArgs)
        Dim p As Point = RadTreeView1.PointToClient(New Point(e.X, e.Y))
        Dim hoverNode As RadTreeNode = RadTreeView1.GetNodeAt(p.X, p.Y)
        If hoverNode Is Nothing Then
            RadTreeView1.Nodes.Add(e.Data.GetData(DataFormats.Text).ToString())
            Return
        End If
        hoverNode.Nodes.Add(e.Data.GetData(DataFormats.Text).ToString())
    End Sub
    '#End Region

    Protected Overrides Sub OnShown(e As System.EventArgs)
        MyBase.OnShown(e)
        AddNodes(RadTreeView1)
    End Sub

    Private Sub AddNodes(tree As RadTreeView)
        Dim pf As New RadTreeNode("Program Files")

        Dim telerikF As New RadTreeNode("Telerik")
        telerikF.Nodes.Add(New RadTreeNode("Examples.exe"))
        pf.Nodes.Add(telerikF)

        Dim ieF As New RadTreeNode("Internet Explorer")
        ieF.Nodes.Add(New RadTreeNode("iexplore.exe"))
        pf.Nodes.Add(ieF)

        Dim msSqlF As New RadTreeNode("Microsoft SQL")
        msSqlF.Nodes.Add(New RadTreeNode("SampleDB.mdf"))
        pf.Nodes.Add(msSqlF)

        Dim msOF As New RadTreeNode("Microsoft Office")
        msOF.Nodes.Add(New RadTreeNode("word.exe"))
        pf.Nodes.Add(msOF)

        Dim file As New RadTreeNode("Thumbs.db")
        pf.Nodes.Add(file)

        tree.Nodes.Add(pf)

        Dim wf As New RadTreeNode("Windows")

        Dim asF As New RadTreeNode("Assembly")
        wf.Nodes.Add(asF)

        Dim uiFile As New RadTreeNode("Telerik.WinControls.UI.dll")
        asF.Nodes.Add(uiFile)

        Dim thFile As New RadTreeNode("TelerikCommon.dll")
        asF.Nodes.Add(thFile)

        Dim logsF As New RadTreeNode("Logs")
        wf.Nodes.Add(logsF)

        Dim logFile As New RadTreeNode("log.log")
        logsF.Nodes.Add(logFile)

        tree.Nodes.Add(wf)
    End Sub

    ''#Region "dragEnding" 
    'THIS FUNCTIONALITY (TO HAVE THE ARROW DIRECTION AND TO BE ABLE TO RESTRICT DROPPING A NODE AT CERTAIN PLACES)
    ''SHOULD BE ADDED TO HELP, ONCE IT IS IMPLEMENTED
    'Private Sub radTreeView1_DragEnding(ByVal sender As Object, ByVal e As RadTreeViewDragCancelEventArgs)
    '    'NICK
    '    'If e.Direction = Telerik.WinControls.ArrowDirection.Down Then
    '    '    e.Cancel = True
    '    'End If
    '    'If e.Node.Text = "In Box" Then
    '    '    e.Cancel = True
    '    'End If
    'End Sub
    ''#End Region

    ''#Region "expansion"
    'Private _dragging As Boolean

    'Private Sub radTreeView1_DragStarted(ByVal sender As Object, ByVal e As RadTreeViewDragEventArgs)
    '    _dragging = True
    'End Sub

    'Private Sub radTreeView1_DragEnded(ByVal sender As Object, ByVal e As RadTreeViewDragEventArgs)
    '    _dragging = False
    'End Sub

    'Private Sub radTreeView1_NodeExpandedChanged(ByVal sender As Object, ByVal e As RadTreeViewEventArgs)
    '    If _dragging Then
    '        If e.Node.Expanded Then
    '            e.Node.Collapse()
    '        End If
    '    End If
    'End Sub
    ''#End Region

    'Protected Overrides Sub OnLoad(ByVal e As EventArgs)
    '    MyBase.OnLoad(e)

    '    AddHandler RadTreeView1.DragEnding, AddressOf radTreeView1_DragEnding
    '    AddHandler RadTreeView1.DragStarted, AddressOf radTreeView1_DragStarted
    '    AddHandler RadTreeView1.DragEnded, AddressOf radTreeView1_DragEnded
    '    AddHandler RadTreeView1.NodeExpandedChanged, AddressOf radTreeView1_NodeExpandedChanged
    'End Sub
End Class
</code></pre>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

