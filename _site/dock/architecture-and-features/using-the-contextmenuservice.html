<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Using the ContextMenuService</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Using the ContextMenuService">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-849dcaf701d866988e8c3593f15b66de.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/" title="WinForms Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/winforms.aspx" title="About UI for WinForms" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/winforms.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/winforms/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("dock/architecture-and-features/using-the-contextmenuservice.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/dock/architecture-and-features/using-the-contextmenuservice.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="using-the-contextmenuservice"><a href="#using-the-contextmenuservice">Using the ContextMenuService</a></h1>

<h2 id="overview"><a href="#overview">Overview</a></h2>

<p>All context menu related operations are handled by a stand alone service, registered with RadDock - ContextMenuService. Each context menu request is passed to the service, which on its hand creates the appropriate menu items and raises several events, which allows users to modify existing items, add their own or even cancel the request.</p>

<h2 id="modifying-the-existing-context-menus"><a href="#modifying-the-existing-context-menus">Modifying the existing context menus</a></h2>

<p>The following example demonstrates how you can hide the 'close' options from the DocumentWindow context menu. By default the menu looks like this:<img src="images/dock-architecture-and-features-using-the-contextmenuservice001.png" alt="dock-architecture-and-features-using-the-contextmenuservice 001"></p>

<p>Let's get the ContextMenuService and subscribe toÂ its ContextMenuDisplaying event:</p>

<h4><strong>[C#] Getting the ContextMenuService</strong></h4>

<pre><code>            ContextMenuService menuService = this.radDock1.GetService&lt;ContextMenuService&gt;();
            menuService.ContextMenuDisplaying += menuService_ContextMenuDisplaying;
</code></pre>

<h4><strong>[VB.NET] Getting the ContextMenuService</strong></h4>

<pre><code>        Dim menuService As ContextMenuService = Me.RadDock1.GetService(Of ContextMenuService)()
        AddHandler menuService.ContextMenuDisplaying, AddressOf menuService_ContextMenuDisplaying
</code></pre>

<p>Then, hide the 'close' options in the ContextMenuDisplaying event handler:</p>

<h4><strong>[C#] Hiding the 'close' menu items</strong></h4>

<pre><code>        private void menuService_ContextMenuDisplaying(object sender, ContextMenuDisplayingEventArgs e)
        {
            //the menu request is associated with a valid DockWindow instance, which resides within a DocumentTabStrip
            if (e.MenuType == ContextMenuType.DockWindow &amp;&amp;
                e.DockWindow.DockTabStrip is DocumentTabStrip)
            {
                //remove the "Close" menu items
                for (int i = 0; i &lt; e.MenuItems.Count; i++)
                {
                    RadMenuItemBase menuItem = e.MenuItems[i];
                    if (menuItem.Name == "CloseWindow" ||
                        menuItem.Name == "CloseAllButThis" ||
                        menuItem.Name == "CloseAll" ||
                        menuItem is RadMenuSeparatorItem)
                    {
                        // In case you just want to disable to option you can set Enabled false
                        //menuItem.Enabled = false;
                        menuItem.Visibility = Telerik.WinControls.ElementVisibility.Collapsed;
                    }
                }
            }
        }
</code></pre>

<h4><strong>[VB.NET] Hiding the 'close' menu items</strong></h4>

<pre><code>    Private Sub menuService_ContextMenuDisplaying(ByVal sender As Object, ByVal e As ContextMenuDisplayingEventArgs)
        'the menu request is associated with a valid DockWindow instance, which resides within a DocumentTabStrip
        If e.MenuType = ContextMenuType.DockWindow AndAlso TypeOf e.DockWindow.DockTabStrip Is DocumentTabStrip Then
            'remove the "Close" menu items
            For i As Integer = 0 To e.MenuItems.Count - 1
                Dim menuItem As RadMenuItemBase = e.MenuItems(i)
                If menuItem.Name = "CloseWindow" OrElse menuItem.Name = "CloseAllButThis" OrElse menuItem.Name = "CloseAll" OrElse TypeOf menuItem Is RadMenuSeparatorItem Then
                    ' In case you just want to disable to option you can set Enabled false
                    'menuItem.Enabled = false;
                    menuItem.Visibility = Telerik.WinControls.ElementVisibility.Collapsed
                End If
            Next i
        End If
    End Sub
</code></pre>

<p>The result is shown on the screenshot below:<img src="images/dock-architecture-and-features-using-the-contextmenuservice002.png" alt="dock-architecture-and-features-using-the-contextmenuservice 002"></p>

<h2 id="menu-items-names"><a href="#menu-items-names">Menu items' names</a></h2>

<p>You can notice in the code snippet above that we are using the Name property of the items instead of the Text property. This allows you to handle the case even when a custom <a href="/devtools/winforms/dock/localization/localization">RadDockLocalization</a> provider is applied. The names for the menu items in RadDock are:</p>

<table>
<tr>
<td>

<b>Text</b>
</td>
<td>

<b>Name</b>
</td>
</tr>
<tr>
<td>

Close</td>
<td>

CloseWindow</td>
</tr>
<tr>
<td>

Close All But This</td>
<td>

CloseAllButThis</td>
</tr>
<tr>
<td>

Close All</td>
<td>

CloseAll</td>
</tr>
<tr>
<td>

New Horizontal Tab Group</td>
<td>

NewHTabGroup</td>
</tr>
<tr>
<td>

New Vertical Tab Group</td>
<td>

NewVTabGroup</td>
</tr>
<tr>
<td>

Floating</td>
<td>

Floating</td>
</tr>
<tr>
<td>

Dockable</td>
<td>

Docked</td>
</tr>
<tr>
<td>

Tabbed Document</td>
<td>

TabbedDocument</td>
</tr>
<tr>
<td>

Auto Hide</td>
<td>

AutoHide</td>
</tr>
<tr>
<td>

Hide</td>
<td>

Hidden</td>
</tr>
<tr>
<td>

<i>Document Name</i>
</td>
<td>

ActivateWindow</td>
</tr>
</table>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

