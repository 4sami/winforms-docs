<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Using the CommandManager</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Using the CommandManager">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-849dcaf701d866988e8c3593f15b66de.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/" title="WinForms Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/winforms.aspx" title="About UI for WinForms" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/winforms.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/winforms/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("dock/architecture-and-features/using-the-command-manager.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/dock/architecture-and-features/using-the-command-manager.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="using-the-commandmanager"><a href="#using-the-commandmanager">Using the CommandManager</a></h1>

<h2 id="predefined-commands"><a href="#predefined-commands">Predefined Commands</a></h2>

<ul>
<li><p><strong>DisplayQuickNavigator (CTRL+TAB)</strong>: Displays the window activation tool (quick navigator)</p></li>
<li><p><strong>CloseActiveDocument (CTRL+F4)</strong>: Closes the currently active document and selects the next in the activation order list.</p></li>
<li><p><strong>NextDocument (CTRL+F6)</strong>: Sends the currently active document to the back of the activation order list and activates the next one.</p></li>
<li><p><strong>PreviousDocument (CTRL+SHIFT+F6)</strong> Puts the last document in the activation order list in front and activates it.</p></li>
</ul>

<p>The names of all predefined commands may be found in the static PredefinedCommandNames class.</p>

<h2 id="providing-custom-shortcuts"><a href="#providing-custom-shortcuts">Providing Custom Shortcuts</a></h2>

<p>You may easily specify custom shortcut for any of the predefined commands like this:</p>

<h4>__[C#] __</h4>

<pre><code>        private void ChangeNextDocumentShortcut()
        {
            RadDockCommand command = this.radDock1.CommandManager.FindCommandByName(PredefinedCommandNames.NextDocument);
            command.Shortcuts.Clear();
            command.Shortcuts.Add(new RadShortcut(Keys.Shift, Keys.A, Keys.S));
        }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    Private Sub ChangeNextDocumentShortcut()
        Dim command As RadDockCommand = Me.radDock1.CommandManager.FindCommandByName(PredefinedCommandNames.NextDocument)
        command.Shortcuts.Clear()
        command.Shortcuts.Add(New RadShortcut(Keys.Shift, Keys.A, Keys.S))
    End Sub
</code></pre>

<p>The above code specifies the SHIFT+A+S as a valid key combination that will trigger the NextDocument command.</p>

<h2 id="registering-custom-command"><a href="#registering-custom-command">Registering Custom Command</a></h2>

<p>The completely transparent object model of the command manager allows you to create and register completely custom command and associate it with the desired key combination. The following code demonstrates how to create custom command that floats the currently active tool window and is associated with the CTRL+F shortcut:</p>

<h4><strong>[C#] Define the custom command class</strong></h4>

<pre><code>    public class FloatWindowCommand : RadDockCommand
    {
        public FloatWindowCommand()
        {
            this.Name = "FloatWindow";
            this.Shortcuts.Add(new RadShortcut(Keys.Control, Keys.F));
        }

        public override bool CanExecute(object parameter)
        {
            RadDock dock = parameter as RadDock;
            if (dock == null)
            {
                return false;
            }
            return dock.ActiveWindow is ToolWindow;
        }

        public override object Execute(params object[] settings)
        {
            RadDock dock = settings[0] as RadDock;
            Debug.Assert(dock != null, "Invalid execute parameter!");
            ToolWindow toolWindow = dock.ActiveWindow as ToolWindow;
            if (toolWindow != null)
            {
                dock.FloatWindow(toolWindow);
            }
            return base.Execute(settings);
        }  
    }
</code></pre>

<h4><strong>[VB.NET] Define the custom command class</strong></h4>

<pre><code>Public Class FloatWindowCommand
    Inherits RadDockCommand
    Public Sub New()
        Me.Name = "FloatWindow"
        Me.Shortcuts.Add(New RadShortcut(Keys.Control, Keys.F))
    End Sub

    Public Overrides Function CanExecute(parameter As Object) As Boolean
        Dim dock As RadDock = TryCast(parameter, RadDock)
        If dock Is Nothing Then
            Return False
        End If
        Return TypeOf dock.ActiveWindow Is ToolWindow
    End Function

    Public Overrides Function Execute(ParamArray settings As Object()) As Object
        Dim dock As RadDock = TryCast(settings(0), RadDock)
        Debug.Assert(dock IsNot Nothing, "Invalid execute parameter!")
        Dim toolWindow As ToolWindow = TryCast(dock.ActiveWindow, ToolWindow)
        If toolWindow IsNot Nothing Then
            dock.FloatWindow(toolWindow)
        End If
        Return MyBase.Execute(settings)
    End Function
End Class
</code></pre>

<h4><strong>[C#] Register the custom command</strong></h4>

<pre><code>        private void RegisterCustomCommand()
        {
            this.radDock1.CommandManager.RegisterCommand(new FloatWindowCommand());
        }
</code></pre>

<h4><strong>[VB.NET] Register the custom command</strong></h4>

<pre><code>    Private Sub RegisterCustomCommand()
        Me.radDock1.CommandManager.RegisterCommand(New FloatWindowCommand())
    End Sub
</code></pre>

<h2 id="enable-disable-the-command-manager"><a href="#enable-disable-the-command-manager">Enable Disable the Command Manager</a></h2>

<p>You may easily disable the command manager, using its <strong>Enabled</strong> property. Alternatively, you may either clear all commands or clear any shortcut associated with these commands.</p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

