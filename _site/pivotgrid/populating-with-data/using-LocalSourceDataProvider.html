<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Using the LocalSourceDataProvider</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Using the LocalSourceDataProvider">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            


<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">


</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("pivotgrid/populating-with-data/using-LocalSourceDataProvider.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/pivotgrid/populating-with-data/using-LocalSourceDataProvider.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="using-the-localsourcedataprovider"><a href="#using-the-localsourcedataprovider">Using the LocalSourceDataProvider</a></h1>

<p>LocalDataSourceProvider is one of the data providers that can be used with RadPivotGrid and RadPivotFieldList. It provides data access to local source such as an IList of instances of user defined classes. In fact any collection that implements the IEnumerable interface can be used as a LocalDataSourceProvider.</p>

<h2 id="defining-localdatasourceprovider"><a href="#defining-localdatasourceprovider">Defining LocalDataSourceProvider</a></h2>

<p>You can create an object of type LocalDataSourceProvider and assign it to RadPivotGrid. The LocalDataSourceProvider has an ItemSource property and it is mandatory to set it if you want to display any data. The following code snippet demonstrates this:</p>

<h4>__[C#] __</h4>

<pre><code>            LocalDataSourceProvider dataProvider = new LocalDataSourceProvider();
            dataProvider.ItemsSource = dataset.Orders;
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        Dim dataProvider As New LocalDataSourceProvider()
        dataProvider.ItemsSource = dataset.Orders
</code></pre>

<blockquote>
<p>The ItemSource can be any collection that implements IEnumerable interface or even a DataTable.</p>
</blockquote>

<h2 id="adding-group-descriptions-collections"><a href="#adding-group-descriptions-collections">Adding Group Descriptions Collections</a></h2>

<blockquote>
<p>When initializing the LocalDataSourceProvider it is a good idea to wrap all modifications in BeginInit() - EndInit() section. This will cause only one refresh of the DataProvider and it will be when the EndInit() is reached. If you are applying only modifications (more than one) on already initialized LocalDataSourceProvider you should use the DeferRefresh() method which will cause delay of the Refresh and this way all changes will be applied simultaneously.</p>
</blockquote>

<p>The LocalDataSourceProvider is using four different collections for the data that it holds:</p>

<ul>
<li>
<strong>RowGroupDescription</strong> - the data added to this description will be shown as rows headers in RadPivotGrid and RadPivotFieldList. The properties can be defined as PropertyGroupDescription, DateTimeGroupDescription, DoubleGroupDescription or you can create custom implementation of PropertyGroupDescriptionBase class.
        Here's how to define the RowGroupDescriptions in your application: </li>
</ul>

<h4>__[C#] __</h4>

<pre><code>            dataProvider.BeginInit();
            dataProvider.RowGroupDescriptions.Add(new DateTimeGroupDescription() { PropertyName = "OrderDate", Step = DateTimeStep.Year, GroupComparer = new GroupNameComparer() });
            dataProvider.RowGroupDescriptions.Add(new DateTimeGroupDescription() { PropertyName = "OrderDate", Step = DateTimeStep.Quarter, GroupComparer = new GroupNameComparer() });
            dataProvider.RowGroupDescriptions.Add(new DateTimeGroupDescription() { PropertyName = "OrderDate", Step = DateTimeStep.Month, GroupComparer = new GroupNameComparer() });
            dataProvider.EndInit();
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        dataProvider.BeginInit()
        dataProvider.RowGroupDescriptions.Add(New DateTimeGroupDescription() With { _
         .PropertyName = "OrderDate", _
         .[Step] = DateTimeStep.Year, _
         .GroupComparer = New GroupNameComparer() _
        })
        dataProvider.RowGroupDescriptions.Add(New DateTimeGroupDescription() With { _
         .PropertyName = "OrderDate", _
         .[Step] = DateTimeStep.Quarter, _
         .GroupComparer = New GroupNameComparer() _
        })
        dataProvider.RowGroupDescriptions.Add(New DateTimeGroupDescription() With { _
         .PropertyName = "OrderDate", _
         .[Step] = DateTimeStep.Month, _
         .GroupComparer = New GroupNameComparer() _
        })
        dataProvider.EndInit()
</code></pre>

<ul>
<li>
<strong>ColumnGroupDescription</strong> - the data added to this description will be shown as columns headers in RadPivotGrid and RadPivotFieldList. The properties can be defined as PropertyGroupDescription, DateTimeGroupDescription, DoubleGroupDescription or you can create custom implementation of PropertyGroupDescriptionBase class.
        Here's how to define the ColumnGroupDescriptions in your application: </li>
</ul>

<h4>__[C#] __</h4>

<pre><code>            dataProvider.ColumnGroupDescriptions.Add(new PropertyGroupDescription() { PropertyName = "EmployeeID", GroupComparer = new GrandTotalComparer() });
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        dataProvider.ColumnGroupDescriptions.Add(New PropertyGroupDescription() With { _
         .PropertyName = "EmployeeID", _
         .GroupComparer = New GrandTotalComparer() _
        })
</code></pre>

<ul>
<li>
<strong>AggregateDescriptions</strong> - the data added to this description will be aggregated and included in RadPivotGrid as Cells. The properties can be defined as PropertyAggregateDescription or you can create custom implementation of PropertyAggregateDescriptionBase class.
        Here's how to define the AggregateDescriptions in your application:</li>
</ul>

<h4>__[C#] __</h4>

<pre><code>            dataProvider.BeginInit();
            dataProvider.AggregateDescriptions.Add(new PropertyAggregateDescription() { PropertyName = "Freight", AggregateFunction = AggregateFunctions.Sum });
            dataProvider.AggregateDescriptions.Add(new PropertyAggregateDescription() { PropertyName = "Freight", AggregateFunction = AggregateFunctions.Average });
            dataProvider.EndInit();
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        dataProvider.BeginInit()
        dataProvider.AggregateDescriptions.Add(New PropertyAggregateDescription() With { _
         .PropertyName = "Freight", _
         .AggregateFunction = AggregateFunctions.Sum _
        })
        dataProvider.AggregateDescriptions.Add(New PropertyAggregateDescription() With { _
         .PropertyName = "Freight", _
         .AggregateFunction = AggregateFunctions.Average _
        })
        dataProvider.EndInit()
</code></pre>

<ul>
<li>
<strong>FilterDescriptions</strong> - the data added to this description will be filtered and after that included in RadPivotGrid. The properties can be defined as PropertyFilterDescription or you can create custom implementation of PropertyFilterDescriptionBase class.</li>
</ul>

<h4>__[C#] __</h4>

<pre><code>            dataProvider.FilterDescriptions.Add(new PropertyFilterDescription() { PropertyName = "ShipCountry", CustomName = "Country" });
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        dataProvider.FilterDescriptions.Add(New PropertyFilterDescription() With { _
         .PropertyName = "ShipCountry", _
         .CustomName = "Country" _
        })
</code></pre>

<h2 id="adding-property-descriptors"><a href="#adding-property-descriptors">Adding Property Descriptors</a></h2>

<p>All property description classes are inheriting the abstract class DescriptionBase. That's why all of them have the following properties:</p>

<ul>
<li><p><strong>PropertyName</strong> - this is the most important property. It must be set to the property of the data that will be represented with this property description.</p></li>
<li><p><strong>CustomName</strong> - sets the name that will be shown instead of the property name in RadPivotGrid and RadPivotFieldList.</p></li>
</ul>

<p>Here is a list of the property descriptions that you can use:</p>

<ul>
<li><p><strong>PropertyGroupDescription</strong> - available for RowGroupDescriptions and ColumnGroupDescriptions.</p></li>
<li><p><strong>DoubleGroupDescription</strong> - available for RowGroupDescriptions and ColumnGroupDescriptions. Used when the data is of type Double. One of the important properties is Step - it is used to define the size of the generated groups.</p></li>
<li><p><strong>DateTimeGroupDescription</strong> - available for RowGroupDescriptions and ColumnGroupDescriptions. Used when the data is of type DateTime. Very useful is the Step property where you can set if the grouping should be on day, month or year.</p></li>
<li><p><strong>PropertyFilterDescription</strong> - available for FilterDescriptions only. The important property here is Condition as the filtering is done based on it. You can use four conditions: ComparisonCondition, IntervalCondition, SetCondition, TextCondition.</p></li>
<li><p><strong>PropertyAggregateDescription</strong> - available for AggregateDescriptions only. You have to define the AggregateFunction that will be used. You can choose between various predefined functions like Average, Sum, Min, Max etc.</p></li>
</ul>

<h2 id="applying-the-dataprovider-to-radpivotgrid"><a href="#applying-the-dataprovider-to-radpivotgrid">Applying the DataProvider to RadPivotGrid</a></h2>

<p>To apply the already defined data provider, use the following property:</p>

<h4>__[C#] __</h4>

<pre><code>            this.radPivotGrid1.DataProvider = dataProvider;
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        Me.RadPivotGrid1.DataProvider = dataProvider
</code></pre>

<pre><code>    The Culture property
</code></pre>

<p>The groups formed by the DateTimeGroupDescription as well as the number format of the values formed by the DoubleGroupDescription both depend on<br>
        the current culture. For example, in some cultures weeks start on Saturday but in others they start on Monday which will result in different values<br>
        when the grouping step is Week. To change the culture of the LocalDataSourceProvider, just set its Culture property.</p>

<h4>__[C#] __</h4>

<pre><code>            dataProvider.Culture = new System.Globalization.CultureInfo("de-DE");
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        dataProvider.Culture = New System.Globalization.CultureInfo("de-DE")
</code></pre>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

