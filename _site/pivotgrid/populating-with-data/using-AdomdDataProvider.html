<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Using the AdomdDataProvider</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Using the AdomdDataProvider">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-849dcaf701d866988e8c3593f15b66de.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/" title="WinForms Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/winforms.aspx" title="About UI for WinForms" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/winforms.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/winforms/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("pivotgrid/populating-with-data/using-AdomdDataProvider.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/pivotgrid/populating-with-data/using-AdomdDataProvider.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="using-the-adomddataprovider"><a href="#using-the-adomddataprovider">Using the AdomdDataProvider</a></h1>

<p>In this article we will show how to use AdomdDataProvider and use data from OLAP Cube for RadPivotGrid.</p>

<h2 id="adomdnet"><a href="#adomdnet">ADOMD.NET</a></h2>

<p>ADOMD.NET is a Microsoft .NET Framework data provider that is designed to communicate with Microsoft SQL Server Analysis Services. ADOMD.NET uses the XML for Analysis protocol to communicate with analytical data sources by using either TCP/IP or HTTP connections to transmit and receive SOAP requests and responses that are compliant with the XML for Analysis specification.</p>

<h2 id="adomddataprovider"><a href="#adomddataprovider">AdomdDataProvider</a></h2>

<p>RadPivotGrid can use AdomdDataProvider to get data from OLAP Cube.  To be able to work with AdomdDataProvider, you need to have an<br>
          Adomd client installed on your machine. This client is part of the<br>
          <a href="http://www.microsoft.com/en-us/download/details.aspx?id=30440">Microsoft® SQL Server® Feature Pack</a>.</p>

<p>AdomdDataProvider has several important properties that have to be defined in order to connect to OLAP Cube: </p>

<ul>
<li><p><strong>ConnectionSettings</strong> - this property is of type AdomdConnectionSettings and it exposes several properties that are mandatory when connecting to the OLAP Cube:</p></li>
<li><p><strong>Cube</strong> - string property defining the exact name of the Cube.</p></li>
<li><p><strong>Database</strong> - string property defining the exact name of the Database.</p></li>
<li><p><strong>ConnectionString</strong> - string property used to open a database. It is in OLE DB connection string format.</p></li>
</ul>

<blockquote>
<p>The OLE DB connection string format has several keys and values connected with equal sign. The different key-value pairs are separated by semicolon characters. Some of the important properties are Provider, Data Source, Integrated Security, etc. Here are some examples for different OLE DB connection strings:</p>
</blockquote>

<ul>
<li><p>"Provider=MSDAORA; Data Source=ORACLE8i7;Persist Security Info=False;Integrated Security=Yes"</p></li>
<li><p>"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=c:\bin\LocalAccess40.mdb"</p></li>
<li><p>"Provider=SQLOLEDB;Data Source=(local);Integrated Security=SSPI"</p></li>
<li><p><strong>AggregatesLevel</strong> - set the position where groups for the aggregates should be placed.</p></li>
<li><p><strong>AggregatesPosition</strong> - defines whether the position of the Aggregates will be Columns or Rows.</p></li>
</ul>

<h2 id="defining-adomddataprovider-and-connecting-to-olap-cube"><a href="#defining-adomddataprovider-and-connecting-to-olap-cube">Defining AdomdDataProvider and connecting to OLAP Cube</a></h2>

<p>To show data in RadPivotGrid and RadPivotFieldList we have to connect to OLAP Cube. For this purpose we will set the ConnectionSettings property of the AdomdDataProvider.</p>

<h4>__[C#] __</h4>

<pre><code>            AdomdDataProvider provider = new AdomdDataProvider();
            AdomdConnectionSettings settings = new AdomdConnectionSettings();

            settings.Cube = "Adventure Works";
            settings.Database = "Adventure Works DW 2008R2";
            settings.ConnectionString = "Data Source=http://demos.telerik.com/olap/msmdpump.dll;Catalog=Adventure Works DW 2008R2";

            provider.ConnectionSettings = settings;
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        Dim provider As New AdomdDataProvider()
        Dim settings As New AdomdConnectionSettings()

        settings.Cube = "Adventure Works"
        settings.Database = "Adventure Works DW 2008R2"
        settings.ConnectionString = "Data Source=http://demos.telerik.com/olap/msmdpump.dll;Catalog=Adventure Works DW 2008R2"

        provider.ConnectionSettings = settings
</code></pre>

<h2 id="defining-group-descriptions"><a href="#defining-group-descriptions">Defining Group Descriptions</a></h2>

<blockquote>
<p>When initializing the AdomdDataProvider in the code behind it is a good idea to wrap all modifications in BeginInit() - EndInit() section. This will cause only one refresh of the DataProvider and it will be when the EndInit() is reached. If you are applying only modifications (more than one) on already initialized AdomdDataProvider you should use the DeferRefresh() method which will cause delay of the Refresh and this way all your changes will be applied simultaneously.</p>
</blockquote>

<p>The AdomdDataProvider is using three collections that are reflecting the visual representation of RadPivotGrid and RadPivotFieldList:</p>

<ul>
<li><p><strong>RowGroupDescriptions</strong> - the data added to this collection will show as Row Headers in RadPivotGrid. There is only one type of description that can be added to this collection - AdomdGroupDescription.</p></li>
<li><p><strong>ColumnGroupDescriptions</strong> - the data added to this collection will show as Column Headers in RadPivotGrid. There is only one type of description that can be added to this collection - AdomdGroupDescription.</p></li>
<li><p><strong>AggregateDescriptions</strong> - the data added to this description will be aggregated and included in RadPivotGrid as Cells. There is only one type of description that can be added to this collection - AdomdAggregateDescription.</p></li>
</ul>

<p>The AdomdGroupDescription is used to define the data that will show as Rows and Columns in RadPivotGrid. When defining AdomdGroupDescription you must set the MemberName property. The MemberName property is of type string and you should define it based on your Cube.</p>

<p>The AdomdAggregateDescription is used to define data that has to be aggregated and that will show as Cells in RadPivotGrid. The data that should be aggregated is defined with the MemberName property.</p>

<blockquote>
<p>The MemberName property must have the following syntax: </p>
</blockquote>

<ul>
<li><p>For AdomdAggregateDescription: "[Measures].[MEASURE_NAME]".</p></li>
<li><p>For AdomdGroupDescription there are two ways (based on the data that will be used): "[DIMENSION].[HIERARCHY]" or "[SET_NAME]".<br>
          Note that the brackets are mandatory.</p></li>
</ul>

<h4>__[C#] __</h4>

<pre><code>            provider.BeginInit();

            provider.RowGroupDescriptions.Add(new AdomdGroupDescription() { MemberName = "[Date].[Calendar Year]" });
            provider.RowGroupDescriptions.Add(new AdomdGroupDescription() { MemberName = "[Date].[Calendar Quarter of Year]" });

            provider.ColumnGroupDescriptions.Add(new AdomdGroupDescription() { MemberName = "[Promotion].[Promotion Category]" });
            provider.ColumnGroupDescriptions.Add(new AdomdGroupDescription() { MemberName = "[Product].[Category]" });

            provider.AggregateDescriptions.Add(new AdomdAggregateDescription() { MemberName = "[Measures].[Internet Order Quantity]" });

            provider.EndInit();

            this.radPivotGrid1.PivotGridElement.DataProvider = provider;
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        provider.BeginInit()

        provider.RowGroupDescriptions.Add(New AdomdGroupDescription() With { _
         .MemberName = "[Date].[Calendar Year]" _
        })
        provider.RowGroupDescriptions.Add(New AdomdGroupDescription() With { _
         .MemberName = "[Date].[Calendar Quarter of Year]" _
        })

        provider.ColumnGroupDescriptions.Add(New AdomdGroupDescription() With { _
         .MemberName = "[Promotion].[Promotion Category]" _
        })
        provider.ColumnGroupDescriptions.Add(New AdomdGroupDescription() With { _
         .MemberName = "[Product].[Category]" _
        })

        provider.AggregateDescriptions.Add(New AdomdAggregateDescription() With { _
         .MemberName = "[Measures].[Internet Order Quantity]" _
        })

        provider.EndInit()

        Me.RadPivotGrid1.PivotGridElement.DataProvider = provider
</code></pre>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

