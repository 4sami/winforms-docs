<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Combining RadDragDropService and OLE drag-and-drop</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Combining RadDragDropService and OLE drag-and-drop">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-849dcaf701d866988e8c3593f15b66de.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/" title="WinForms Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/winforms.aspx" title="About UI for WinForms" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/winforms.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/winforms/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("listview/drag-and-drop/combining-raddragdropservice-and-ole-drag-and-drop.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/listview/drag-and-drop/combining-raddragdropservice-and-ole-drag-and-drop.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="combining-raddragdropservice-and-ole-drag-and-drop"><a href="#combining-raddragdropservice-and-ole-drag-and-drop">Combining RadDragDropService and OLE drag-and-drop</a></h1>

<p>This article demonstrates a sample approach how to achieve drag and drop functionality between <strong>RadListView</strong> and <strong>RadListControl</strong>.<br>
        For this purpose, we will use a combination between the <strong>RadDragDropService</strong>, supported by the <strong>RadListView</strong> control, and the OLE drag-and-drop,<br>
        which is supported by all controls from the Telerik UI for WinForms suite.</p>

<p>Letâ€™s assume that our <strong>RadListView</strong> is in bound mode and its <strong>ViewType</strong> property is set to <em>IconsView</em>. <br>
        The <strong>RadListControl</strong> is populated manually with items. Set the <strong>AllowDrop</strong> property to <em>true</em>  for both of the controls.<br>
        Additionally, you need to set the RadListView.<strong>AllowDragDrop</strong> property to <em>true</em> as well.</p>

<h4>__[C#] __</h4>

<pre><code>            BindingList&lt;string&gt; items = new BindingList&lt;string&gt;();
            for (int i = 0; i &lt; 10; i++)
            {
                items.Add("Item" + i);                
                this.radListControl1.Items.Add("ListControlItem" + i);
            }

            this.radListView1.DataSource = items;
            this.radListView1.AllowDragDrop = true;
            this.radListView1.AllowDrop = true;
            this.radListControl1.AllowDrop = true;
            this.radListView1.ViewType = Telerik.WinControls.UI.ListViewType.IconsView;
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        Dim items As New BindingList(Of String)()
        For i As Integer = 0 To 9
            items.Add("Item" &amp; i)
            Me.RadListControl1.Items.Add("ListControlItem" &amp; i)
        Next

        Me.RadListView1.DataSource = items
        Me.RadListView1.AllowDragDrop = True
        Me.RadListView1.AllowDrop = True
        Me.RadListControl1.AllowDrop = True
        Me.RadListView1.ViewType = Telerik.WinControls.UI.ListViewType.IconsView
        '#End Region


        Me.RadListView1.ItemSize = New Size(110, 20)

        AddHandler Me.RadListView1.ListViewElement.DragDropService.PreviewDragOver, AddressOf DragDropService_PreviewDragOver
        AddHandler Me.RadListView1.ListViewElement.DragDropService.PreviewDragDrop, AddressOf DragDropService_PreviewDragDrop

        AddHandler Me.RadListControl1.MouseDown, AddressOf radListControl1_MouseDown
        AddHandler Me.RadListControl1.MouseMove, AddressOf radListControl1_MouseMove
        AddHandler Me.RadListControl1.MouseUp, AddressOf radListControl1_MouseUp
        AddHandler Me.RadListView1.DragEnter, AddressOf radListView1_DragEnter
        AddHandler Me.RadListView1.DragDrop, AddressOf radListView1_DragDrop
    End Sub

    '#Region "ListControlToListView"

    '#Region "ListControlToListViewStart"

    Private mouseDownPosition As Point
    Private isDragging As Boolean

    Private Sub radListControl1_MouseDown(sender As Object, e As MouseEventArgs)
        Me.mouseDownPosition = e.Location
    End Sub

    Private Sub radListControl1_MouseMove(sender As Object, e As MouseEventArgs)
        If e.Button &lt;&gt; MouseButtons.Left Then
            Me.isDragging = False
            Return
        End If

        If Me.isDragging Then
            Return
        End If

        If Me.ShouldBeginDrag(Me.mouseDownPosition, e.Location) Then
            Dim draggedItem As RadListVisualItem = TryCast(Me.RadListControl1.ElementTree.GetElementAtPoint(Me.mouseDownPosition), RadListVisualItem)
            If draggedItem IsNot Nothing Then
                Me.isDragging = True
                'start the drag and drop operation
                TryCast(sender, RadListControl).DoDragDrop(draggedItem.Data, DragDropEffects.Copy)
            End If
        End If
    End Sub

    Private Function ShouldBeginDrag(current As Point, capture As Point) As Boolean
        Dim dragSize As Size = SystemInformation.DragSize
        Dim dragRect As New Rectangle(capture.X - dragSize.Width / 2, capture.Y - dragSize.Height / 2, dragSize.Width, dragSize.Height)
        Return Not dragRect.Contains(current)
    End Function

    Private Sub radListView1_DragEnter(sender As Object, e As DragEventArgs)
        e.Effect = DragDropEffects.Copy
    End Sub

    '#End Region

    '#Region "ListControlToListViewDragDrop"

    Private Sub radListView1_DragDrop(sender As Object, e As DragEventArgs)
        Dim listView As RadListView = TryCast(sender, RadListView)
        Dim point__1 As Point = listView.PointToClient(New Point(e.X, e.Y))
        Dim targetItem As BaseListViewVisualItem = TryCast(listView.ElementTree.GetElementAtPoint(point__1), BaseListViewVisualItem)
        Dim draggedItem As RadListDataItem = TryCast(e.Data.GetData(GetType(RadListDataItem)), RadListDataItem)

        Dim targetDataSource As BindingList(Of String) = TryCast(listView.DataSource, BindingList(Of String))
        If targetDataSource IsNot Nothing Then
            'you are dropping over an item
            If targetItem IsNot Nothing Then
                Dim targetIndex As Integer = listView.Items.IndexOf(targetItem.Data)

                targetDataSource.Insert(targetIndex, draggedItem.Text)
            Else
                ' you are dropping over the ListViewElement
                targetDataSource.Add(draggedItem.Text)
            End If
        End If

        Dim indexToRemove As Integer = Me.RadListControl1.Items.IndexOf(draggedItem)
        If indexToRemove &gt; -1 Then
            Me.RadListControl1.Items.RemoveAt(indexToRemove)
        End If
        Me.mouseDownPosition = Point.Empty
        Me.isDragging = False
    End Sub

    Private Sub radListControl1_MouseUp(sender As Object, e As MouseEventArgs)
        Me.mouseDownPosition = Point.Empty
        Me.isDragging = False
    End Sub

    '#End Region

    '#End Region

    '#Region "ListViewToListControl"

    Private Sub DragDropService_PreviewDragOver(sender As Object, e As Telerik.WinControls.RadDragOverEventArgs)
        e.CanDrop = TypeOf e.HitTarget Is RadListElement
    End Sub

    Private Sub DragDropService_PreviewDragDrop(sender As Object, e As Telerik.WinControls.RadDropEventArgs)
        Dim draggedItem As BaseListViewVisualItem = TryCast(e.DragInstance, BaseListViewVisualItem)
        Dim listElement As RadListElement = TryCast(e.HitTarget, RadListElement)

        If listElement Is Nothing Then
            Return
        End If
        e.Handled = True
        Dim listControl As RadListControl = TryCast(listElement.ElementTree.Control, RadListControl)
        Dim targetItem As RadListVisualItem = TryCast(listControl.ElementTree.GetElementAtPoint(e.DropLocation), RadListVisualItem)
        Dim indexToInsert As Integer
        If targetItem IsNot Nothing Then
            indexToInsert = targetItem.Data.RowIndex
        Else
            indexToInsert = listControl.Items.Count
        End If
        Dim newItem As New RadListDataItem(draggedItem.Data.Text)
        listControl.Items.Insert(indexToInsert, newItem)

        draggedItem.Data.ListView.Items.Remove(draggedItem.Data)
    End Sub

    '#End Region

End Class
</code></pre>

<h2 id="drag-and-drop-from-radlistview-to-radlistcontrol-using-raddragdropservice"><a href="#drag-and-drop-from-radlistview-to-radlistcontrol-using-raddragdropservice">Drag and drop from RadListView to RadListControl using RadDragDropService<img src="images/listview-drag-and-drop-combining-raddragdropservice-and-ole-drag-and-drop001.gif" alt="listview-drag-and-drop-combining-raddragdropservice-and-ole-drag-and-drop 001"></a></h2>

<p>To implement drag and drop functionality for this scenario, we will use the ListViewElement.<strong>DragDropService</strong>, which is a derivative of the<br>
          <strong>RadDragDropService</strong>. Subscribe to its <strong>PreviewDragOver</strong> and <strong>PreviewDragDrop</strong> events. <br>
          In the <strong>PreviewDragOver</strong> event allow dropping over a <strong>RadListElement</strong>. The <strong>PreviewDragDrop</strong> <br>
          event performs the actual inserting of the dragged item into the RadListControl.<strong>Items</strong> collection:</p>

<h4>__[C#] __</h4>

<pre><code>        private void DragDropService_PreviewDragOver(object sender, Telerik.WinControls.RadDragOverEventArgs e)
        {
            e.CanDrop = e.HitTarget is RadListElement;
        }

        private void DragDropService_PreviewDragDrop(object sender, Telerik.WinControls.RadDropEventArgs e)
        { 
            BaseListViewVisualItem draggedItem = e.DragInstance as BaseListViewVisualItem;
            RadListElement listElement = e.HitTarget as RadListElement;

            if (listElement == null)
            {
                return;
            }
            e.Handled = true;         
            RadListControl listControl = listElement.ElementTree.Control as RadListControl;
            RadListVisualItem targetItem = listControl.ElementTree.GetElementAtPoint(e.DropLocation) as RadListVisualItem;
            int indexToInsert;
            if (targetItem != null)
            {
                indexToInsert = targetItem.Data.RowIndex;
            }
            else
            {
                indexToInsert = listControl.Items.Count;
            }
            RadListDataItem newItem = new RadListDataItem(draggedItem.Data.Text);
            listControl.Items.Insert(indexToInsert, newItem);

            draggedItem.Data.ListView.Items.Remove(draggedItem.Data);
        }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    Private Sub DragDropService_PreviewDragOver(sender As Object, e As Telerik.WinControls.RadDragOverEventArgs)
        e.CanDrop = TypeOf e.HitTarget Is RadListElement
    End Sub

    Private Sub DragDropService_PreviewDragDrop(sender As Object, e As Telerik.WinControls.RadDropEventArgs)
        Dim draggedItem As BaseListViewVisualItem = TryCast(e.DragInstance, BaseListViewVisualItem)
        Dim listElement As RadListElement = TryCast(e.HitTarget, RadListElement)

        If listElement Is Nothing Then
            Return
        End If
        e.Handled = True
        Dim listControl As RadListControl = TryCast(listElement.ElementTree.Control, RadListControl)
        Dim targetItem As RadListVisualItem = TryCast(listControl.ElementTree.GetElementAtPoint(e.DropLocation), RadListVisualItem)
        Dim indexToInsert As Integer
        If targetItem IsNot Nothing Then
            indexToInsert = targetItem.Data.RowIndex
        Else
            indexToInsert = listControl.Items.Count
        End If
        Dim newItem As New RadListDataItem(draggedItem.Data.Text)
        listControl.Items.Insert(indexToInsert, newItem)

        draggedItem.Data.ListView.Items.Remove(draggedItem.Data)
    End Sub

    '#End Region

End Class
</code></pre>

<h2 id="drag-and-drop-from-radlistcontrol-to-radlistview-using-the-ole-drag-and-drop"><a href="#drag-and-drop-from-radlistcontrol-to-radlistview-using-the-ole-drag-and-drop">Drag and drop from RadListControl to RadListView using the OLE drag-and-drop<img src="images/listview-drag-and-drop-combining-raddragdropservice-and-ole-drag-and-drop002.gif" alt="listview-drag-and-drop-combining-raddragdropservice-and-ole-drag-and-drop 002"></a></h2>

<ol>
<li>Firstly, we should start the drag and drop operation using the RadListControl.<strong>MouseMove</strong> event when the
          left mouse button is pressed. We should keep the mouse down location in the RadListControl.<strong>MouseDown</strong> event.
          Afterwards, allow dragging over the <strong>RadListView</strong> via the <strong>Effect</strong> argument of the <strong>DragEventArgs</strong> 
          in the RadListView.<strong>DragEnter</strong> event handler:</li>
</ol>

<h4>__[C#] __</h4>

<pre><code>        private Point mouseDownPosition;
        private bool isDragging;

        private void radListControl1_MouseDown(object sender, MouseEventArgs e)
        {
            this.mouseDownPosition = e.Location;
        }

        private void radListControl1_MouseMove(object sender, MouseEventArgs e)
        {
            if (e.Button != MouseButtons.Left)
            {
                this.isDragging = false;
                return;
            }

            if (this.isDragging)
            {
                return;
            }

            if (this.ShouldBeginDrag(this.mouseDownPosition, e.Location))
            {
                RadListVisualItem draggedItem = this.radListControl1.ElementTree.GetElementAtPoint(this.mouseDownPosition) as RadListVisualItem;
                if (draggedItem != null)
                {
                    this.isDragging = true;
                    //start the drag and drop operation
                    (sender as RadListControl).DoDragDrop(draggedItem.Data, DragDropEffects.Copy);
                }
            }
        }

        private bool ShouldBeginDrag(Point current, Point capture)
        {
            Size dragSize = SystemInformation.DragSize;
            Rectangle dragRect = new Rectangle(capture.X - dragSize.Width / 2,
                capture.Y - dragSize.Height / 2, dragSize.Width, dragSize.Height);
            return !dragRect.Contains(current);
        }

        private void radListView1_DragEnter(object sender, DragEventArgs e)
        {
            e.Effect = DragDropEffects.Copy;
        }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    Private mouseDownPosition As Point
    Private isDragging As Boolean

    Private Sub radListControl1_MouseDown(sender As Object, e As MouseEventArgs)
        Me.mouseDownPosition = e.Location
    End Sub

    Private Sub radListControl1_MouseMove(sender As Object, e As MouseEventArgs)
        If e.Button &lt;&gt; MouseButtons.Left Then
            Me.isDragging = False
            Return
        End If

        If Me.isDragging Then
            Return
        End If

        If Me.ShouldBeginDrag(Me.mouseDownPosition, e.Location) Then
            Dim draggedItem As RadListVisualItem = TryCast(Me.RadListControl1.ElementTree.GetElementAtPoint(Me.mouseDownPosition), RadListVisualItem)
            If draggedItem IsNot Nothing Then
                Me.isDragging = True
                'start the drag and drop operation
                TryCast(sender, RadListControl).DoDragDrop(draggedItem.Data, DragDropEffects.Copy)
            End If
        End If
    End Sub

    Private Function ShouldBeginDrag(current As Point, capture As Point) As Boolean
        Dim dragSize As Size = SystemInformation.DragSize
        Dim dragRect As New Rectangle(capture.X - dragSize.Width / 2, capture.Y - dragSize.Height / 2, dragSize.Width, dragSize.Height)
        Return Not dragRect.Contains(current)
    End Function

    Private Sub radListView1_DragEnter(sender As Object, e As DragEventArgs)
        e.Effect = DragDropEffects.Copy
    End Sub

    '#End Region

    '#Region "ListControlToListViewDragDrop"

    Private Sub radListView1_DragDrop(sender As Object, e As DragEventArgs)
        Dim listView As RadListView = TryCast(sender, RadListView)
        Dim point__1 As Point = listView.PointToClient(New Point(e.X, e.Y))
        Dim targetItem As BaseListViewVisualItem = TryCast(listView.ElementTree.GetElementAtPoint(point__1), BaseListViewVisualItem)
        Dim draggedItem As RadListDataItem = TryCast(e.Data.GetData(GetType(RadListDataItem)), RadListDataItem)

        Dim targetDataSource As BindingList(Of String) = TryCast(listView.DataSource, BindingList(Of String))
        If targetDataSource IsNot Nothing Then
            'you are dropping over an item
            If targetItem IsNot Nothing Then
                Dim targetIndex As Integer = listView.Items.IndexOf(targetItem.Data)

                targetDataSource.Insert(targetIndex, draggedItem.Text)
            Else
                ' you are dropping over the ListViewElement
                targetDataSource.Add(draggedItem.Text)
            End If
        End If

        Dim indexToRemove As Integer = Me.RadListControl1.Items.IndexOf(draggedItem)
        If indexToRemove &gt; -1 Then
            Me.RadListControl1.Items.RemoveAt(indexToRemove)
        End If
        Me.mouseDownPosition = Point.Empty
        Me.isDragging = False
    End Sub

    Private Sub radListControl1_MouseUp(sender As Object, e As MouseEventArgs)
        Me.mouseDownPosition = Point.Empty
        Me.isDragging = False
    End Sub

    '#End Region

    '#End Region

    '#Region "ListViewToListControl"

    Private Sub DragDropService_PreviewDragOver(sender As Object, e As Telerik.WinControls.RadDragOverEventArgs)
        e.CanDrop = TypeOf e.HitTarget Is RadListElement
    End Sub

    Private Sub DragDropService_PreviewDragDrop(sender As Object, e As Telerik.WinControls.RadDropEventArgs)
        Dim draggedItem As BaseListViewVisualItem = TryCast(e.DragInstance, BaseListViewVisualItem)
        Dim listElement As RadListElement = TryCast(e.HitTarget, RadListElement)

        If listElement Is Nothing Then
            Return
        End If
        e.Handled = True
        Dim listControl As RadListControl = TryCast(listElement.ElementTree.Control, RadListControl)
        Dim targetItem As RadListVisualItem = TryCast(listControl.ElementTree.GetElementAtPoint(e.DropLocation), RadListVisualItem)
        Dim indexToInsert As Integer
        If targetItem IsNot Nothing Then
            indexToInsert = targetItem.Data.RowIndex
        Else
            indexToInsert = listControl.Items.Count
        End If
        Dim newItem As New RadListDataItem(draggedItem.Data.Text)
        listControl.Items.Insert(indexToInsert, newItem)

        draggedItem.Data.ListView.Items.Remove(draggedItem.Data)
    End Sub

    '#End Region

End Class
</code></pre>

<ol>
<li>In the RadListView.<strong>DragDrop</strong> event you need to get the location of the mouse and convert it to a point that the <strong>RadListView</strong>
          can use to get the element underneath the mouse. Afterwards, insert the dragged item on the specific position. We should reset the stored mouse down location as well:</li>
</ol>

<h4>__[C#] __</h4>

<pre><code>        private void radListView1_DragDrop(object sender, DragEventArgs e)
        {
            RadListView listView = sender as RadListView;
            Point point = listView.PointToClient(new Point(e.X, e.Y));
            BaseListViewVisualItem targetItem = listView.ElementTree.GetElementAtPoint(point) as BaseListViewVisualItem;
            RadListDataItem draggedItem = e.Data.GetData(typeof(RadListDataItem)) as RadListDataItem;

            BindingList&lt;string&gt; targetDataSource = listView.DataSource as BindingList&lt;string&gt;; 
            if (targetDataSource != null)
            {
                //you are dropping over an item
                if (targetItem != null)
                {
                    int targetIndex = listView.Items.IndexOf(targetItem.Data);

                    targetDataSource.Insert(targetIndex, draggedItem.Text);
                }
                else // you are dropping over the ListViewElement
                {
                    targetDataSource.Add(draggedItem.Text);
                }
            }

            int indexToRemove = this.radListControl1.Items.IndexOf(draggedItem);
            if (indexToRemove &gt; -1)
            {
                this.radListControl1.Items.RemoveAt(indexToRemove);
            }
            this.mouseDownPosition = Point.Empty;
            this.isDragging = false;
        }

        private void radListControl1_MouseUp(object sender, MouseEventArgs e)
        {
            this.mouseDownPosition = Point.Empty;
            this.isDragging = false;
        }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    Private Sub radListView1_DragDrop(sender As Object, e As DragEventArgs)
        Dim listView As RadListView = TryCast(sender, RadListView)
        Dim point__1 As Point = listView.PointToClient(New Point(e.X, e.Y))
        Dim targetItem As BaseListViewVisualItem = TryCast(listView.ElementTree.GetElementAtPoint(point__1), BaseListViewVisualItem)
        Dim draggedItem As RadListDataItem = TryCast(e.Data.GetData(GetType(RadListDataItem)), RadListDataItem)

        Dim targetDataSource As BindingList(Of String) = TryCast(listView.DataSource, BindingList(Of String))
        If targetDataSource IsNot Nothing Then
            'you are dropping over an item
            If targetItem IsNot Nothing Then
                Dim targetIndex As Integer = listView.Items.IndexOf(targetItem.Data)

                targetDataSource.Insert(targetIndex, draggedItem.Text)
            Else
                ' you are dropping over the ListViewElement
                targetDataSource.Add(draggedItem.Text)
            End If
        End If

        Dim indexToRemove As Integer = Me.RadListControl1.Items.IndexOf(draggedItem)
        If indexToRemove &gt; -1 Then
            Me.RadListControl1.Items.RemoveAt(indexToRemove)
        End If
        Me.mouseDownPosition = Point.Empty
        Me.isDragging = False
    End Sub

    Private Sub radListControl1_MouseUp(sender As Object, e As MouseEventArgs)
        Me.mouseDownPosition = Point.Empty
        Me.isDragging = False
    End Sub

    '#End Region

    '#End Region

    '#Region "ListViewToListControl"

    Private Sub DragDropService_PreviewDragOver(sender As Object, e As Telerik.WinControls.RadDragOverEventArgs)
        e.CanDrop = TypeOf e.HitTarget Is RadListElement
    End Sub

    Private Sub DragDropService_PreviewDragDrop(sender As Object, e As Telerik.WinControls.RadDropEventArgs)
        Dim draggedItem As BaseListViewVisualItem = TryCast(e.DragInstance, BaseListViewVisualItem)
        Dim listElement As RadListElement = TryCast(e.HitTarget, RadListElement)

        If listElement Is Nothing Then
            Return
        End If
        e.Handled = True
        Dim listControl As RadListControl = TryCast(listElement.ElementTree.Control, RadListControl)
        Dim targetItem As RadListVisualItem = TryCast(listControl.ElementTree.GetElementAtPoint(e.DropLocation), RadListVisualItem)
        Dim indexToInsert As Integer
        If targetItem IsNot Nothing Then
            indexToInsert = targetItem.Data.RowIndex
        Else
            indexToInsert = listControl.Items.Count
        End If
        Dim newItem As New RadListDataItem(draggedItem.Data.Text)
        listControl.Items.Insert(indexToInsert, newItem)

        draggedItem.Data.ListView.Items.Remove(draggedItem.Data)
    End Sub

    '#End Region

End Class
</code></pre>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

