<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Using a Data Provider</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Using a Data Provider">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-849dcaf701d866988e8c3593f15b66de.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/" title="WinForms Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/winforms.aspx" title="About UI for WinForms" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/winforms.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/winforms/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("scheduler/data-binding/using-a-data-provider.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/scheduler/data-binding/using-a-data-provider.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="using-a-data-provider"><a href="#using-a-data-provider">Using a Data Provider</a></h1>

<p>RadScheduler uses the Provider Design Pattern to allow for easy integration into existing applications. This allows to connect to various data sources. </p>

<p>You can use one of the scheduler data source components supplied with RadScheduler or implement your own if you have more specific data binding needs. Each scheduler data source inherits from the <strong>SchedulerDataSource</strong> abstract class and contains two providers – one for the appointment data and one for the resource data.<br>
        To bind RadScheduler to a provider, set its DataSource property to e specific scheduler data source. </p>

<h2 id="example"><a href="#example">Example</a></h2>

<p>This example shows how to bind RadScheduler to a collection of custom objects that contain appointment data using the __SchedulerBindingDataSource__component. This data source component allows binding to a collection of objects and can be used to bind RadScheduler not only to a collection of business objects, but to a ADO.NET DataTable ot the results of a LINQ query.<br>
        First we have code out custom class that will contain the appointment data:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>    public class MyAppointment : INotifyPropertyChanged
    {
        private DateTime start = DateTime.Now;
        private DateTime end = DateTime.Now;
        private string subject = string.Empty;
        private string description = string.Empty;
        private string location = string.Empty;
        private Guid id = Guid.NewGuid();

        public MyAppointment()
        {
        }

        public MyAppointment(DateTime start, DateTime end, string subject, string description, string location)
        {
            this.start = start;
            this.end = end;
            this.subject = subject;
            this.description = description;
            this.location = location;
        }

        public Guid Id
        {
            get
            {
                return this.id;
            }
            set
            {
                if (this.id != value)
                {
                    this.id = value;
                    this.OnPropertyChanged("Id");
                }
            }
        }

        public DateTime Start
        {
            get
            {
                return this.start;
            }
            set
            {
                if (this.start != value)
                {
                    this.start = value;
                    this.OnPropertyChanged("Start");
                }
            }
        }

        public DateTime End
        {
            get
            {
                return this.end;
            }
            set
            {
                if (this.end != value)
                {
                    this.end = value;
                    this.OnPropertyChanged("End");
                }
            }
        }

        public string Subject
        {
            get
            {
                return this.subject;
            }
            set
            {
                if (this.subject != value)
                {
                    this.subject = value;
                    this.OnPropertyChanged("Subject");
                }
            }
        }

        public string Description
        {
            get
            {
                return this.description;
            }
            set
            {
                if (this.description != value)
                {
                    this.description = value;
                    this.OnPropertyChanged("Description");
                }
            }
        }

        public string Location
        {
            get
            {
                return this.location;
            }
            set
            {
                if (this.location != value)
                {
                    this.location = value;
                    this.OnPropertyChanged("Location");
                }
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        protected virtual void OnPropertyChanged(string propertyName)
        {
            if (this.PropertyChanged != null)
            {
                this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }
    }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>Public Class MyAppointment
    Implements INotifyPropertyChanged

    Private _start As Date = Date.Now
    Private _end As Date = Date.Now
    Private _subject As String = String.Empty
    Private _description As String = String.Empty
    Private _location As String = String.Empty
    Private _id As Guid = Guid.NewGuid()

    Public Sub New()
    End Sub

    Public Sub New(ByVal start As Date, ByVal [end] As Date, ByVal subject As String, ByVal description As String, ByVal location As String)
        Me._start = start
        Me._end = [end]
        Me._subject = subject
        Me._description = description
        Me._location = location
    End Sub

    Public Property Id() As Guid
        Get
            Return Me._id
        End Get
        Set(ByVal value As Guid)
            If Me._id &lt;&gt; value Then
                Me._id = value
                Me.OnPropertyChanged("Id")
            End If
        End Set
    End Property

    Public Property Start() As Date
        Get
            Return Me._start
        End Get
        Set(ByVal value As Date)
            If Me._start &lt;&gt; value Then
                Me._start = value
                Me.OnPropertyChanged("Start")
            End If
        End Set
    End Property

    Public Property [End]() As Date
        Get
            Return Me._end
        End Get
        Set(ByVal value As Date)
            If Me._end &lt;&gt; value Then
                Me._end = value
                Me.OnPropertyChanged("End")
            End If
        End Set
    End Property

    Public Property Subject() As String
        Get
            Return Me._subject
        End Get
        Set(ByVal value As String)
            If Me._subject &lt;&gt; value Then
                Me._subject = value
                Me.OnPropertyChanged("Subject")
            End If
        End Set
    End Property

    Public Property Description() As String
        Get
            Return Me._description
        End Get
        Set(ByVal value As String)
            If Me._description &lt;&gt; value Then
                Me._description = value
                Me.OnPropertyChanged("Description")
            End If
        End Set
    End Property

    Public Property Location() As String
        Get
            Return Me._location
        End Get
        Set(ByVal value As String)
            If Me._location &lt;&gt; value Then
                Me._location = value
                Me.OnPropertyChanged("Location")
            End If
        End Set
    End Property

    Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged

    Protected Overridable Sub OnPropertyChanged(ByVal propertyName As String)
        If Me.PropertyChangedEvent IsNot Nothing Then
            RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(propertyName))
        End If
    End Sub
End Class
</code></pre>

<p>We will use a list to store our appointment data. For the purpose of this example we will populate the appointments collection with some dummy data in the OnLoad override of our form:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        private List&lt;MyAppointment&gt; appointments = new List&lt;MyAppointment&gt;();

        protected override void OnLoad(EventArgs e)
        {
            base.OnLoad(e);

            DateTime baseDate = DateTime.Today;
            DateTime[] start = new DateTime[] { baseDate.AddHours(14.0), baseDate.AddDays(1.0).AddHours(9.0), baseDate.AddDays(2.0).AddHours(13.0) };
            DateTime[] end = new DateTime[] { baseDate.AddHours(16.0), baseDate.AddDays(1.0).AddHours(15.0), baseDate.AddDays(2.0).AddHours(17.0) };
            string[] summaries = new string[] { "Mr. Brown", "Mr. White", "Mrs. Green" };
            string[] descriptions = new string[] { "", "", "" };
            string[] locations = new string[] { "City", "Out of town", "Service Center" };


            MyAppointment appointment = null;
            for (int i = 0; i &lt; summaries.Length; i++)
            {
                appointment = new MyAppointment(start[i], end[i], summaries[i],
                    descriptions[i], locations[i]);
                this.appointments.Add(appointment);
            }
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private appointments As New List(Of MyAppointment)()

    Protected Overrides Sub OnLoad(ByVal e As EventArgs)
        MyBase.OnLoad(e)

        Dim baseDate As Date = Date.Today
        Dim start() As Date = {baseDate.AddHours(14.0), baseDate.AddDays(1.0).AddHours(9.0), baseDate.AddDays(2.0).AddHours(13.0)}
        Dim [end]() As Date = {baseDate.AddHours(16.0), baseDate.AddDays(1.0).AddHours(15.0), baseDate.AddDays(2.0).AddHours(17.0)}
        Dim summaries() As String = {"Mr. Brown", "Mr. White", "Mrs. Green"}
        Dim descriptions() As String = {"", "", ""}
        Dim locations() As String = {"City", "Out of town", "Service Center"}


        Dim appointment As MyAppointment = Nothing
        For i As Integer = 0 To summaries.Length - 1
            appointment = New MyAppointment(start(i), [end](i), summaries(i), descriptions(i), locations(i))
            Me.appointments.Add(appointment)
        Next i
    End Sub
    '#End Region

    '#region bindClick
    Private Sub btnBind_Click(ByVal sender As Object, ByVal e As EventArgs)
        Dim dataSource As New SchedulerBindingDataSource()

        Dim appointmentMappingInfo As New AppointmentMappingInfo()
        appointmentMappingInfo.Start = "Start"
        appointmentMappingInfo.End = "End"
        appointmentMappingInfo.Summary = "Subject"
        appointmentMappingInfo.Description = "Description"
        appointmentMappingInfo.Location = "Location"
        appointmentMappingInfo.UniqueId = "Id"

        Dim idMapping As SchedulerMapping = appointmentMappingInfo.FindByDataSourceProperty("Id")
        idMapping.ConvertToDataSource = New ConvertCallback(AddressOf Me.ConvertIdToDataSource)
        idMapping.ConvertToScheduler = New ConvertCallback(AddressOf Me.ConvertIdToScheduler)

        dataSource.EventProvider.Mapping = appointmentMappingInfo
        dataSource.EventProvider.DataSource = Me.appointments

        Me.RadScheduler1.DataSource = dataSource
    End Sub
</code></pre>

<p>And finally we will bind our RadScheduler instance to tha collection in the Click event handler of a button:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        private void btnBind_Click(object sender, EventArgs e)
        {
            SchedulerBindingDataSource dataSource = new SchedulerBindingDataSource();

            AppointmentMappingInfo appointmentMappingInfo = new AppointmentMappingInfo();
            appointmentMappingInfo.Start = "Start";
            appointmentMappingInfo.End = "End";
            appointmentMappingInfo.Summary = "Subject";
            appointmentMappingInfo.Description = "Description";
            appointmentMappingInfo.Location = "Location";
            appointmentMappingInfo.UniqueId = "Id";

            SchedulerMapping idMapping = appointmentMappingInfo.FindByDataSourceProperty("Id");
            idMapping.ConvertToDataSource = new ConvertCallback(this.ConvertIdToDataSource);
            idMapping.ConvertToScheduler = new ConvertCallback(this.ConvertIdToScheduler);

            dataSource.EventProvider.Mapping = appointmentMappingInfo;
            dataSource.EventProvider.DataSource = this.appointments;

            this.radScheduler1.DataSource = dataSource;
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub btnBind_Click(ByVal sender As Object, ByVal e As EventArgs)
        Dim dataSource As New SchedulerBindingDataSource()

        Dim appointmentMappingInfo As New AppointmentMappingInfo()
        appointmentMappingInfo.Start = "Start"
        appointmentMappingInfo.End = "End"
        appointmentMappingInfo.Summary = "Subject"
        appointmentMappingInfo.Description = "Description"
        appointmentMappingInfo.Location = "Location"
        appointmentMappingInfo.UniqueId = "Id"

        Dim idMapping As SchedulerMapping = appointmentMappingInfo.FindByDataSourceProperty("Id")
        idMapping.ConvertToDataSource = New ConvertCallback(AddressOf Me.ConvertIdToDataSource)
        idMapping.ConvertToScheduler = New ConvertCallback(AddressOf Me.ConvertIdToScheduler)

        dataSource.EventProvider.Mapping = appointmentMappingInfo
        dataSource.EventProvider.DataSource = Me.appointments

        Me.RadScheduler1.DataSource = dataSource
    End Sub
</code></pre>

<p>In the above code we create a <strong>SchedulerBindingDataSource</strong> component. Then create a <strong>AppointmentMappingInfo</strong> in order to “tell” the appointment provider how the properties of objects from the data source (in our case the appointments collection) corresponds to properties of the <strong>IEvent</strong> interface.</p>

<p>Note how the <strong>SchedulerMapping</strong> class which is responsible for mapping a single property from the data source to a scheduler property (in our case property from the <strong>IEvent</strong> interface) allows you to specify convert callback methods in order to convert values to and from the data source if needed.</p>

<p>Finally, we set the Mapping and DataSource properties of the <strong>EventProvider</strong> contained in the <strong>SchedulerBindingDataSource</strong> and set the data source to our RadScheduler instance and we are done.</p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

