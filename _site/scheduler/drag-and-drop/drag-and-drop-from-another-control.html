<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Drag and Drop from Another Control</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Drag and Drop from Another Control">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            


<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">


</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("scheduler/drag-and-drop/drag-and-drop-from-another-control.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/scheduler/drag-and-drop/drag-and-drop-from-another-control.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="drag-and-drop-from-another-control"><a href="#drag-and-drop-from-another-control">Drag and Drop from Another Control</a></h1>

<blockquote>
<p>Similar approach is demonstrated in the * Demos, section Scheduler &gt;&gt; Drag&amp;Drop. *</p>
</blockquote>

<p><strong>RadScheduler</strong> supports drag and drop from another control, such as dragging appointment subjects from a ListBox.<br>
        It is necessary to set the <strong>AllowDrop</strong> property to <em>true</em>.</p>

<h2 id="drag-and-drop-from-listbox-to-radscheduler"><a href="#drag-and-drop-from-listbox-to-radscheduler">Drag and drop from ListBox to RadScheduler</a></h2>

<p>Firstly, we should start the drag and drop operation using the ListBox.<strong>MouseMove</strong> event when the left mouse button is pressed.<br>
          Afterwards, allow dragging over the <strong>RadScheduler</strong> via the <strong>Effect</strong> argument of the <strong>DragEventArgs</strong> in the RadScheduler.<strong>DragEnter</strong> event handler:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        void listBox1_MouseMove(object sender, MouseEventArgs e)
        {
            if (e.Button != MouseButtons.Left)
                return;

            if (this.isDragging)
                return;

            Point currentPosition = e.Location;
            if ((Math.Abs((currentPosition.X - this.mouseDownPosition.X)) &gt;= SystemInformation.DragSize.Width) ||
                (Math.Abs((currentPosition.Y - this.mouseDownPosition.Y)) &gt;= SystemInformation.DragSize.Height))
            {
                this.isDragging = true;
                DragObject dragObject = new DragObject();
                int index = this.listBox1.IndexFromPoint(e.X, e.Y);
                if (index &gt; -1 &amp;&amp; index &lt; this.listBox1.Items.Count)
                {
                    string itemText = this.listBox1.Items[index].ToString(); 

                    if (itemText != string.Empty)
                    {
                        dragObject.Values.Add(AppointmentFields.Summary, itemText);
                        dragObject.Status = AppointmentFields.Summary;
                        //start the drag and drop operation
                        (sender as ListBox).DoDragDrop(dragObject, DragDropEffects.Copy);
                    }
                }
            }
        }

        private void radScheduler1_DragEnter(object sender, DragEventArgs e)
        {
            DragObject dragObject = e.Data.GetData(typeof(DragObject)) as DragObject;
            //allow dragging over the RadScheduler
            e.Effect = dragObject == null ? DragDropEffects.None : DragDropEffects.Copy;
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub listBox1_MouseMove(sender As Object, e As MouseEventArgs)
        If e.Button &lt;&gt; MouseButtons.Left Then
            Return
        End If

        If Me.isDragging Then
            Return
        End If

        Dim currentPosition As Point = e.Location
        If (Math.Abs((currentPosition.X - Me.mouseDownPosition.X)) &gt;= SystemInformation.DragSize.Width) OrElse (Math.Abs((currentPosition.Y - Me.mouseDownPosition.Y)) &gt;= SystemInformation.DragSize.Height) Then
            Me.isDragging = True
            Dim dragObject As New DragObject()
            Dim index As Integer = Me.ListBox1.IndexFromPoint(e.X, e.Y)
            If index &gt; -1 AndAlso index &lt; Me.ListBox1.Items.Count Then
                Dim itemText As String = Me.ListBox1.Items(index).ToString()

                If itemText &lt;&gt; String.Empty Then
                    dragObject.Values.Add(AppointmentFields.Summary, itemText)
                    dragObject.Status = AppointmentFields.Summary
                    'start the drag and drop operation
                    TryCast(sender, ListBox).DoDragDrop(dragObject, DragDropEffects.Copy)
                End If
            End If
        End If
    End Sub

    Private Sub radScheduler1_DragEnter(sender As Object, e As DragEventArgs)
        Dim dragObject As DragObject = TryCast(e.Data.GetData(GetType(DragObject)), DragObject)
        'allow dragging over the RadScheduler
        e.Effect = If(dragObject Is Nothing, DragDropEffects.None, DragDropEffects.Copy)
    End Sub

    '#End Region

    '#End Region

    '#Region "createAppointment"

    Private Function CreateAppointment(currentDate As DateTime, dragObject As DragObject) As Appointment
        Dim appointment As New Appointment()
        Dim startDate As DateTime = currentDate
        Dim endDate As DateTime = currentDate.AddHours(1)
        Select Case dragObject.Status
            Case AppointmentFields.Summary
                appointment.Summary = TryCast(dragObject.Values(dragObject.Status), String)
                Exit Select
            Case AppointmentFields.Row
                appointment.Summary = TryCast(dragObject.Values(AppointmentFields.Summary), String)
                appointment.Description = TryCast(dragObject.Values(AppointmentFields.Description), String)
                appointment.BackgroundId = CInt(dragObject.Values(AppointmentFields.Background))
                appointment.StatusId = CInt(dragObject.Values(AppointmentFields.Status))
                appointment.Location = TryCast(dragObject.Values(AppointmentFields.Location), String)

                startDate = DirectCast(dragObject.Values(AppointmentFields.Start), DateTime)
                endDate = DirectCast(dragObject.Values(AppointmentFields.[End]), DateTime)

                Dim range As TimeSpan = endDate - startDate
                endDate = currentDate + range
                startDate = currentDate

                Exit Select
        End Select
        appointment.Start = startDate
        appointment.[End] = endDate
        Return appointment
    End Function

    '#End Region

    '#Region "privateclasses"

    Private Enum AppointmentFields
        Row
        Summary
        Location
        Description
        Start
        [End]
        Background
        Status
    End Enum

    Private Class DragObject
        Private m_status As AppointmentFields
        Private m_values As New Dictionary(Of AppointmentFields, Object)()

        Public Property Status() As AppointmentFields
            Get
                Return Me.m_status
            End Get
            Set(value As AppointmentFields)
                Me.m_status = value
            End Set
        End Property

        Public ReadOnly Property Values() As Dictionary(Of AppointmentFields, Object)
            Get
                Return Me.m_values
            End Get
        End Property
    End Class

    '#End Region
End Class
</code></pre>

<p>In order to use this feature, we will need to find the scheduler cell when the item is dropped onto the scheduler surface. Once you have the scheduler cell<br>
          you can get the date and create an appointment for it.<br>
        <img src="images/scheduler-drag-and-drop-drag-and-drop-from-another-control001.gif" alt="scheduler-drag-and-drop-drag-and-drop-from-another-control 001"></p>

<p>In the RadScheduler <strong>DragDrop</strong> event handler you need to get the location of the mouse and convert it to a point that the scheduler can use to get the cell element underneath the mouse. This <strong>MonthCellElement</strong> is passed to a private method <strong>GetCellAppointment()</strong> that we will write next.</p>

<h4><strong>[C#] Drop to the month cell element</strong></h4>

<pre><code>        private Point mouseDownPosition;
        private bool isDragging;

        private void radScheduler1_DragDrop(object sender, DragEventArgs e)
        {
            Point point = this.radScheduler1.PointToClient(new Point(e.X, e.Y));
            SchedulerCellElement schedulerCell = SchedulerUIHelper.GetCellAtPoint(point, this.radScheduler1);

            if (schedulerCell != null)
            {
                DragObject dragObject = e.Data.GetData(typeof(DragObject)) as DragObject;
                if (dragObject != null)
                {
                    this.radScheduler1.Appointments.BeginUpdate();
                    Appointment appointment = CreateAppointment(schedulerCell.Date, dragObject);
                    this.radScheduler1.Appointments.Add(appointment);
                    this.radScheduler1.Appointments.EndUpdate();
                }
            }

            this.mouseDownPosition = Point.Empty;
            this.isDragging = false;
        }
</code></pre>

<h4><strong>[VB.NET] Drop to the month cell element</strong></h4>

<pre><code>    Private mouseDownPosition As Point
    Private isDragging As Boolean

    Private Sub radScheduler1_DragDrop(sender As Object, e As DragEventArgs)
        Dim point As Point = Me.RadScheduler1.PointToClient(New Point(e.X, e.Y))
        Dim schedulerCell As SchedulerCellElement = SchedulerUIHelper.GetCellAtPoint(point, Me.RadScheduler1)

        If schedulerCell IsNot Nothing Then
            Dim dragObject As DragObject = TryCast(e.Data.GetData(GetType(DragObject)), DragObject)
            If dragObject IsNot Nothing Then
                Me.RadScheduler1.Appointments.BeginUpdate()
                Dim appointment As Appointment = CreateAppointment(schedulerCell.[Date], dragObject)
                Me.RadScheduler1.Appointments.Add(appointment)
                Me.RadScheduler1.Appointments.EndUpdate()
            End If
        End If

        Me.mouseDownPosition = Point.Empty
        Me.isDragging = False
    End Sub

    '#End Region

    '#Region "ListBoxToSchedulerStart"

    Private Sub listBox1_MouseMove(sender As Object, e As MouseEventArgs)
        If e.Button &lt;&gt; MouseButtons.Left Then
            Return
        End If

        If Me.isDragging Then
            Return
        End If

        Dim currentPosition As Point = e.Location
        If (Math.Abs((currentPosition.X - Me.mouseDownPosition.X)) &gt;= SystemInformation.DragSize.Width) OrElse (Math.Abs((currentPosition.Y - Me.mouseDownPosition.Y)) &gt;= SystemInformation.DragSize.Height) Then
            Me.isDragging = True
            Dim dragObject As New DragObject()
            Dim index As Integer = Me.ListBox1.IndexFromPoint(e.X, e.Y)
            If index &gt; -1 AndAlso index &lt; Me.ListBox1.Items.Count Then
                Dim itemText As String = Me.ListBox1.Items(index).ToString()

                If itemText &lt;&gt; String.Empty Then
                    dragObject.Values.Add(AppointmentFields.Summary, itemText)
                    dragObject.Status = AppointmentFields.Summary
                    'start the drag and drop operation
                    TryCast(sender, ListBox).DoDragDrop(dragObject, DragDropEffects.Copy)
                End If
            End If
        End If
    End Sub

    Private Sub radScheduler1_DragEnter(sender As Object, e As DragEventArgs)
        Dim dragObject As DragObject = TryCast(e.Data.GetData(GetType(DragObject)), DragObject)
        'allow dragging over the RadScheduler
        e.Effect = If(dragObject Is Nothing, DragDropEffects.None, DragDropEffects.Copy)
    End Sub

    '#End Region

    '#End Region

    '#Region "createAppointment"

    Private Function CreateAppointment(currentDate As DateTime, dragObject As DragObject) As Appointment
        Dim appointment As New Appointment()
        Dim startDate As DateTime = currentDate
        Dim endDate As DateTime = currentDate.AddHours(1)
        Select Case dragObject.Status
            Case AppointmentFields.Summary
                appointment.Summary = TryCast(dragObject.Values(dragObject.Status), String)
                Exit Select
            Case AppointmentFields.Row
                appointment.Summary = TryCast(dragObject.Values(AppointmentFields.Summary), String)
                appointment.Description = TryCast(dragObject.Values(AppointmentFields.Description), String)
                appointment.BackgroundId = CInt(dragObject.Values(AppointmentFields.Background))
                appointment.StatusId = CInt(dragObject.Values(AppointmentFields.Status))
                appointment.Location = TryCast(dragObject.Values(AppointmentFields.Location), String)

                startDate = DirectCast(dragObject.Values(AppointmentFields.Start), DateTime)
                endDate = DirectCast(dragObject.Values(AppointmentFields.[End]), DateTime)

                Dim range As TimeSpan = endDate - startDate
                endDate = currentDate + range
                startDate = currentDate

                Exit Select
        End Select
        appointment.Start = startDate
        appointment.[End] = endDate
        Return appointment
    End Function

    '#End Region

    '#Region "privateclasses"

    Private Enum AppointmentFields
        Row
        Summary
        Location
        Description
        Start
        [End]
        Background
        Status
    End Enum

    Private Class DragObject
        Private m_status As AppointmentFields
        Private m_values As New Dictionary(Of AppointmentFields, Object)()

        Public Property Status() As AppointmentFields
            Get
                Return Me.m_status
            End Get
            Set(value As AppointmentFields)
                Me.m_status = value
            End Set
        End Property

        Public ReadOnly Property Values() As Dictionary(Of AppointmentFields, Object)
            Get
                Return Me.m_values
            End Get
        End Property
    End Class

    '#End Region
End Class
</code></pre>

<p>The helper method <strong>CreateAppointment()</strong> creates an appontment starting at the cell where the ListBox item is dropped. This appointment gets its data from the dragged item.</p>

<h4><strong>[C#] Creating an appointment</strong></h4>

<pre><code>        private Appointment CreateAppointment(DateTime currentDate, DragObject dragObject)
        {
            Appointment appointment = new Appointment();
            DateTime startDate = currentDate;
            DateTime endDate = currentDate.AddHours(1);
            switch (dragObject.Status)
            {
                case AppointmentFields.Summary:
                    appointment.Summary = dragObject.Values[dragObject.Status] as string;
                    break;
                case AppointmentFields.Row:
                    appointment.Summary = dragObject.Values[AppointmentFields.Summary] as string;
                    appointment.Description = dragObject.Values[AppointmentFields.Description] as string;
                    appointment.BackgroundId = (int)dragObject.Values[AppointmentFields.Background];
                    appointment.StatusId = (int)dragObject.Values[AppointmentFields.Status];
                    appointment.Location = dragObject.Values[AppointmentFields.Location] as string;

                    startDate = (DateTime)dragObject.Values[AppointmentFields.Start];
                    endDate = (DateTime)dragObject.Values[AppointmentFields.End];

                    TimeSpan range = endDate - startDate;
                    endDate = currentDate + range;
                    startDate = currentDate;

                    break;
            }
            appointment.Start = startDate;
            appointment.End = endDate;
            return appointment;
        }
</code></pre>

<h4><strong>[VB.NET] Creating an appointment</strong></h4>

<pre><code>    Private Function CreateAppointment(currentDate As DateTime, dragObject As DragObject) As Appointment
        Dim appointment As New Appointment()
        Dim startDate As DateTime = currentDate
        Dim endDate As DateTime = currentDate.AddHours(1)
        Select Case dragObject.Status
            Case AppointmentFields.Summary
                appointment.Summary = TryCast(dragObject.Values(dragObject.Status), String)
                Exit Select
            Case AppointmentFields.Row
                appointment.Summary = TryCast(dragObject.Values(AppointmentFields.Summary), String)
                appointment.Description = TryCast(dragObject.Values(AppointmentFields.Description), String)
                appointment.BackgroundId = CInt(dragObject.Values(AppointmentFields.Background))
                appointment.StatusId = CInt(dragObject.Values(AppointmentFields.Status))
                appointment.Location = TryCast(dragObject.Values(AppointmentFields.Location), String)

                startDate = DirectCast(dragObject.Values(AppointmentFields.Start), DateTime)
                endDate = DirectCast(dragObject.Values(AppointmentFields.[End]), DateTime)

                Dim range As TimeSpan = endDate - startDate
                endDate = currentDate + range
                startDate = currentDate

                Exit Select
        End Select
        appointment.Start = startDate
        appointment.[End] = endDate
        Return appointment
    End Function

    '#End Region

    '#Region "privateclasses"

    Private Enum AppointmentFields
        Row
        Summary
        Location
        Description
        Start
        [End]
        Background
        Status
    End Enum

    Private Class DragObject
        Private m_status As AppointmentFields
        Private m_values As New Dictionary(Of AppointmentFields, Object)()

        Public Property Status() As AppointmentFields
            Get
                Return Me.m_status
            End Get
            Set(value As AppointmentFields)
                Me.m_status = value
            End Set
        End Property

        Public ReadOnly Property Values() As Dictionary(Of AppointmentFields, Object)
            Get
                Return Me.m_values
            End Get
        End Property
    End Class

    '#End Region
End Class
</code></pre>

<h2 id="drag-and-drop-from-radscheduler-to-listbox"><a href="#drag-and-drop-from-radscheduler-to-listbox">Drag and drop from RadScheduler to ListBox</a></h2>

<p>In order to enable dragging an appointment from <strong>RadScheduler</strong> and dropping it onto the ListBox, it is necessary to set the ListBox.<strong>AllowDrop</strong><br>
          property to <em>true</em>. Use the RadScheduler.<strong>MouseMove</strong> event to start the drag and drop operation. In the ListBox.<strong>DragOver</strong><br>
          event you should allow the drop operation:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        private void radScheduler1_MouseMove(object sender, MouseEventArgs e)
        {
            if (e.Button != MouseButtons.Left)
                return;

            if (this.isDragging)
                return;

            AppointmentElement appointmentElement = this.radScheduler1.ElementTree.GetElementAtPoint(e.Location) as AppointmentElement;
            if (appointmentElement == null)
            {
                return;
            }

            this.isDragging = true;
            DragObject dragObject = new DragObject();
            dragObject.Values.Add(AppointmentFields.Summary, appointmentElement.Appointment.Summary);
            dragObject.Status = AppointmentFields.Summary;
            //start drag and drop operation
            (sender as RadScheduler).DoDragDrop(dragObject, DragDropEffects.Copy);
        }

        private void listBox1_DragOver(object sender, DragEventArgs e)
        {
            DragObject dragObject = e.Data.GetData(typeof(DragObject)) as DragObject;   
            //allow dragging over the ListBox
            e.Effect = dragObject == null ? DragDropEffects.None : DragDropEffects.Copy;
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub radScheduler1_MouseMove(sender As Object, e As MouseEventArgs)
        If e.Button &lt;&gt; MouseButtons.Left Then
            Return
        End If

        If Me.isDragging Then
            Return
        End If

        Dim appointmentElement As AppointmentElement = TryCast(Me.RadScheduler1.ElementTree.GetElementAtPoint(e.Location), AppointmentElement)
        If appointmentElement Is Nothing Then
            Return
        End If

        Me.isDragging = True
        Dim dragObject As New DragObject()
        dragObject.Values.Add(AppointmentFields.Summary, appointmentElement.Appointment.Summary)
        dragObject.Status = AppointmentFields.Summary
        'start drag and drop operation
        TryCast(sender, RadScheduler).DoDragDrop(dragObject, DragDropEffects.Copy)
    End Sub

    Private Sub listBox1_DragOver(sender As Object, e As DragEventArgs)
        Dim dragObject As DragObject = TryCast(e.Data.GetData(GetType(DragObject)), DragObject)
        'allow dragging over the ListBox
        e.Effect = If(dragObject Is Nothing, DragDropEffects.None, DragDropEffects.Copy)
    End Sub

    '#End Region

    '#Region "SchedulerToListBoxDrop"
    Private Sub listBox1_DragDrop(sender As Object, e As DragEventArgs)
        Dim point As Point = Me.ListBox1.PointToClient(New Point(e.X, e.Y))
        Dim dragObject As DragObject = TryCast(e.Data.GetData(GetType(DragObject)), DragObject)
        If dragObject IsNot Nothing Then
            Dim itemText As String = TryCast(dragObject.Values(AppointmentFields.Summary), String)
            If Not Me.ListBox1.Items.Contains(itemText) Then
                Dim index As Integer = Me.ListBox1.IndexFromPoint(point)
                If index &gt; -1 AndAlso index &lt; Me.ListBox1.Items.Count Then
                    Me.ListBox1.Items.Insert(index, itemText)
                Else
                    Me.ListBox1.Items.Add(itemText)
                End If
            End If
        End If

        Me.isDragging = False
    End Sub
    '#End Region
    '#End Region

    '#Region "ListBoxToScheduler"

    '#Region "dropToCell"

    Private mouseDownPosition As Point
    Private isDragging As Boolean

    Private Sub radScheduler1_DragDrop(sender As Object, e As DragEventArgs)
        Dim point As Point = Me.RadScheduler1.PointToClient(New Point(e.X, e.Y))
        Dim schedulerCell As SchedulerCellElement = SchedulerUIHelper.GetCellAtPoint(point, Me.RadScheduler1)

        If schedulerCell IsNot Nothing Then
            Dim dragObject As DragObject = TryCast(e.Data.GetData(GetType(DragObject)), DragObject)
            If dragObject IsNot Nothing Then
                Me.RadScheduler1.Appointments.BeginUpdate()
                Dim appointment As Appointment = CreateAppointment(schedulerCell.[Date], dragObject)
                Me.RadScheduler1.Appointments.Add(appointment)
                Me.RadScheduler1.Appointments.EndUpdate()
            End If
        End If

        Me.mouseDownPosition = Point.Empty
        Me.isDragging = False
    End Sub

    '#End Region

    '#Region "ListBoxToSchedulerStart"

    Private Sub listBox1_MouseMove(sender As Object, e As MouseEventArgs)
        If e.Button &lt;&gt; MouseButtons.Left Then
            Return
        End If

        If Me.isDragging Then
            Return
        End If

        Dim currentPosition As Point = e.Location
        If (Math.Abs((currentPosition.X - Me.mouseDownPosition.X)) &gt;= SystemInformation.DragSize.Width) OrElse (Math.Abs((currentPosition.Y - Me.mouseDownPosition.Y)) &gt;= SystemInformation.DragSize.Height) Then
            Me.isDragging = True
            Dim dragObject As New DragObject()
            Dim index As Integer = Me.ListBox1.IndexFromPoint(e.X, e.Y)
            If index &gt; -1 AndAlso index &lt; Me.ListBox1.Items.Count Then
                Dim itemText As String = Me.ListBox1.Items(index).ToString()

                If itemText &lt;&gt; String.Empty Then
                    dragObject.Values.Add(AppointmentFields.Summary, itemText)
                    dragObject.Status = AppointmentFields.Summary
                    'start the drag and drop operation
                    TryCast(sender, ListBox).DoDragDrop(dragObject, DragDropEffects.Copy)
                End If
            End If
        End If
    End Sub

    Private Sub radScheduler1_DragEnter(sender As Object, e As DragEventArgs)
        Dim dragObject As DragObject = TryCast(e.Data.GetData(GetType(DragObject)), DragObject)
        'allow dragging over the RadScheduler
        e.Effect = If(dragObject Is Nothing, DragDropEffects.None, DragDropEffects.Copy)
    End Sub

    '#End Region

    '#End Region

    '#Region "createAppointment"

    Private Function CreateAppointment(currentDate As DateTime, dragObject As DragObject) As Appointment
        Dim appointment As New Appointment()
        Dim startDate As DateTime = currentDate
        Dim endDate As DateTime = currentDate.AddHours(1)
        Select Case dragObject.Status
            Case AppointmentFields.Summary
                appointment.Summary = TryCast(dragObject.Values(dragObject.Status), String)
                Exit Select
            Case AppointmentFields.Row
                appointment.Summary = TryCast(dragObject.Values(AppointmentFields.Summary), String)
                appointment.Description = TryCast(dragObject.Values(AppointmentFields.Description), String)
                appointment.BackgroundId = CInt(dragObject.Values(AppointmentFields.Background))
                appointment.StatusId = CInt(dragObject.Values(AppointmentFields.Status))
                appointment.Location = TryCast(dragObject.Values(AppointmentFields.Location), String)

                startDate = DirectCast(dragObject.Values(AppointmentFields.Start), DateTime)
                endDate = DirectCast(dragObject.Values(AppointmentFields.[End]), DateTime)

                Dim range As TimeSpan = endDate - startDate
                endDate = currentDate + range
                startDate = currentDate

                Exit Select
        End Select
        appointment.Start = startDate
        appointment.[End] = endDate
        Return appointment
    End Function

    '#End Region

    '#Region "privateclasses"

    Private Enum AppointmentFields
        Row
        Summary
        Location
        Description
        Start
        [End]
        Background
        Status
    End Enum

    Private Class DragObject
        Private m_status As AppointmentFields
        Private m_values As New Dictionary(Of AppointmentFields, Object)()

        Public Property Status() As AppointmentFields
            Get
                Return Me.m_status
            End Get
            Set(value As AppointmentFields)
                Me.m_status = value
            End Set
        End Property

        Public ReadOnly Property Values() As Dictionary(Of AppointmentFields, Object)
            Get
                Return Me.m_values
            End Get
        End Property
    End Class

    '#End Region
End Class
</code></pre>

<p>Finally, perform the exact drag and drop operation via inserting a new item in the ListBox in the <strong>DragDrop</strong> event:</p>

<h4><strong>[C#]</strong></h4>

<pre><code>        private void listBox1_DragDrop(object sender, DragEventArgs e)
        {
            Point point = this.listBox1.PointToClient(new Point(e.X, e.Y));
            DragObject dragObject = e.Data.GetData(typeof(DragObject)) as DragObject;
            if (dragObject != null)
            {
                string itemText = dragObject.Values[AppointmentFields.Summary] as string;
                if (!this.listBox1.Items.Contains(itemText))
                {
                    int index = this.listBox1.IndexFromPoint(point);
                    if (index &gt; -1 &amp;&amp; index &lt; this.listBox1.Items.Count)
                    {
                        this.listBox1.Items.Insert(index, itemText);
                    }
                    else
                    {
                        this.listBox1.Items.Add(itemText);
                    }
                }
            }

            this.isDragging = false;
        }
</code></pre>

<h4><strong>[VB.NET]</strong></h4>

<pre><code>    Private Sub listBox1_DragDrop(sender As Object, e As DragEventArgs)
        Dim point As Point = Me.ListBox1.PointToClient(New Point(e.X, e.Y))
        Dim dragObject As DragObject = TryCast(e.Data.GetData(GetType(DragObject)), DragObject)
        If dragObject IsNot Nothing Then
            Dim itemText As String = TryCast(dragObject.Values(AppointmentFields.Summary), String)
            If Not Me.ListBox1.Items.Contains(itemText) Then
                Dim index As Integer = Me.ListBox1.IndexFromPoint(point)
                If index &gt; -1 AndAlso index &lt; Me.ListBox1.Items.Count Then
                    Me.ListBox1.Items.Insert(index, itemText)
                Else
                    Me.ListBox1.Items.Add(itemText)
                End If
            End If
        End If

        Me.isDragging = False
    End Sub
    '#End Region
    '#End Region

    '#Region "ListBoxToScheduler"

    '#Region "dropToCell"

    Private mouseDownPosition As Point
    Private isDragging As Boolean

    Private Sub radScheduler1_DragDrop(sender As Object, e As DragEventArgs)
        Dim point As Point = Me.RadScheduler1.PointToClient(New Point(e.X, e.Y))
        Dim schedulerCell As SchedulerCellElement = SchedulerUIHelper.GetCellAtPoint(point, Me.RadScheduler1)

        If schedulerCell IsNot Nothing Then
            Dim dragObject As DragObject = TryCast(e.Data.GetData(GetType(DragObject)), DragObject)
            If dragObject IsNot Nothing Then
                Me.RadScheduler1.Appointments.BeginUpdate()
                Dim appointment As Appointment = CreateAppointment(schedulerCell.[Date], dragObject)
                Me.RadScheduler1.Appointments.Add(appointment)
                Me.RadScheduler1.Appointments.EndUpdate()
            End If
        End If

        Me.mouseDownPosition = Point.Empty
        Me.isDragging = False
    End Sub

    '#End Region

    '#Region "ListBoxToSchedulerStart"

    Private Sub listBox1_MouseMove(sender As Object, e As MouseEventArgs)
        If e.Button &lt;&gt; MouseButtons.Left Then
            Return
        End If

        If Me.isDragging Then
            Return
        End If

        Dim currentPosition As Point = e.Location
        If (Math.Abs((currentPosition.X - Me.mouseDownPosition.X)) &gt;= SystemInformation.DragSize.Width) OrElse (Math.Abs((currentPosition.Y - Me.mouseDownPosition.Y)) &gt;= SystemInformation.DragSize.Height) Then
            Me.isDragging = True
            Dim dragObject As New DragObject()
            Dim index As Integer = Me.ListBox1.IndexFromPoint(e.X, e.Y)
            If index &gt; -1 AndAlso index &lt; Me.ListBox1.Items.Count Then
                Dim itemText As String = Me.ListBox1.Items(index).ToString()

                If itemText &lt;&gt; String.Empty Then
                    dragObject.Values.Add(AppointmentFields.Summary, itemText)
                    dragObject.Status = AppointmentFields.Summary
                    'start the drag and drop operation
                    TryCast(sender, ListBox).DoDragDrop(dragObject, DragDropEffects.Copy)
                End If
            End If
        End If
    End Sub

    Private Sub radScheduler1_DragEnter(sender As Object, e As DragEventArgs)
        Dim dragObject As DragObject = TryCast(e.Data.GetData(GetType(DragObject)), DragObject)
        'allow dragging over the RadScheduler
        e.Effect = If(dragObject Is Nothing, DragDropEffects.None, DragDropEffects.Copy)
    End Sub

    '#End Region

    '#End Region

    '#Region "createAppointment"

    Private Function CreateAppointment(currentDate As DateTime, dragObject As DragObject) As Appointment
        Dim appointment As New Appointment()
        Dim startDate As DateTime = currentDate
        Dim endDate As DateTime = currentDate.AddHours(1)
        Select Case dragObject.Status
            Case AppointmentFields.Summary
                appointment.Summary = TryCast(dragObject.Values(dragObject.Status), String)
                Exit Select
            Case AppointmentFields.Row
                appointment.Summary = TryCast(dragObject.Values(AppointmentFields.Summary), String)
                appointment.Description = TryCast(dragObject.Values(AppointmentFields.Description), String)
                appointment.BackgroundId = CInt(dragObject.Values(AppointmentFields.Background))
                appointment.StatusId = CInt(dragObject.Values(AppointmentFields.Status))
                appointment.Location = TryCast(dragObject.Values(AppointmentFields.Location), String)

                startDate = DirectCast(dragObject.Values(AppointmentFields.Start), DateTime)
                endDate = DirectCast(dragObject.Values(AppointmentFields.[End]), DateTime)

                Dim range As TimeSpan = endDate - startDate
                endDate = currentDate + range
                startDate = currentDate

                Exit Select
        End Select
        appointment.Start = startDate
        appointment.[End] = endDate
        Return appointment
    End Function

    '#End Region

    '#Region "privateclasses"

    Private Enum AppointmentFields
        Row
        Summary
        Location
        Description
        Start
        [End]
        Background
        Status
    End Enum

    Private Class DragObject
        Private m_status As AppointmentFields
        Private m_values As New Dictionary(Of AppointmentFields, Object)()

        Public Property Status() As AppointmentFields
            Get
                Return Me.m_status
            End Get
            Set(value As AppointmentFields)
                Me.m_status = value
            End Set
        End Property

        Public ReadOnly Property Values() As Dictionary(Of AppointmentFields, Object)
            Get
                Return Me.m_values
            End Get
        End Property
    End Class

    '#End Region
End Class
</code></pre>

<p><img src="images/scheduler-drag-and-drop-drag-and-drop-from-another-control002.gif" alt="scheduler-drag-and-drop-drag-and-drop-from-another-control 002"></p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

