<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Search</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Search">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("richtexteditor/features/richtexteditor-search.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/richtexteditor/features/richtexteditor-search.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="search"><a href="#search">Search</a></h1>

<p><strong>RadRichTextEditor</strong> supports searching the contents of the document along with providing some methods for manipulating the selection.<br>
          Used in combination, they become quite a powerful tool enabling scenarios like highlighting of specific parts of the document or replacing words and collocations.</p>

<blockquote class="tip"><p>To learn more about the selection API read the <a href="/devtools/winforms/richtexteditor/features/richtexteditor-selection">Selection</a> topic. </p></blockquote>

<p>The simplest scenario – finding a string in the content of the document can be implemented with the following code:</p>

<h4>__[C#] __</h4>

<pre><code>        private void SelectAllMatches(string toSearch)
        {
            this.radRichTextEditor1.Document.Selection.Clear(); // this clears the selection before processing
            Telerik.WinForms.Documents.TextSearch.DocumentTextSearch search = new Telerik.WinForms.Documents.TextSearch.DocumentTextSearch(this.radRichTextEditor1.Document);
            foreach (var textRange in search.FindAll(toSearch))
            {
                this.radRichTextEditor1.Document.Selection.AddSelectionStart(textRange.StartPosition);
                this.radRichTextEditor1.Document.Selection.AddSelectionEnd(textRange.EndPosition);
            }
        }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    Private Sub SelectAllMatches(ByVal toSearch As String)
        Me.radRichTextEditor1.Document.Selection.Clear() ' this clears the selection before processing
        Dim search As New Telerik.WinForms.Documents.TextSearch.DocumentTextSearch(Me.radRichTextEditor1.Document)
        For Each textRange In search.FindAll(toSearch)
            Me.radRichTextEditor1.Document.Selection.AddSelectionStart(textRange.StartPosition)
            Me.radRichTextEditor1.Document.Selection.AddSelectionEnd(textRange.EndPosition)
        Next textRange
    End Sub

#End Region

#Region "allmatches"

    Private Sub ReplaceAllMatches(ByVal toSearch As String, ByVal toReplaceWith As String)
        Me.radRichTextEditor1.Document.Selection.Clear() ' this clears the selection before processing
        Dim search As New Telerik.WinForms.Documents.TextSearch.DocumentTextSearch(Me.radRichTextEditor1.Document)
        Dim rangesTrackingDocumentChanges As New List(Of Telerik.WinForms.Documents.TextSearch.TextRange)()
        For Each textRange In search.FindAll(toSearch)
            Dim newRange As New Telerik.WinForms.Documents.TextSearch.TextRange(New Telerik.WinForms.Documents.DocumentPosition(textRange.StartPosition, True), New Telerik.WinForms.Documents.DocumentPosition(textRange.EndPosition, True))
            rangesTrackingDocumentChanges.Add(newRange)
        Next textRange
        For Each textRange In rangesTrackingDocumentChanges
            Me.radRichTextEditor1.Document.Selection.AddSelectionStart(textRange.StartPosition)
            Me.radRichTextEditor1.Document.Selection.AddSelectionEnd(textRange.EndPosition)
            Me.radRichTextEditor1.Insert(toReplaceWith)
            textRange.StartPosition.Dispose()
            textRange.EndPosition.Dispose()
        Next textRange
    End Sub

#End Region
End Class
</code></pre>

<p>Note that the <strong>FindAll()</strong> method of the DocumentTextSearch class takes a string as an argument, but regards it as a regular expression. <br>
          For example, searching <strong>“[a-z]<em>control[a-z]</em>”</strong> will find all words that contain the word "control" as a substring. Thus, if you have the <br>
          word "Telerik UI" in the document, executing the <strong>SelectAllMatches("control")</strong> will result in only these six letters being selected,<br>
          as opposed to the whole word "Telerik UI" being selected when <strong>SelectAllMatches("[a-z]<em>control[a-z]</em>")</strong>.</p>

<p>You can use all kind of regular expressions, such as <strong>"(asp|silverlight)\s*control(s)?"</strong> (which would match both<br>
          "ASP Controls" and "SilverlightControl"), <strong>[a-z]<em>(.)\1[a-z]</em></strong> (which finds all words that have a doubled letter), and basically <br>
          everything else you can come up with. Make sure to use correct expressions if you want to utilize this functionality, or escape the string in case you want<br>
          a simple search for a word that can contain special symbols like “?”, “+”, “{“ etc. This can be automatically done by invoking the following code before <br>
          proceeding with the search.</p>

<h4>__[C#] __</h4>

<pre><code>            string toSearch = "";

            toSearch = Regex.Escape(toSearch);
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        Dim toSearch As String = ""

        toSearch = Regex.Escape(toSearch)

        '#End Region

        '#Region "style"

        Me.radRichTextEditor1.ChangeTextHighlightColor(Telerik.WinControls.RichTextEditor.UI.Colors.LightGray) ' will highlight all selected words in LightGray
        Me.radRichTextEditor1.ChangeFontSize(Telerik.WinControls.RichTextBox.Model.Unit.PointToDip(32)) ' will increase the font size of the words to 30 DIP
        Me.radRichTextEditor1.ChangeFontFamily(New Telerik.WinControls.RichTextEditor.UI.FontFamily("Comic Sans MS")) ' will change the font family of the spans, containing these words.

        '#End Region

        '#Region "clear"

        Me.radRichTextEditor1.Document.Selection.Clear()

        '#End Region
    End Sub

#Region "search"

    Private Sub SelectAllMatches(ByVal toSearch As String)
        Me.radRichTextEditor1.Document.Selection.Clear() ' this clears the selection before processing
        Dim search As New Telerik.WinForms.Documents.TextSearch.DocumentTextSearch(Me.radRichTextEditor1.Document)
        For Each textRange In search.FindAll(toSearch)
            Me.radRichTextEditor1.Document.Selection.AddSelectionStart(textRange.StartPosition)
            Me.radRichTextEditor1.Document.Selection.AddSelectionEnd(textRange.EndPosition)
        Next textRange
    End Sub

#End Region

#Region "allmatches"

    Private Sub ReplaceAllMatches(ByVal toSearch As String, ByVal toReplaceWith As String)
        Me.radRichTextEditor1.Document.Selection.Clear() ' this clears the selection before processing
        Dim search As New Telerik.WinForms.Documents.TextSearch.DocumentTextSearch(Me.radRichTextEditor1.Document)
        Dim rangesTrackingDocumentChanges As New List(Of Telerik.WinForms.Documents.TextSearch.TextRange)()
        For Each textRange In search.FindAll(toSearch)
            Dim newRange As New Telerik.WinForms.Documents.TextSearch.TextRange(New Telerik.WinForms.Documents.DocumentPosition(textRange.StartPosition, True), New Telerik.WinForms.Documents.DocumentPosition(textRange.EndPosition, True))
            rangesTrackingDocumentChanges.Add(newRange)
        Next textRange
        For Each textRange In rangesTrackingDocumentChanges
            Me.radRichTextEditor1.Document.Selection.AddSelectionStart(textRange.StartPosition)
            Me.radRichTextEditor1.Document.Selection.AddSelectionEnd(textRange.EndPosition)
            Me.radRichTextEditor1.Insert(toReplaceWith)
            textRange.StartPosition.Dispose()
            textRange.EndPosition.Dispose()
        Next textRange
    End Sub

#End Region
End Class
</code></pre>

<p>Selecting the results of the search is particularly useful, as most formatting commands that are executed on <strong>RadRichTextEditor</strong><br>
          (or its document) are selection-based, i.e. they operate on the currently selected parts of the document. You can use that fact by invoking one of these <br>
          commands after having selected the words in the document. Here is an example.</p>

<h4>__[C#] __</h4>

<pre><code>            this.radRichTextEditor1.ChangeTextHighlightColor(Telerik.WinControls.RichTextEditor.UI.Colors.LightGray);  // will highlight all selected words in LightGray
            this.radRichTextEditor1.ChangeFontSize(Telerik.WinControls.RichTextBox.Model.Unit.PointToDip(32));   // will increase the font size of the words to 30 DIP
            this.radRichTextEditor1.ChangeFontFamily(new Telerik.WinControls.RichTextEditor.UI.FontFamily("Comic Sans MS")); // will change the font family of the spans, containing these words.
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        Me.radRichTextEditor1.ChangeTextHighlightColor(Telerik.WinControls.RichTextEditor.UI.Colors.LightGray) ' will highlight all selected words in LightGray
        Me.radRichTextEditor1.ChangeFontSize(Telerik.WinControls.RichTextBox.Model.Unit.PointToDip(32)) ' will increase the font size of the words to 30 DIP
        Me.radRichTextEditor1.ChangeFontFamily(New Telerik.WinControls.RichTextEditor.UI.FontFamily("Comic Sans MS")) ' will change the font family of the spans, containing these words.

        '#End Region

        '#Region "clear"

        Me.radRichTextEditor1.Document.Selection.Clear()

        '#End Region
    End Sub

#Region "search"

    Private Sub SelectAllMatches(ByVal toSearch As String)
        Me.radRichTextEditor1.Document.Selection.Clear() ' this clears the selection before processing
        Dim search As New Telerik.WinForms.Documents.TextSearch.DocumentTextSearch(Me.radRichTextEditor1.Document)
        For Each textRange In search.FindAll(toSearch)
            Me.radRichTextEditor1.Document.Selection.AddSelectionStart(textRange.StartPosition)
            Me.radRichTextEditor1.Document.Selection.AddSelectionEnd(textRange.EndPosition)
        Next textRange
    End Sub

#End Region

#Region "allmatches"

    Private Sub ReplaceAllMatches(ByVal toSearch As String, ByVal toReplaceWith As String)
        Me.radRichTextEditor1.Document.Selection.Clear() ' this clears the selection before processing
        Dim search As New Telerik.WinForms.Documents.TextSearch.DocumentTextSearch(Me.radRichTextEditor1.Document)
        Dim rangesTrackingDocumentChanges As New List(Of Telerik.WinForms.Documents.TextSearch.TextRange)()
        For Each textRange In search.FindAll(toSearch)
            Dim newRange As New Telerik.WinForms.Documents.TextSearch.TextRange(New Telerik.WinForms.Documents.DocumentPosition(textRange.StartPosition, True), New Telerik.WinForms.Documents.DocumentPosition(textRange.EndPosition, True))
            rangesTrackingDocumentChanges.Add(newRange)
        Next textRange
        For Each textRange In rangesTrackingDocumentChanges
            Me.radRichTextEditor1.Document.Selection.AddSelectionStart(textRange.StartPosition)
            Me.radRichTextEditor1.Document.Selection.AddSelectionEnd(textRange.EndPosition)
            Me.radRichTextEditor1.Insert(toReplaceWith)
            textRange.StartPosition.Dispose()
            textRange.EndPosition.Dispose()
        Next textRange
    End Sub

#End Region
End Class
</code></pre>

<p>Most of the time, you would like to remove the selection at the end of the operations, which is done by calling the <strong>Clear()</strong> method<br>
          of the  <strong>DocumentSelection</strong> object.</p>

<h4>__[C#] __</h4>

<pre><code>            this.radRichTextEditor1.Document.Selection.Clear();
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>        Me.radRichTextEditor1.Document.Selection.Clear()

        '#End Region
    End Sub

#Region "search"

    Private Sub SelectAllMatches(ByVal toSearch As String)
        Me.radRichTextEditor1.Document.Selection.Clear() ' this clears the selection before processing
        Dim search As New Telerik.WinForms.Documents.TextSearch.DocumentTextSearch(Me.radRichTextEditor1.Document)
        For Each textRange In search.FindAll(toSearch)
            Me.radRichTextEditor1.Document.Selection.AddSelectionStart(textRange.StartPosition)
            Me.radRichTextEditor1.Document.Selection.AddSelectionEnd(textRange.EndPosition)
        Next textRange
    End Sub

#End Region

#Region "allmatches"

    Private Sub ReplaceAllMatches(ByVal toSearch As String, ByVal toReplaceWith As String)
        Me.radRichTextEditor1.Document.Selection.Clear() ' this clears the selection before processing
        Dim search As New Telerik.WinForms.Documents.TextSearch.DocumentTextSearch(Me.radRichTextEditor1.Document)
        Dim rangesTrackingDocumentChanges As New List(Of Telerik.WinForms.Documents.TextSearch.TextRange)()
        For Each textRange In search.FindAll(toSearch)
            Dim newRange As New Telerik.WinForms.Documents.TextSearch.TextRange(New Telerik.WinForms.Documents.DocumentPosition(textRange.StartPosition, True), New Telerik.WinForms.Documents.DocumentPosition(textRange.EndPosition, True))
            rangesTrackingDocumentChanges.Add(newRange)
        Next textRange
        For Each textRange In rangesTrackingDocumentChanges
            Me.radRichTextEditor1.Document.Selection.AddSelectionStart(textRange.StartPosition)
            Me.radRichTextEditor1.Document.Selection.AddSelectionEnd(textRange.EndPosition)
            Me.radRichTextEditor1.Insert(toReplaceWith)
            textRange.StartPosition.Dispose()
            textRange.EndPosition.Dispose()
        Next textRange
    End Sub

#End Region
End Class
</code></pre>

<p>On a side note, the find and select functionality can be extended in order to implement a replace of all occurrences matching the searched string with <br>
        another string. Here is a sample code:</p>

<h4>__[C#] __</h4>

<pre><code>        private void ReplaceAllMatches(string toSearch, string toReplaceWith)
        {
            this.radRichTextEditor1.Document.Selection.Clear(); // this clears the selection before processing
            Telerik.WinForms.Documents.TextSearch.DocumentTextSearch search = new Telerik.WinForms.Documents.TextSearch.DocumentTextSearch(this.radRichTextEditor1.Document);
            List&lt;Telerik.WinForms.Documents.TextSearch.TextRange&gt; rangesTrackingDocumentChanges = new List&lt;Telerik.WinForms.Documents.TextSearch.TextRange&gt;();
            foreach (var textRange in search.FindAll(toSearch))
            {
                Telerik.WinForms.Documents.TextSearch.TextRange newRange = new Telerik.WinForms.Documents.TextSearch.TextRange(new Telerik.WinForms.Documents.DocumentPosition(textRange.StartPosition, true), new Telerik.WinForms.Documents.DocumentPosition(textRange.EndPosition, true));
                rangesTrackingDocumentChanges.Add(newRange);
            }
            foreach (var textRange in rangesTrackingDocumentChanges)
            {
                this.radRichTextEditor1.Document.Selection.AddSelectionStart(textRange.StartPosition);
                this.radRichTextEditor1.Document.Selection.AddSelectionEnd(textRange.EndPosition);
                this.radRichTextEditor1.Insert(toReplaceWith);
                textRange.StartPosition.Dispose();
                textRange.EndPosition.Dispose();
            }
        }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    Private Sub ReplaceAllMatches(ByVal toSearch As String, ByVal toReplaceWith As String)
        Me.radRichTextEditor1.Document.Selection.Clear() ' this clears the selection before processing
        Dim search As New Telerik.WinForms.Documents.TextSearch.DocumentTextSearch(Me.radRichTextEditor1.Document)
        Dim rangesTrackingDocumentChanges As New List(Of Telerik.WinForms.Documents.TextSearch.TextRange)()
        For Each textRange In search.FindAll(toSearch)
            Dim newRange As New Telerik.WinForms.Documents.TextSearch.TextRange(New Telerik.WinForms.Documents.DocumentPosition(textRange.StartPosition, True), New Telerik.WinForms.Documents.DocumentPosition(textRange.EndPosition, True))
            rangesTrackingDocumentChanges.Add(newRange)
        Next textRange
        For Each textRange In rangesTrackingDocumentChanges
            Me.radRichTextEditor1.Document.Selection.AddSelectionStart(textRange.StartPosition)
            Me.radRichTextEditor1.Document.Selection.AddSelectionEnd(textRange.EndPosition)
            Me.radRichTextEditor1.Insert(toReplaceWith)
            textRange.StartPosition.Dispose()
            textRange.EndPosition.Dispose()
        Next textRange
    End Sub

#End Region
End Class
</code></pre>

<p>There is a need to create new <strong>TextRanges</strong> with document positions that track the changes to the document, because the deletion and <br>
          insertion affects the document positions. The document positions created using the 2-parameter constructor with the second parameter set to "true" keep their<br>
          relative position as the document changes. They, however, have to be manually disposed of, as they subscribe to events in order to track the changes to the<br>
          document and must detach their handlers at the end of their use. This is done using the <strong>Dispose</strong> method. If you skip that step,<br>
          there will be memory leaks in your application.</p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

