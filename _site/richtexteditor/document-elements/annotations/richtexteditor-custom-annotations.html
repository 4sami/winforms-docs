<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Custom Annotations</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Custom Annotations">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-849dcaf701d866988e8c3593f15b66de.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/" title="WinForms Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/winforms.aspx" title="About UI for WinForms" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/winforms.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/winforms/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("richtexteditor/document-elements/annotations/richtexteditor-custom-annotations.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/richtexteditor/document-elements/annotations/richtexteditor-custom-annotations.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="custom-annotations"><a href="#custom-annotations">Custom Annotations</a></h1>

<p>Custom annotation ranges provide an approach for extending the document model to serve specific purposes<br>
        such as persisting semantic information in the document.<br>
        This article will list the steps which should be followed in order to create a custom AnnotationRange with a specific behavior.</p>

<p>For general information on Annotations, please refer to these articles:</p>

<ul>
<li><p><a href="/devtools/winforms/richtexteditor/document-elements/richtexteditor-annotations">Annotations</a></p></li>
<li><p><a href="/devtools/winforms/richtexteditor/document-elements/annotations/richtexteditor-manipulating-annotations">Manipulating Annotations</a></p></li>
</ul>

<p>This topic explains:</p>

<ul>
<li><p><a href="#creating-a-custom-annotation">Creating Custom Annotation</a></p></li>
<li><p><a href="#customizing-annotations">Customizing Annotations</a></p></li>
<li><p><a href="#serialization">Serialization</a></p></li>
</ul>

<h2 id="creating-a-custom-annotation"><a href="#creating-a-custom-annotation">Creating a Custom Annotation</a></h2>

<p>The most common scenarios for the use of custom annotations is for associating semantic data to a part of the document.<br>
          In order to fulfill this task, you can implement custom annotation ranges. The steps to do so are:</p>

<ul>
<li><p>Create two classes deriving from AnnotationRangeStart and AnnotationRangeEnd respectively.<br>
          Depending on the behavior you would like to achieve, you can also inherit from some of the already implemented annotation ranges, such as<br>
          FieldRangeStart/FieldRangeEnd.</p></li>
<li><p>Override the CreateNewElementInstance method and have it return an instance of your annotation range start/end in both classes.<br>
          Override the required CopyContentFromOverride method as well. In most cases, it should be left empty.</p></li>
</ul>

<h4>__[C#] __</h4>

<pre><code>        protected override DocumentElement CreateNewElementInstance()
        {
            return new CustomAnnotationRangeStart();
        }

        protected override void CopyContentFromOverride(DocumentElement fromElement)
        {
        }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    Protected Overrides Function CreateNewElementInstance() As DocumentElement
        Return New CustomAnnotationRangeStart()
    End Function

    Protected Overrides Sub CopyContentFromOverride(ByVal fromElement As DocumentElement)
    End Sub

#End Region

#Region "copy"

    Protected Overrides Sub CopyPropertiesFromOverride(ByVal fromElement As DocumentElement)
        MyBase.CopyPropertiesFromOverride(fromElement)
        Me.Name = CType(fromElement, CustomAnnotationRangeStart).Name
    End Sub

#End Region

#Region "delete"

    Public Overrides ReadOnly Property DeleteBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.SelectAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property BackspaceBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.SelectAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property DeleteSelectedBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

#End Region

#Region "name"

    &lt;XamlSerializable&gt;
    Public Property Name() As String

#End Region

    Public Overrides ReadOnly Property SkipPositionBefore() As Boolean
        Get
            Return True
        End Get
    End Property
End Class

Public Class CustomAnnotationRangeEnd
    Inherits AnnotationRangeEnd

    Protected Overrides Function CreateNewElementInstance() As DocumentElement
        Return New CustomAnnotationRangeEnd()
    End Function
#Region "instance"
    Protected Overrides Function CreateRangeStartInstance() As AnnotationRangeStart
        Return New CustomAnnotationRangeStart()
    End Function
#End Region
    Protected Overrides Sub CopyContentFromOverride(ByVal fromElement As DocumentElement)
    End Sub

    Public Overrides ReadOnly Property SkipPositionBefore() As Boolean
        Get
            Return True
        End Get
    End Property

#Region "delete2"

    Public Overrides ReadOnly Property DeleteBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.PreserveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property BackspaceBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property DeleteSelectedBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

#End Region
End Class
</code></pre>

<ul>
<li>Override the CreateRangeStartInstance in the RangeEnd class.</li>
</ul>

<h4>__[C#] __</h4>

<pre><code>        protected override AnnotationRangeStart CreateRangeStartInstance()
        {
            return new CustomAnnotationRangeStart();
        }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    Protected Overrides Function CreateRangeStartInstance() As AnnotationRangeStart
        Return New CustomAnnotationRangeStart()
    End Function
#End Region
    Protected Overrides Sub CopyContentFromOverride(ByVal fromElement As DocumentElement)
    End Sub

    Public Overrides ReadOnly Property SkipPositionBefore() As Boolean
        Get
            Return True
        End Get
    End Property

#Region "delete2"

    Public Overrides ReadOnly Property DeleteBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.PreserveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property BackspaceBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property DeleteSelectedBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

#End Region
End Class
</code></pre>

<p>At this point, you will have the basic functionality working and can continue to customize the behavior of the ranges, i.e. if it will be <br>
        possible to edit the content in them, what will be the behavior when you hit backspace or delete, if it will be possible to copy the ranges, etc. </p>

<h2 id="customizing-annotations"><a href="#customizing-annotations">Customizing Annotations</a></h2>

<p>The behavior of the annotations when edited, copied and deleted is determined by the following properties and methods which you can override:</p>

<ul>
<li><p><strong>IsCopyable</strong> - specifies if the inline can be copied and pasted somewhere else in the document.<br>
          The start and end must have the same value in order to have proper behavior. For example, BookmarkRangeStart and End are not copyable, while CommentRangeStart <br>
          and End are copyable.</p></li>
<li><p><strong>CopyPropertiesFromOverride</strong> - this method should be used when you have custom properties you would like to have copied. <br>
          This should be done as follows:</p></li>
</ul>

<h4>__[C#] __</h4>

<pre><code>        protected override void CopyPropertiesFromOverride(DocumentElement fromElement)
        {
            base.CopyPropertiesFromOverride(fromElement);
            this.Name = ((CustomAnnotationRangeStart)fromElement).Name;
        }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    Protected Overrides Sub CopyPropertiesFromOverride(ByVal fromElement As DocumentElement)
        MyBase.CopyPropertiesFromOverride(fromElement)
        Me.Name = CType(fromElement, CustomAnnotationRangeStart).Name
    End Sub

#End Region

#Region "delete"

    Public Overrides ReadOnly Property DeleteBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.SelectAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property BackspaceBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.SelectAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property DeleteSelectedBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

#End Region

#Region "name"

    &lt;XamlSerializable&gt;
    Public Property Name() As String

#End Region

    Public Overrides ReadOnly Property SkipPositionBefore() As Boolean
        Get
            Return True
        End Get
    End Property
End Class

Public Class CustomAnnotationRangeEnd
    Inherits AnnotationRangeEnd

    Protected Overrides Function CreateNewElementInstance() As DocumentElement
        Return New CustomAnnotationRangeEnd()
    End Function
#Region "instance"
    Protected Overrides Function CreateRangeStartInstance() As AnnotationRangeStart
        Return New CustomAnnotationRangeStart()
    End Function
#End Region
    Protected Overrides Sub CopyContentFromOverride(ByVal fromElement As DocumentElement)
    End Sub

    Public Overrides ReadOnly Property SkipPositionBefore() As Boolean
        Get
            Return True
        End Get
    End Property

#Region "delete2"

    Public Overrides ReadOnly Property DeleteBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.PreserveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property BackspaceBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property DeleteSelectedBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

#End Region
End Class
</code></pre>

<ul>
<li><p><strong>SkipPositionBefore</strong> - specifies where text will appear if you position the caret next to the range start/end.<br>
          For example, if it returns true in the range start and false in the range end, the text you enter when you position the caret next to the start/end, <br>
          will appear in the range.</p></li>
<li><p><strong>SkipPositionsInRange</strong> of AnnotationRangeStart - you can set this property to false, which will disable the option to edit the content<br>
          of the range, i.e.<br>
          it may be possible to delete the range altogether, but it will not be possible to position the caret in the range, select or edit only part of the range.</p></li>
<li><p><strong>DeleteBehavior, BackspaceBehavior, DeleteSelectedBehavior</strong> - you can customize these behaviors by choosing from the options in <br>
          the enum AnnotationMarkerDeleteBehavior:<br>
          PreserveAnnotation, SelectAnnotation, RemoveAnnotation, SelectAnnotationMarker.<br>
        For example hyperlinks keep the default settings in FieldRangeStart and FieldRangeEnd, which are:<br>
        HyperlinkRangeStart:</p></li>
</ul>

<h4>__[C#] __</h4>

<pre><code>        public override AnnotationMarkerDeleteBehavior DeleteBehavior
        {
            get
            {
                return AnnotationMarkerDeleteBehavior.SelectAnnotation;
            }
        }

        public override AnnotationMarkerDeleteBehavior BackspaceBehavior
        {
            get
            {
                return AnnotationMarkerDeleteBehavior.SelectAnnotation;
            }
        }

        public override AnnotationMarkerDeleteBehavior DeleteSelectedBehavior
        {
            get
            {
                return AnnotationMarkerDeleteBehavior.RemoveAnnotation;
            }
        }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    Public Overrides ReadOnly Property DeleteBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.SelectAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property BackspaceBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.SelectAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property DeleteSelectedBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

#End Region

#Region "name"

    &lt;XamlSerializable&gt;
    Public Property Name() As String

#End Region

    Public Overrides ReadOnly Property SkipPositionBefore() As Boolean
        Get
            Return True
        End Get
    End Property
End Class

Public Class CustomAnnotationRangeEnd
    Inherits AnnotationRangeEnd

    Protected Overrides Function CreateNewElementInstance() As DocumentElement
        Return New CustomAnnotationRangeEnd()
    End Function
#Region "instance"
    Protected Overrides Function CreateRangeStartInstance() As AnnotationRangeStart
        Return New CustomAnnotationRangeStart()
    End Function
#End Region
    Protected Overrides Sub CopyContentFromOverride(ByVal fromElement As DocumentElement)
    End Sub

    Public Overrides ReadOnly Property SkipPositionBefore() As Boolean
        Get
            Return True
        End Get
    End Property

#Region "delete2"

    Public Overrides ReadOnly Property DeleteBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.PreserveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property BackspaceBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property DeleteSelectedBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

#End Region
End Class
</code></pre>

<p>HyperlinkRangeEnd:</p>

<h4>__[C#] __</h4>

<pre><code>        public override AnnotationMarkerDeleteBehavior DeleteBehavior
        {
            get
            {
                return AnnotationMarkerDeleteBehavior.PreserveAnnotation;
            }
        }

        public override AnnotationMarkerDeleteBehavior BackspaceBehavior
        {
            get
            {
                return AnnotationMarkerDeleteBehavior.RemoveAnnotation;
            }
        }

        public override AnnotationMarkerDeleteBehavior DeleteSelectedBehavior
        {
            get
            {
                return AnnotationMarkerDeleteBehavior.RemoveAnnotation;
            }
        }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    Public Overrides ReadOnly Property DeleteBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.PreserveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property BackspaceBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property DeleteSelectedBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

#End Region
End Class
</code></pre>

<ul>
<li>You can also define custom properties in your annotation range start/end. If you want to be able to serialize them, you can just mark them with the
          XamlSerializable attribute:</li>
</ul>

<h4>__[C#] __</h4>

<pre><code>        [XamlSerializable]
        public string Name { get; set; }
</code></pre>

<h4>__[VB.NET] __</h4>

<pre><code>    &lt;XamlSerializable&gt;
    Public Property Name() As String

#End Region

    Public Overrides ReadOnly Property SkipPositionBefore() As Boolean
        Get
            Return True
        End Get
    End Property
End Class

Public Class CustomAnnotationRangeEnd
    Inherits AnnotationRangeEnd

    Protected Overrides Function CreateNewElementInstance() As DocumentElement
        Return New CustomAnnotationRangeEnd()
    End Function
#Region "instance"
    Protected Overrides Function CreateRangeStartInstance() As AnnotationRangeStart
        Return New CustomAnnotationRangeStart()
    End Function
#End Region
    Protected Overrides Sub CopyContentFromOverride(ByVal fromElement As DocumentElement)
    End Sub

    Public Overrides ReadOnly Property SkipPositionBefore() As Boolean
        Get
            Return True
        End Get
    End Property

#Region "delete2"

    Public Overrides ReadOnly Property DeleteBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.PreserveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property BackspaceBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

    Public Overrides ReadOnly Property DeleteSelectedBehavior() As AnnotationMarkerDeleteBehavior
        Get
            Return AnnotationMarkerDeleteBehavior.RemoveAnnotation
        End Get
    End Property

#End Region
End Class
</code></pre>

<h2 id="serialization"><a href="#serialization">Serialization</a></h2>

<p>Of the default document format providers, custom annotations are supported only in XAML. The other formats do not offer such extensibility.<br>
          When exporting to XAML, the exporter will generate prefixes for each custom annotation namespace (custom1, custom2, etc.).<br>
          Serialization is handled by XamlFormatProvider which looks for properties with the appropriate attributes: XamlSerializable (as inline properties) <br>
          and XamlCompositePropertySerializable (as XAML composite properties).</p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

